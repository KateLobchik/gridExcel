(self.webpackChunkgrid_ang=self.webpackChunkgrid_ang||[]).push([[179],{255:j=>{function M(L){return Promise.resolve().then(()=>{var T=new Error("Cannot find module '"+L+"'");throw T.code="MODULE_NOT_FOUND",T})}M.keys=()=>[],M.resolve=M,M.id=255,j.exports=M},672:module=>{var j;j=function(){var define,module,exports;return function j(M,L,T){function O(_,z){if(!L[_]){if(!M[_]){if(S)return S(_,!0);var te=new Error("Cannot find module '"+_+"'");throw te.code="MODULE_NOT_FOUND",te}var ee=L[_]={exports:{}};M[_][0].call(ee.exports,function(Q){return O(M[_][1][Q]||Q)},ee,ee.exports,j,M,L,T)}return L[_].exports}for(var S=void 0,V=0;V<T.length;V++)O(T[V]);return O}({1:[function(require,module,exports){var j,M;j=this,M=function(){return function(){var k=(j={},j.nil=Error("#NULL!"),j.div0=Error("#DIV/0!"),j.value=Error("#VALUE!"),j.ref=Error("#REF!"),j.name=Error("#NAME?"),j.num=Error("#NUM!"),j.na=Error("#N/A"),j.error=Error("#ERROR!"),j.data=Error("#GETTING_DATA"),j),e=function(){var j={flattenShallow:function(L){return L&&L.reduce?L.reduce(function(T,O){var S=Array.isArray(T),V=Array.isArray(O);return S&&V?T.concat(O):S?(T.push(O),T):V?[T].concat(O):[T,O]}):L},isFlat:function(L){if(!L)return!1;for(var T=0;T<L.length;++T)if(Array.isArray(L[T]))return!1;return!0},flatten:function(){for(var L=j.argsToArray.apply(null,arguments);!j.isFlat(L);)L=j.flattenShallow(L);return L},argsToArray:function(L){var T=[];return j.arrayEach(L,function(O){T.push(O)}),T},numbers:function(){return this.flatten.apply(null,arguments).filter(function(L){return"number"==typeof L})},cleanFloat:function(L){return Math.round(1e14*L)/1e14},parseBool:function(L){if("boolean"==typeof L||L instanceof Error)return L;if("number"==typeof L)return 0!==L;if("string"==typeof L){var T=L.toUpperCase();if("TRUE"===T)return!0;if("FALSE"===T)return!1}return L instanceof Date&&!isNaN(L)||k.value},parseNumber:function(L){return void 0===L||""===L||isNaN(L)?k.value:parseFloat(L)},parseNumberArray:function(L){var T,O;if(!L||0===(T=L.length))return k.value;for(;T--;){if((O=j.parseNumber(L[T]))===k.value)return O;L[T]=O}return L},parseMatrix:function(L){if(!L||0===L.length)return k.value;for(var T,O=0;O<L.length;O++)if(T=j.parseNumberArray(L[O]),L[O]=T,T instanceof Error)return T;return L}},M=new Date(Date.UTC(1900,0,1));return j.parseDate=function(L){return isNaN(L)?"string"!=typeof L||(L=new Date(L),isNaN(L))?k.value:L:L instanceof Date?new Date(L):0>(L=parseInt(L,10))?k.num:60>=L?new Date(M.getTime()+864e5*(L-1)):new Date(M.getTime()+864e5*(L-2))},j.parseDateArray=function(L){for(var O,T=L.length;T--;){if((O=this.parseDate(L[T]))===k.value)return O;L[T]=O}return L},j.anyIsError=function(){for(var L=arguments.length;L--;)if(arguments[L]instanceof Error)return!0;return!1},j.arrayValuesToNumbers=function(L){for(var O,T=L.length;T--;)"number"!=typeof(O=L[T])&&(!0===O?L[T]=1:!1===O?L[T]=0:"string"==typeof O&&(O=this.parseNumber(O),L[T]=O instanceof Error?0:O));return L},j.rest=function(L,T){return L&&"function"==typeof L.slice?L.slice(T||1):L},j.initial=function(L,T){return L&&"function"==typeof L.slice?L.slice(0,L.length-(T||1)):L},j.arrayEach=function(L,T){for(var O=-1,S=L.length;++O<S&&!1!==T(L[O],O,L););return L},j.transpose=function(L){return L?L[0].map(function(T,O){return L.map(function(S){return S[O]})}):k.value},j}(),x={},j;x.datetime=function(){function j(O){return(O-L)/864e5+(-22038912e5<O?2:1)}var M={},L=new Date(1900,0,1),T=[[],[1,2,3,4,5,6,7],[7,1,2,3,4,5,6],[6,0,1,2,3,4,5],[],[],[],[],[],[],[],[7,1,2,3,4,5,6],[6,7,1,2,3,4,5],[5,6,7,1,2,3,4],[4,5,6,7,1,2,3],[3,4,5,6,7,1,2],[2,3,4,5,6,7,1],[1,2,3,4,5,6,7]];return M.DATE=function(O,S,V){return O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),e.anyIsError(O,S,V)?k.value:0>O||0>S||0>V?k.num:new Date(O,S-1,V)},M.DATEVALUE=function(O){return"string"!=typeof O?k.value:(O=Date.parse(O),isNaN(O)?k.value:-22038912e5>=O?(O-L)/864e5+1:(O-L)/864e5+2)},M.DAY=function(O){return(O=e.parseDate(O))instanceof Error?O:O.getDate()},M.DAYS=function(O,S){return O=e.parseDate(O),S=e.parseDate(S),O instanceof Error?O:S instanceof Error?S:j(O)-j(S)},M.DAYS360=function(O,S,V){},M.EDATE=function(O,S){return(O=e.parseDate(O))instanceof Error?O:isNaN(S)?k.value:(S=parseInt(S,10),O.setMonth(O.getMonth()+S),j(O))},M.EOMONTH=function(O,S){return(O=e.parseDate(O))instanceof Error?O:isNaN(S)?k.value:(S=parseInt(S,10),j(new Date(O.getFullYear(),O.getMonth()+S+1,0)))},M.HOUR=function(O){return(O=e.parseDate(O))instanceof Error?O:O.getHours()},M.INTERVAL=function(O){if("number"!=typeof O&&"string"!=typeof O)return k.value;O=parseInt(O,10);var S=Math.floor(O/94608e4);O%=94608e4;var V=Math.floor(O/2592e3);O%=2592e3;var _=Math.floor(O/86400);O%=86400;var z=Math.floor(O/3600);O%=3600;var W=Math.floor(O/60);return"P"+(0<S?S+"Y":"")+(0<V?V+"M":"")+(0<_?_+"D":"")+"T"+(0<z?z+"H":"")+(0<W?W+"M":"")+(0<(O%=60)?O+"S":"")},M.ISOWEEKNUM=function(O){if((O=e.parseDate(O))instanceof Error)return O;O.setHours(0,0,0),O.setDate(O.getDate()+4-(O.getDay()||7));var S=new Date(O.getFullYear(),0,1);return Math.ceil(((O-S)/864e5+1)/7)},M.MINUTE=function(O){return(O=e.parseDate(O))instanceof Error?O:O.getMinutes()},M.MONTH=function(O){return(O=e.parseDate(O))instanceof Error?O:O.getMonth()+1},M.NETWORKDAYS=function(O,S,V){},M.NETWORKDAYS.INTL=function(O,S,V,_){},M.NOW=function(){return new Date},M.SECOND=function(O){return(O=e.parseDate(O))instanceof Error?O:O.getSeconds()},M.TIME=function(O,S,V){return O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),e.anyIsError(O,S,V)?k.value:0>O||0>S||0>V?k.num:(3600*O+60*S+V)/86400},M.TIMEVALUE=function(O){return(O=e.parseDate(O))instanceof Error?O:(3600*O.getHours()+60*O.getMinutes()+O.getSeconds())/86400},M.TODAY=function(){return new Date},M.WEEKDAY=function(O,S){if((O=e.parseDate(O))instanceof Error)return O;void 0===S&&(S=1);var V=O.getDay();return T[S][V]},M.WEEKNUM=function(O,S){},M.WORKDAY=function(O,S,V){},M.WORKDAY.INTL=function(O,S,V,_){},M.YEAR=function(O){return(O=e.parseDate(O))instanceof Error?O:O.getFullYear()},M.YEARFRAC=function(O,S,V){},M}(),x.database=function(){function g(a,b){for(var d={},f=1;f<a[0].length;++f)d[f]=!0;var h=b[0].length;for(f=1;f<b.length;++f)b[f].length>h&&(h=b[f].length);for(f=1;f<a.length;++f)for(var l=1;l<a[f].length;++l){for(var m=!1,n=!1,p=0;p<b.length;++p){var q=b[p];if(!(q.length<h)&&a[f][0]===q[0]){n=!0;for(var t=1;t<q.length;++t)m=m||eval(a[f][l]+q[t])}}n&&(d[l]=d[l]&&m)}for(h=[],f=0;f<a[0].length;++f)d[f]&&h.push(f-1);return h}var c={FINDFIELD:function(j,M){for(var L=null,T=0;T<j.length;T++)if(j[T][0]===M){L=T;break}return null==L?k.value:L},DAVERAGE:function(j,M,L){if(isNaN(M)&&"string"!=typeof M)return k.value;L=g(j,L),"string"==typeof M&&(M=c.FINDFIELD(j,M)),j=e.rest(j[M]);for(var T=M=0;T<L.length;T++)M+=j[L[T]];return 0===L.length?k.div0:M/L.length},DCOUNT:function(j,M,L){},DCOUNTA:function(j,M,L){},DGET:function(j,M,L){return isNaN(M)&&"string"!=typeof M?k.value:(L=g(j,L),"string"==typeof M&&(M=c.FINDFIELD(j,M)),j=e.rest(j[M]),0===L.length?k.value:1<L.length?k.num:j[L[0]])},DMAX:function(j,M,L){if(isNaN(M)&&"string"!=typeof M)return k.value;L=g(j,L),"string"==typeof M&&(M=c.FINDFIELD(j,M)),M=(j=e.rest(j[M]))[L[0]];for(var T=1;T<L.length;T++)M<j[L[T]]&&(M=j[L[T]]);return M},DMIN:function(j,M,L){if(isNaN(M)&&"string"!=typeof M)return k.value;L=g(j,L),"string"==typeof M&&(M=c.FINDFIELD(j,M)),M=(j=e.rest(j[M]))[L[0]];for(var T=1;T<L.length;T++)M>j[L[T]]&&(M=j[L[T]]);return M},DPRODUCT:function(j,M,L){if(isNaN(M)&&"string"!=typeof M)return k.value;if(L=g(j,L),"string"==typeof M){M=c.FINDFIELD(j,M);var T=e.rest(j[M])}else T=e.rest(j[M]);for(j=[],M=0;M<L.length;M++)j[M]=T[L[M]];if(L=j)for(j=[],M=0;M<L.length;++M)L[M]&&j.push(L[M]);else j=L;for(L=1,M=0;M<j.length;M++)L*=j[M];return L},DSTDEV:function(j,M,L){},DSTDEVP:function(j,M,L){},DSUM:function(j,M,L){},DVAR:function(j,M,L){},DVARP:function(j,M,L){},MATCH:function(j,M,L){if(!j&&!M||(2===arguments.length&&(L=1),!(M instanceof Array)||-1!==L&&0!==L&&1!==L))return k.na;for(var T,O,S=0;S<M.length;S++)if(1===L){if(M[S]===j)return S+1;M[S]<j&&(O?M[S]>O&&(T=S+1,O=M[S]):(T=S+1,O=M[S]))}else if(0===L){if("string"==typeof j){if(j=j.replace(/\?/g,"."),M[S].toLowerCase().match(j.toLowerCase()))return S+1}else if(M[S]===j)return S+1}else if(-1===L){if(M[S]===j)return S+1;M[S]>j&&(O?M[S]<O&&(T=S+1,O=M[S]):(T=S+1,O=M[S]))}return T||k.na}};return c}(),x.engineering=function(){var j={BESSELI:function(M,L){},BESSELJ:function(M,L){},BESSELK:function(M,L){},BESSELY:function(M,L){},BIN2DEC:function(M){if(!/^[01]{1,10}$/.test(M))return k.num;var L=parseInt(M,2);return 10===(M=M.toString()).length&&"1"===M.substring(0,1)?parseInt(M.substring(1),2)-512:L},BIN2HEX:function(M,L){if(!/^[01]{1,10}$/.test(M))return k.num;var T=M.toString();return 10===T.length&&"1"===T.substring(0,1)?(0xfffffffe00+parseInt(T.substring(1),2)).toString(16):(T=parseInt(M,2).toString(16),void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num)},BIN2OCT:function(M,L){if(!/^[01]{1,10}$/.test(M))return k.num;var T=M.toString();return 10===T.length&&"1"===T.substring(0,1)?(1073741312+parseInt(T.substring(1),2)).toString(8):(T=parseInt(M,2).toString(8),void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num)},BITAND:function(M,L){return M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(M,L)?k.value:0>M||0>L||Math.floor(M)!==M||Math.floor(L)!==L||0xffffffffffff<M||0xffffffffffff<L?k.num:M&L},BITLSHIFT:function(M,L){return M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(M,L)?k.value:0>M||Math.floor(M)!==M||0xffffffffffff<M||53<Math.abs(L)?k.num:0<=L?M<<L:M>>-L},BITOR:function(M,L){return M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(M,L)?k.value:0>M||0>L||Math.floor(M)!==M||Math.floor(L)!==L||0xffffffffffff<M||0xffffffffffff<L?k.num:M|L},BITRSHIFT:function(M,L){return M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(M,L)?k.value:0>M||Math.floor(M)!==M||0xffffffffffff<M||53<Math.abs(L)?k.num:0<=L?M>>L:M<<-L},BITXOR:function(M,L){return M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(M,L)?k.value:0>M||0>L||Math.floor(M)!==M||Math.floor(L)!==L||0xffffffffffff<M||0xffffffffffff<L?k.num:M^L},COMPLEX:function(M,L,T){return M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(M,L)?M:"i"!==(T=void 0===T?"i":T)&&"j"!==T?k.value:0===M&&0===L?0:0===M?1===L?T:L.toString()+T:0===L?M.toString():M.toString()+(0<L?"+":"")+(1===L?T:L.toString()+T)},CONVERT:function(M,L,T){if((M=e.parseNumber(M))instanceof Error)return M;for(var Z,O=[["a.u. of action","?",null,"action",!1,!1,105457168181818e-48],["a.u. of charge","e",null,"electric_charge",!1,!1,160217653141414e-33],["a.u. of energy","Eh",null,"energy",!1,!1,435974417757576e-32],["a.u. of length","a?",null,"length",!1,!1,529177210818182e-25],["a.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["a.u. of time","?/Eh",null,"time",!1,!1,241888432650516e-31],["admiralty knot","admkn",null,"speed",!1,!0,.514773333],["ampere","A",null,"electric_current",!0,!1,1],["ampere per meter","A/m",null,"magnetic_field_intensity",!0,!1,1],["\xe5ngstr\xf6m","\xc5",["ang"],"length",!1,!0,1e-10],["are","ar",null,"area",!1,!0,100],["astronomical unit","ua",null,"length",!1,!1,149597870691667e-25],["bar","bar",null,"pressure",!1,!1,1e5],["barn","b",null,"area",!1,!1,1e-28],["becquerel","Bq",null,"radioactivity",!0,!1,1],["bit","bit",["b"],"information",!1,!0,1],["btu","BTU",["btu"],"energy",!1,!0,1055.05585262],["byte","byte",null,"information",!1,!0,8],["candela","cd",null,"luminous_intensity",!0,!1,1],["candela per square metre","cd/m?",null,"luminance",!0,!1,1],["coulomb","C",null,"electric_charge",!0,!1,1],["cubic \xe5ngstr\xf6m","ang3",["ang^3"],"volume",!1,!0,1e-30],["cubic foot","ft3",["ft^3"],"volume",!1,!0,.028316846592],["cubic inch","in3",["in^3"],"volume",!1,!0,16387064e-12],["cubic light-year","ly3",["ly^3"],"volume",!1,!0,846786664623715e-61],["cubic metre","m?",null,"volume",!0,!0,1],["cubic mile","mi3",["mi^3"],"volume",!1,!0,4168181825.44058],["cubic nautical mile","Nmi3",["Nmi^3"],"volume",!1,!0,6352182208],["cubic Pica","Pica3",["Picapt3","Pica^3","Picapt^3"],"volume",!1,!0,7.58660370370369e-8],["cubic yard","yd3",["yd^3"],"volume",!1,!0,.764554857984],["cup","cup",null,"volume",!1,!0,.0002365882365],["dalton","Da",["u"],"mass",!1,!1,166053886282828e-41],["day","d",["day"],"time",!1,!0,86400],["degree","\xb0",null,"angle",!1,!1,.0174532925199433],["degrees Rankine","Rank",null,"temperature",!1,!0,.555555555555556],["dyne","dyn",["dy"],"force",!1,!0,1e-5],["electronvolt","eV",["ev"],"energy",!1,!0,1.60217656514141],["ell","ell",null,"length",!1,!0,1.143],["erg","erg",["e"],"energy",!1,!0,1e-7],["farad","F",null,"electric_capacitance",!0,!1,1],["fluid ounce","oz",null,"volume",!1,!0,295735295625e-16],["foot","ft",null,"length",!1,!0,.3048],["foot-pound","flb",null,"energy",!1,!0,1.3558179483314],["gal","Gal",null,"acceleration",!1,!1,.01],["gallon","gal",null,"volume",!1,!0,.003785411784],["gauss","G",["ga"],"magnetic_flux_density",!1,!0,1],["grain","grain",null,"mass",!1,!0,647989e-10],["gram","g",null,"mass",!1,!0,.001],["gray","Gy",null,"absorbed_dose",!0,!1,1],["gross registered ton","GRT",["regton"],"volume",!1,!0,2.8316846592],["hectare","ha",null,"area",!1,!0,1e4],["henry","H",null,"inductance",!0,!1,1],["hertz","Hz",null,"frequency",!0,!1,1],["horsepower","HP",["h"],"power",!1,!0,745.69987158227],["horsepower-hour","HPh",["hh","hph"],"energy",!1,!0,2684519.538],["hour","h",["hr"],"time",!1,!0,3600],["imperial gallon (U.K.)","uk_gal",null,"volume",!1,!0,.00454609],["imperial hundredweight","lcwt",["uk_cwt","hweight"],"mass",!1,!0,50.802345],["imperial quart (U.K)","uk_qt",null,"volume",!1,!0,.0011365225],["imperial ton","brton",["uk_ton","LTON"],"mass",!1,!0,1016.046909],["inch","in",null,"length",!1,!0,.0254],["international acre","uk_acre",null,"area",!1,!0,4046.8564224],["IT calorie","cal",null,"energy",!1,!0,4.1868],["joule","J",null,"energy",!0,!0,1],["katal","kat",null,"catalytic_activity",!0,!1,1],["kelvin","K",["kel"],"temperature",!0,!0,1],["kilogram","kg",null,"mass",!0,!0,1],["knot","kn",null,"speed",!1,!0,.514444444444444],["light-year","ly",null,"length",!1,!0,9460730472580800],["litre","L",["l","lt"],"volume",!1,!0,.001],["lumen","lm",null,"luminous_flux",!0,!1,1],["lux","lx",null,"illuminance",!0,!1,1],["maxwell","Mx",null,"magnetic_flux",!1,!1,1e-18],["measurement ton","MTON",null,"volume",!1,!0,1.13267386368],["meter per hour","m/h",["m/hr"],"speed",!1,!0,.00027777777777778],["meter per second","m/s",["m/sec"],"speed",!0,!0,1],["meter per second squared","m?s??",null,"acceleration",!0,!1,1],["parsec","pc",["parsec"],"length",!1,!0,0x6da012f958ee1c],["meter squared per second","m?/s",null,"kinematic_viscosity",!0,!1,1],["metre","m",null,"length",!0,!0,1],["miles per hour","mph",null,"speed",!1,!0,.44704],["millimetre of mercury","mmHg",null,"pressure",!1,!1,133.322],["minute","?",null,"angle",!1,!1,.000290888208665722],["minute","min",["mn"],"time",!1,!0,60],["modern teaspoon","tspm",null,"volume",!1,!0,5e-6],["mole","mol",null,"amount_of_substance",!0,!1,1],["morgen","Morgen",null,"area",!1,!0,2500],["n.u. of action","?",null,"action",!1,!1,105457168181818e-48],["n.u. of mass","m?",null,"mass",!1,!1,910938261616162e-45],["n.u. of speed","c?",null,"speed",!1,!1,299792458],["n.u. of time","?/(me?c??)",null,"time",!1,!1,128808866778687e-35],["nautical mile","M",["Nmi"],"length",!1,!0,1852],["newton","N",null,"force",!0,!0,1],["\u0153rsted","Oe ",null,"magnetic_field_intensity",!1,!1,79.5774715459477],["ohm","\u03a9",null,"electric_resistance",!0,!1,1],["ounce mass","ozm",null,"mass",!1,!0,.028349523125],["pascal","Pa",null,"pressure",!0,!1,1],["pascal second","Pa?s",null,"dynamic_viscosity",!0,!1,1],["pferdest\xe4rke","PS",null,"power",!1,!0,735.49875],["phot","ph",null,"illuminance",!1,!1,1e-4],["pica (1/6 inch)","pica",null,"length",!1,!0,.00035277777777778],["pica (1/72 inch)","Pica",["Picapt"],"length",!1,!0,.00423333333333333],["poise","P",null,"dynamic_viscosity",!1,!1,.1],["pond","pond",null,"force",!1,!0,.00980665],["pound force","lbf",null,"force",!1,!0,4.4482216152605],["pound mass","lbm",null,"mass",!1,!0,.45359237],["quart","qt",null,"volume",!1,!0,.000946352946],["radian","rad",null,"angle",!0,!1,1],["second","?",null,"angle",!1,!1,484813681109536e-20],["second","s",["sec"],"time",!0,!0,1],["short hundredweight","cwt",["shweight"],"mass",!1,!0,45.359237],["siemens","S",null,"electrical_conductance",!0,!1,1],["sievert","Sv",null,"equivalent_dose",!0,!1,1],["slug","sg",null,"mass",!1,!0,14.59390294],["square \xe5ngstr\xf6m","ang2",["ang^2"],"area",!1,!0,1e-20],["square foot","ft2",["ft^2"],"area",!1,!0,.09290304],["square inch","in2",["in^2"],"area",!1,!0,64516e-8],["square light-year","ly2",["ly^2"],"area",!1,!0,895054210748189e17],["square meter","m?",null,"area",!0,!0,1],["square mile","mi2",["mi^2"],"area",!1,!0,2589988.110336],["square nautical mile","Nmi2",["Nmi^2"],"area",!1,!0,3429904],["square Pica","Pica2",["Picapt2","Pica^2","Picapt^2"],"area",!1,!0,1792111111111e-17],["square yard","yd2",["yd^2"],"area",!1,!0,.83612736],["statute mile","mi",null,"length",!1,!0,1609.344],["steradian","sr",null,"solid_angle",!0,!1,1],["stilb","sb",null,"luminance",!1,!1,1e-4],["stokes","St",null,"kinematic_viscosity",!1,!1,1e-4],["stone","stone",null,"mass",!1,!0,6.35029318],["tablespoon","tbs",null,"volume",!1,!0,147868e-10],["teaspoon","tsp",null,"volume",!1,!0,492892e-11],["tesla","T",null,"magnetic_flux_density",!0,!0,1],["thermodynamic calorie","c",null,"energy",!1,!0,4.184],["ton","ton",null,"mass",!1,!0,907.18474],["tonne","t",null,"mass",!1,!1,1e3],["U.K. pint","uk_pt",null,"volume",!1,!0,.00056826125],["U.S. bushel","bushel",null,"volume",!1,!0,.03523907],["U.S. oil barrel","barrel",null,"volume",!1,!0,.158987295],["U.S. pint","pt",["us_pt"],"volume",!1,!0,.000473176473],["U.S. survey mile","survey_mi",null,"length",!1,!0,1609.347219],["U.S. survey/statute acre","us_acre",null,"area",!1,!0,4046.87261],["volt","V",null,"voltage",!0,!1,1],["watt","W",null,"power",!0,!0,1],["watt-hour","Wh",["wh"],"energy",!1,!0,3600],["weber","Wb",null,"magnetic_flux",!0,!1,1],["yard","yd",null,"length",!1,!0,.9144],["year","yr",null,"time",!1,!0,31557600]],S={Yi:["yobi",80,12089258196146292e8,"Yi","yotta"],Zi:["zebi",70,11805916207174113e5,"Zi","zetta"],Ei:["exbi",60,0x1000000000000000,"Ei","exa"],Pi:["pebi",50,0x4000000000000,"Pi","peta"],Ti:["tebi",40,1099511627776,"Ti","tera"],Gi:["gibi",30,1073741824,"Gi","giga"],Mi:["mebi",20,1048576,"Mi","mega"],ki:["kibi",10,1024,"ki","kilo"]},V={Y:["yotta",1e24,"Y"],Z:["zetta",1e21,"Z"],E:["exa",1e18,"E"],P:["peta",1e15,"P"],T:["tera",1e12,"T"],G:["giga",1e9,"G"],M:["mega",1e6,"M"],k:["kilo",1e3,"k"],h:["hecto",100,"h"],e:["dekao",10,"e"],d:["deci",.1,"d"],c:["centi",.01,"c"],m:["milli",.001,"m"],u:["micro",1e-6,"u"],n:["nano",1e-9,"n"],p:["pico",1e-12,"p"],f:["femto",1e-15,"f"],a:["atto",1e-18,"a"],z:["zepto",1e-21,"z"],y:["yocto",1e-24,"y"]},_=null,z=null,W=L,te=T,ee=1,Q=1,X=0;X<O.length;X++)Z=null===O[X][2]?[]:O[X][2],(O[X][1]===W||0<=Z.indexOf(W))&&(_=O[X]),(O[X][1]===te||0<=Z.indexOf(te))&&(z=O[X]);if(null===_)for(Z=S[L.substring(0,2)],X=V[L.substring(0,1)],"da"===L.substring(0,2)&&(X=["dekao",10,"da"]),Z?(ee=Z[2],W=L.substring(2)):X&&(ee=X[1],W=L.substring(X[2].length)),L=0;L<O.length;L++)Z=null===O[L][2]?[]:O[L][2],(O[L][1]===W||0<=Z.indexOf(W))&&(_=O[L]);if(null===z)for(S=S[T.substring(0,2)],V=V[T.substring(0,1)],"da"===T.substring(0,2)&&(V=["dekao",10,"da"]),S?(Q=S[2],te=T.substring(2)):V&&(Q=V[1],te=T.substring(V[2].length)),T=0;T<O.length;T++)Z=null===O[T][2]?[]:O[T][2],(O[T][1]===te||0<=Z.indexOf(te))&&(z=O[T]);return null===_||null===z||_[3]!==z[3]?k.na:M*_[6]*ee/(z[6]*Q)},DEC2BIN:function(M,L){if((M=e.parseNumber(M))instanceof Error)return M;if(!/^-?[0-9]{1,3}$/.test(M)||-512>M||511<M)return k.num;if(0>M)return"1"+REPT("0",9-(512+M).toString(2).length)+(512+M).toString(2);var T=parseInt(M,10).toString(2);return void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num},DEC2HEX:function(M,L){if((M=e.parseNumber(M))instanceof Error)return M;if(!/^-?[0-9]{1,12}$/.test(M)||-549755813888>M||549755813887<M)return k.num;if(0>M)return(1099511627776+M).toString(16);var T=parseInt(M,10).toString(16);return void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num},DEC2OCT:function(M,L){if((M=e.parseNumber(M))instanceof Error)return M;if(!/^-?[0-9]{1,9}$/.test(M)||-536870912>M||536870911<M)return k.num;if(0>M)return(1073741824+M).toString(8);var T=parseInt(M,10).toString(8);return void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num},DELTA:function(M,L){return L=void 0===L?0:L,M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(M,L)?k.value:M===L?1:0},ERF:function(M,L){}};return j.ERF.PRECISE=function(){},j.ERFC=function(M){},j.ERFC.PRECISE=function(){},j.GESTEP=function(M,L){return L=L||0,M=e.parseNumber(M),e.anyIsError(L,M)?M:M>=L?1:0},j.HEX2BIN=function(M,L){if(!/^[0-9A-Fa-f]{1,10}$/.test(M))return k.num;var T=10===M.length&&"f"===M.substring(0,1).toLowerCase(),O=T?parseInt(M,16)-1099511627776:parseInt(M,16);return-512>O||511<O?k.num:T?"1"+REPT("0",9-(512+O).toString(2).length)+(512+O).toString(2):(T=O.toString(2),void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num)},j.HEX2DEC=function(M){return/^[0-9A-Fa-f]{1,10}$/.test(M)?549755813888<=(M=parseInt(M,16))?M-1099511627776:M:k.num},j.HEX2OCT=function(M,L){if(!/^[0-9A-Fa-f]{1,10}$/.test(M))return k.num;var T=parseInt(M,16);return 536870911<T&&0xffe0000000>T?k.num:0xffe0000000<=T?(T-0xffc0000000).toString(8):(T=T.toString(8),void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num)},j.IMABS=function(M){var L=j.IMREAL(M);return M=j.IMAGINARY(M),e.anyIsError(L,M)?k.value:Math.sqrt(Math.pow(L,2)+Math.pow(M,2))},j.IMAGINARY=function(M){if(void 0===M||!0===M||!1===M)return k.value;if(0===M||"0"===M)return 0;if(0<=["i","j"].indexOf(M))return 1;var L=(M=M.replace("+i","+1i").replace("-i","-1i").replace("+j","+1j").replace("-j","-1j")).indexOf("+"),T=M.indexOf("-");0===L&&(L=M.indexOf("+",1)),0===T&&(T=M.indexOf("-",1));var O=M.substring(M.length-1,M.length);return O="i"===O||"j"===O,0<=L||0<=T?O?0<=L?isNaN(M.substring(0,L))||isNaN(M.substring(L+1,M.length-1))?k.num:Number(M.substring(L+1,M.length-1)):isNaN(M.substring(0,T))||isNaN(M.substring(T+1,M.length-1))?k.num:-Number(M.substring(T+1,M.length-1)):k.num:O?isNaN(M.substring(0,M.length-1))?k.num:M.substring(0,M.length-1):isNaN(M)?k.num:0},j.IMARGUMENT=function(M){var L=j.IMREAL(M);return M=j.IMAGINARY(M),e.anyIsError(L,M)?k.value:0===L&&0===M?k.div0:0===L&&0<M?Math.PI/2:0===L&&0>M?-Math.PI/2:0===M&&0<L?0:0===M&&0>L?-Math.PI:0<L?Math.atan(M/L):0>L&&0<=M?Math.atan(M/L)+Math.PI:Math.atan(M/L)-Math.PI},j.IMCONJUGATE=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);if(e.anyIsError(L,T))return k.value;var O=M.substring(M.length-1);return 0!==T?j.COMPLEX(L,-T,"i"===O||"j"===O?O:"i"):M},j.IMCOS=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),j.COMPLEX(Math.cos(L)*(Math.exp(T)+Math.exp(-T))/2,-Math.sin(L)*(Math.exp(T)-Math.exp(-T))/2,"i"===M||"j"===M?M:"i"))},j.IMCOSH=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),j.COMPLEX(Math.cos(T)*(Math.exp(L)+Math.exp(-L))/2,Math.sin(T)*(Math.exp(L)-Math.exp(-L))/2,"i"===M||"j"===M?M:"i"))},j.IMCOT=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:j.IMDIV(j.IMCOS(M),j.IMSIN(M))},j.IMDIV=function(M,L){var T=j.IMREAL(M),O=j.IMAGINARY(M),S=j.IMREAL(L),V=j.IMAGINARY(L);if(e.anyIsError(T,O,S,V))return k.value;var _=M.substring(M.length-1),z=L.substring(L.length-1),W="i";return("j"===_||"j"===z)&&(W="j"),0===S&&0===V?k.num:j.COMPLEX((T*S+O*V)/(_=S*S+V*V),(O*S-T*V)/_,W)},j.IMEXP=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),L=Math.exp(L),j.COMPLEX(L*Math.cos(T),L*Math.sin(T),"i"===M||"j"===M?M:"i"))},j.IMLN=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),j.COMPLEX(Math.log(Math.sqrt(L*L+T*T)),Math.atan(T/L),"i"===M||"j"===M?M:"i"))},j.IMLOG10=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),j.COMPLEX(Math.log(Math.sqrt(L*L+T*T))/Math.log(10),Math.atan(T/L)/Math.log(10),"i"===M||"j"===M?M:"i"))},j.IMLOG2=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),j.COMPLEX(Math.log(Math.sqrt(L*L+T*T))/Math.log(2),Math.atan(T/L)/Math.log(2),"i"===M||"j"===M?M:"i"))},j.IMPOWER=function(M,L){L=e.parseNumber(L);var T=j.IMREAL(M),O=j.IMAGINARY(M);if(e.anyIsError(L,T,O))return k.value;T="i"===(T=M.substring(M.length-1))||"j"===T?T:"i",O=Math.pow(j.IMABS(M),L);var S=j.IMARGUMENT(M);return j.COMPLEX(O*Math.cos(L*S),O*Math.sin(L*S),T)},j.IMPRODUCT=function(){for(var M=arguments[0],L=1;L<arguments.length;L++){var T=j.IMREAL(M);M=j.IMAGINARY(M);var O=j.IMREAL(arguments[L]),S=j.IMAGINARY(arguments[L]);if(e.anyIsError(T,M,O,S))return k.value;M=j.COMPLEX(T*O-M*S,T*S+M*O)}return M},j.IMREAL=function(M){if(void 0===M||!0===M||!1===M)return k.value;if(0===M||"0"===M||0<="i +i 1i +1i -i -1i j +j 1j +1j -j -1j".split(" ").indexOf(M))return 0;var L=M.indexOf("+"),T=M.indexOf("-");0===L&&(L=M.indexOf("+",1)),0===T&&(T=M.indexOf("-",1));var O=M.substring(M.length-1,M.length);return O="i"===O||"j"===O,0<=L||0<=T?O?0<=L?isNaN(M.substring(0,L))||isNaN(M.substring(L+1,M.length-1))?k.num:Number(M.substring(0,L)):isNaN(M.substring(0,T))||isNaN(M.substring(T+1,M.length-1))?k.num:Number(M.substring(0,T)):k.num:O?isNaN(M.substring(0,M.length-1))?k.num:0:isNaN(M)?k.num:M},j.IMSEC=function(M){if(!0===M||!1===M)return k.value;var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:j.IMDIV("1",j.IMCOS(M))},j.IMSECH=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:j.IMDIV("1",j.IMCOSH(M))},j.IMSIN=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),j.COMPLEX(Math.sin(L)*(Math.exp(T)+Math.exp(-T))/2,Math.cos(L)*(Math.exp(T)-Math.exp(-T))/2,"i"===M||"j"===M?M:"i"))},j.IMSINH=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(M=M.substring(M.length-1),j.COMPLEX(Math.cos(T)*(Math.exp(L)-Math.exp(-L))/2,Math.sin(T)*(Math.exp(L)+Math.exp(-L))/2,"i"===M||"j"===M?M:"i"))},j.IMSQRT=function(M){var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:(L="i"===(L=M.substring(M.length-1))||"j"===L?L:"i",T=Math.sqrt(j.IMABS(M)),M=j.IMARGUMENT(M),j.COMPLEX(T*Math.cos(M/2),T*Math.sin(M/2),L))},j.IMCSC=function(M){if(!0===M||!1===M)return k.value;var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.num:j.IMDIV("1",j.IMSIN(M))},j.IMCSCH=function(M){if(!0===M||!1===M)return k.value;var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.num:j.IMDIV("1",j.IMSINH(M))},j.IMSUB=function(M,L){var T=this.IMREAL(M),O=this.IMAGINARY(M),S=this.IMREAL(L),V=this.IMAGINARY(L);if(e.anyIsError(T,O,S,V))return k.value;var _=M.substring(M.length-1),z=L.substring(L.length-1),W="i";return("j"===_||"j"===z)&&(W="j"),this.COMPLEX(T-S,O-V,W)},j.IMSUM=function(){for(var M=e.flatten(arguments),L=M[0],T=1;T<M.length;T++){var O=this.IMREAL(L);L=this.IMAGINARY(L);var S=this.IMREAL(M[T]),V=this.IMAGINARY(M[T]);if(e.anyIsError(O,L,S,V))return k.value;L=this.COMPLEX(O+S,L+V)}return L},j.IMTAN=function(M){if(!0===M||!1===M)return k.value;var L=j.IMREAL(M),T=j.IMAGINARY(M);return e.anyIsError(L,T)?k.value:this.IMDIV(this.IMSIN(M),this.IMCOS(M))},j.OCT2BIN=function(M,L){if(!/^[0-7]{1,10}$/.test(M))return k.num;var T=10===M.length&&"7"===M.substring(0,1),O=T?parseInt(M,8)-1073741824:parseInt(M,8);return-512>O||511<O?k.num:T?"1"+REPT("0",9-(512+O).toString(2).length)+(512+O).toString(2):(T=O.toString(2),void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num)},j.OCT2DEC=function(M){return/^[0-7]{1,10}$/.test(M)?536870912<=(M=parseInt(M,8))?M-1073741824:M:k.num},j.OCT2HEX=function(M,L){if(!/^[0-7]{1,10}$/.test(M))return k.num;var T=parseInt(M,8);return 536870912<=T?"ff"+(T+3221225472).toString(16):(T=T.toString(16),void 0===L?T:isNaN(L)?k.value:0>L?k.num:(L=Math.floor(L))>=T.length?REPT("0",L-T.length)+T:k.num)},j}(),x.financial=function(){function j(T){return T&&T.getTime&&!isNaN(T.getTime())}function M(T){return T instanceof Date?T:new Date(T)}var L={ACCRINT:function(T,O,S,V,_,z,W){return T=M(T),O=M(O),S=M(S),j(T)&&j(O)&&j(S)?0>=V||0>=_||-1===[1,2,4].indexOf(z)||-1===[0,1,2,3,4].indexOf(W)||S<=T?"#NUM!":(_||0)*V*YEARFRAC(T,S,W||0):"#VALUE!"},ACCRINTM:null,AMORDEGRC:null,AMORLINC:null,COUPDAYBS:null,COUPDAYS:null,COUPDAYSNC:null,COUPNCD:null,COUPNUM:null,COUPPCD:null,CUMIPMT:function(T,O,S,V,_,z){if(T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),e.anyIsError(T,O,S))return k.value;if(0>=T||0>=O||0>=S||1>V||1>_||V>_||0!==z&&1!==z)return k.num;O=L.PMT(T,O,S,0,z);var W=0;for(1===V&&0===z&&(W=-S,V++);V<=_;V++)W=1===z?W+(L.FV(T,V-2,O,S,1)-O):W+L.FV(T,V-1,O,S,0);return W*T},CUMPRINC:function(T,O,S,V,_,z){if(T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),e.anyIsError(T,O,S))return k.value;if(0>=T||0>=O||0>=S||1>V||1>_||V>_||0!==z&&1!==z)return k.num;O=L.PMT(T,O,S,0,z);var W=0;for(1===V&&(W=0===z?O+S*T:O,V++);V<=_;V++)W=0<z?W+(O-(L.FV(T,V-2,O,S,1)-O)*T):W+(O-L.FV(T,V-1,O,S,0)*T);return W},DB:function(T,O,S,V,_){if(_=void 0===_?12:_,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),e.anyIsError(T,O,S,V,_))return k.value;if(0>T||0>O||0>S||0>V||-1===[1,2,3,4,5,6,7,8,9,10,11,12].indexOf(_)||V>S)return k.num;if(O>=T)return 0;for(var z=_=T*(O=(1-Math.pow(O/T,1/S)).toFixed(3))*_/12,W=0,te=V===S?S-1:V,ee=2;ee<=te;ee++)z+=W=(T-z)*O;return 1===V?_:V===S?(T-z)*O:W},DDB:function(T,O,S,V,_){if(_=void 0===_?2:_,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),e.anyIsError(T,O,S,V,_))return k.value;if(0>T||0>O||0>S||0>V||0>=_||V>S)return k.num;if(O>=T)return 0;for(var z=0,W=0,te=1;te<=V;te++)z+=W=Math.min(_/S*(T-z),T-O-z);return W},DISC:null,DOLLARDE:function(T,O){if(T=e.parseNumber(T),O=e.parseNumber(O),e.anyIsError(T,O))return k.value;if(0>O)return k.num;if(0<=O&&1>O)return k.div0;O=parseInt(O,10);var S=parseInt(T,10);S+=T%1*Math.pow(10,Math.ceil(Math.log(O)/Math.LN10))/O;var V=Math.pow(10,Math.ceil(Math.log(O)/Math.LN2)+1);return Math.round(S*V)/V},DOLLARFR:function(T,O){return T=e.parseNumber(T),O=e.parseNumber(O),e.anyIsError(T,O)?k.value:0>O?k.num:0<=O&&1>O?k.div0:(O=parseInt(O,10),parseInt(T,10)+T%1*Math.pow(10,-Math.ceil(Math.log(O)/Math.LN10))*O)},DURATION:null,EFFECT:function(T,O){return T=e.parseNumber(T),O=e.parseNumber(O),e.anyIsError(T,O)?k.value:0>=T||1>O?k.num:(O=parseInt(O,10),Math.pow(1+T/O,O)-1)},FV:function(T,O,S,V,_){return V=V||0,_=_||0,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),e.anyIsError(T,O,S,V,_)?k.value:(0===T?T=V+S*O:(O=Math.pow(1+T,O),T=1===_?V*O+S*(1+T)*(O-1)/T:V*O+S*(O-1)/T),-T)},FVSCHEDULE:function(T,O){if(T=e.parseNumber(T),O=e.parseNumberArray(e.flatten(O)),e.anyIsError(T,O))return k.value;for(var S=O.length,V=T,_=0;_<S;_++)V*=1+O[_];return V},INTRATE:null,IPMT:function(T,O,S,V,_,z){return _=_||0,z=z||0,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),z=e.parseNumber(z),e.anyIsError(T,O,S,V,_,z)?k.value:(S=L.PMT(T,S,V,_,z),(1===O?1===z?0:-V:1===z?L.FV(T,O-2,S,V,1)-S:L.FV(T,O-1,S,V,0))*T)},IRR:function(T,O){if(O=O||0,T=e.parseNumberArray(e.flatten(T)),O=e.parseNumber(O),e.anyIsError(T,O))return k.value;for(var S=function(Q,Z,X){X+=1;for(var se=Q[0],oe=1;oe<Q.length;oe++)se+=Q[oe]/Math.pow(X,(Z[oe]-Z[0])/365);return se},V=function(Q,Z,X){X+=1;for(var se=0,oe=1;oe<Q.length;oe++){var me=(Z[oe]-Z[0])/365;se-=me*Q[oe]/Math.pow(X,me+1)}return se},_=[],z=!1,W=!1,te=0;te<T.length;te++)_[te]=0===te?0:_[te-1]+365,0<T[te]&&(z=!0),0>T[te]&&(W=!0);if(!z||!W)return k.num;z=void 0===O?.1:O,W=!0;do{var ee=S(T,_,z);W=z-ee/V(T,_,z),te=Math.abs(W-z),z=W,W=1e-10<te&&1e-10<Math.abs(ee)}while(W);return z},ISPMT:function(T,O,S,V){return T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),e.anyIsError(T,O,S,V)?k.value:V*T*(O/S-1)},MDURATION:null,MIRR:function(T,O,S){if(T=e.parseNumberArray(e.flatten(T)),O=e.parseNumber(O),S=e.parseNumber(S),e.anyIsError(T,O,S))return k.value;for(var V=T.length,_=[],z=[],W=0;W<V;W++)0>T[W]?_.push(T[W]):z.push(T[W]);return T=-L.NPV(S,z)*Math.pow(1+S,V-1),O=L.NPV(O,_)*(1+O),Math.pow(T/O,1/(V-1))-1},NOMINAL:function(T,O){return T=e.parseNumber(T),O=e.parseNumber(O),e.anyIsError(T,O)?k.value:0>=T||1>O?k.num:(O=parseInt(O,10),(Math.pow(T+1,1/O)-1)*O)},NPER:function(T,O,S,V,_){return _=void 0===_?0:_,V=void 0===V?0:V,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),e.anyIsError(T,O,S,V,_)?k.value:Math.log((O*(1+T*_)-V*T)/(S*T+O*(1+T*_)))/Math.log(1+T)},NPV:function(){var T=e.parseNumberArray(e.flatten(arguments));if(T instanceof Error)return T;for(var O=T[0],S=0,V=1;V<T.length;V++)S+=T[V]/Math.pow(1+O,V);return S},ODDFPRICE:null,ODDFYIELD:null,ODDLPRICE:null,ODDLYIELD:null,PDURATION:function(T,O,S){return T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),e.anyIsError(T,O,S)?k.value:0>=T?k.num:(Math.log(S)-Math.log(O))/Math.log(1+T)},PMT:function(T,O,S,V,_){return V=V||0,_=_||0,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),e.anyIsError(T,O,S,V,_)?k.value:(0===T?T=(S+V)/O:(O=Math.pow(1+T,O),T=1===_?(V*T/(O-1)+S*T/(1-1/O))/(1+T):V*T/(O-1)+S*T/(1-1/O)),-T)},PPMT:function(T,O,S,V,_,z){return _=_||0,z=z||0,T=e.parseNumber(T),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),z=e.parseNumber(z),e.anyIsError(T,S,V,_,z)?k.value:L.PMT(T,S,V,_,z)-L.IPMT(T,O,S,V,_,z)},PRICE:null,PRICEDISC:null,PRICEMAT:null,PV:function(T,O,S,V,_){return V=V||0,_=_||0,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),e.anyIsError(T,O,S,V,_)?k.value:0===T?-S*O-V:((1-Math.pow(1+T,O))/T*S*(1+T*_)-V)/Math.pow(1+T,O)},RATE:function(T,O,S,V,_,z){if(z=void 0===z?.01:z,V=void 0===V?0:V,_=void 0===_?0:_,T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),_=e.parseNumber(_),z=e.parseNumber(z),e.anyIsError(T,O,S,V,_,z))return k.value;for(var W=0,te=!1;100>W&&!te;){var ee=Math.pow(z+1,T),Q=Math.pow(z+1,T-1);ee=z-(V+ee*S+O*(ee-1)*(z*_+1)/z)/(T*Q*S-O*(ee-1)*(z*_+1)/Math.pow(z,2)+(T*O*Q*(z*_+1)/z+O*(ee-1)*_/z)),1e-6>Math.abs(ee-z)&&(te=!0),W++,z=ee}return te?z:Number.NaN+z},RECEIVED:null,RRI:function(T,O,S){return T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),e.anyIsError(T,O,S)?k.value:0===T||0===O?k.num:Math.pow(S/O,1/T)-1},SLN:function(T,O,S){return T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),e.anyIsError(T,O,S)?k.value:0===S?k.num:(T-O)/S},SYD:function(T,O,S,V){return T=e.parseNumber(T),O=e.parseNumber(O),S=e.parseNumber(S),V=e.parseNumber(V),e.anyIsError(T,O,S,V)?k.value:0===S||1>V||V>S?k.num:(T-O)*(S-(V=parseInt(V,10))+1)*2/(S*(S+1))},TBILLEQ:function(T,O,S){return T=e.parseDate(T),O=e.parseDate(O),S=e.parseNumber(S),e.anyIsError(T,O,S)?k.value:0>=S||T>O||31536e6<O-T?k.num:365*S/(360-S*DAYS360(T,O,!1))},TBILLPRICE:function(T,O,S){return T=e.parseDate(T),O=e.parseDate(O),S=e.parseNumber(S),e.anyIsError(T,O,S)?k.value:0>=S||T>O||31536e6<O-T?k.num:100*(1-S*DAYS360(T,O,!1)/360)},TBILLYIELD:function(T,O,S){return T=e.parseDate(T),O=e.parseDate(O),S=e.parseNumber(S),e.anyIsError(T,O,S)?k.value:0>=S||T>O||31536e6<O-T?k.num:360*(100-S)/(S*DAYS360(T,O,!1))},VDB:null,XIRR:function(T,O,S){if(T=e.parseNumberArray(e.flatten(T)),O=e.parseDateArray(e.flatten(O)),S=e.parseNumber(S),e.anyIsError(T,O,S))return k.value;for(var V=function(ee,Q,Z){Z+=1;for(var X=ee[0],se=1;se<ee.length;se++)X+=ee[se]/Math.pow(Z,DAYS(Q[se],Q[0])/365);return X},_=function(ee,Q,Z){Z+=1;for(var X=0,se=1;se<ee.length;se++){var oe=DAYS(Q[se],Q[0])/365;X-=oe*ee[se]/Math.pow(Z,oe+1)}return X},z=!1,W=!1,te=0;te<T.length;te++)0<T[te]&&(z=!0),0>T[te]&&(W=!0);if(!z||!W)return k.num;S=S||.1,z=!0;do{z=S-(te=V(T,O,S))/_(T,O,S),W=Math.abs(z-S),S=z,z=1e-10<W&&1e-10<Math.abs(te)}while(z);return S},XNPV:function(T,O,S){if(T=e.parseNumber(T),O=e.parseNumberArray(e.flatten(O)),S=e.parseDateArray(e.flatten(S)),e.anyIsError(T,O,S))return k.value;for(var V=0,_=0;_<O.length;_++)V+=O[_]/Math.pow(1+T,DAYS(S[_],S[0])/365);return V},YIELD:null,YIELDDISC:null,YIELDMAT:null};return L}(),x.information=function(){var j={CELL:null,ERROR:{}};return j.ERROR.TYPE=function(M){switch(M){case k.nil:return 1;case k.div0:return 2;case k.value:return 3;case k.ref:return 4;case k.name:return 5;case k.num:return 6;case k.na:return 7;case k.data:return 8}return k.na},j.INFO=null,j.ISBLANK=function(M){return null===M},j.ISBINARY=function(M){return/^[01]{1,10}$/.test(M)},j.ISERR=function(M){return 0<=[k.value,k.ref,k.div0,k.num,k.name,k.nil].indexOf(M)||"number"==typeof M&&(isNaN(M)||!isFinite(M))},j.ISERROR=function(M){return j.ISERR(M)||M===k.na},j.ISEVEN=function(M){return!(1&Math.floor(Math.abs(M)))},j.ISFORMULA=null,j.ISLOGICAL=function(M){return!0===M||!1===M},j.ISNA=function(M){return M===k.na},j.ISNONTEXT=function(M){return"string"!=typeof M},j.ISNUMBER=function(M){return"number"==typeof M&&!isNaN(M)&&isFinite(M)},j.ISODD=function(M){return!!(1&Math.floor(Math.abs(M)))},j.ISREF=null,j.ISTEXT=function(M){return"string"==typeof M},j.N=function(M){return this.ISNUMBER(M)?M:M instanceof Date?M.getTime():!0===M?1:!1===M?0:this.ISERROR(M)?M:0},j.NA=function(){return k.na},j.SHEET=null,j.SHEETS=null,j.TYPE=function(M){return this.ISNUMBER(M)?1:this.ISTEXT(M)?2:this.ISLOGICAL(M)?4:this.ISERROR(M)?16:Array.isArray(M)?64:void 0},j}(),x.logical={AND:function(){for(var j=e.flatten(arguments),M=!0,L=0;L<j.length;L++)j[L]||(M=!1);return M},CHOOSE:function(){if(2>arguments.length)return k.na;var j=arguments[0];return 1>j||254<j||arguments.length<j+1?k.value:arguments[j]},FALSE:function(){return!1},IF:function(j,M,L){return j?M:L},IFERROR:function(j,M){return ISERROR(j)?M:j},IFNA:function(j,M){return j===k.na?M:j},NOT:function(j){return!j},OR:function(){for(var j=e.flatten(arguments),M=!1,L=0;L<j.length;L++)j[L]&&(M=!0);return M},TRUE:function(){return!0},XOR:function(){for(var j=e.flatten(arguments),M=0,L=0;L<j.length;L++)j[L]&&M++;return!!(1&Math.floor(Math.abs(M)))},SWITCH:function(){if(0<arguments.length){var j=arguments[0],M=arguments.length-1,L=Math.floor(M/2),T=!1;if(M=M%2==0?null:arguments[arguments.length-1],L)for(var O=0;O<L;O++)if(j===arguments[2*O+1]){var S=arguments[2*O+2];T=!0;break}!T&&M&&(S=M)}return S}},x.math=function(){var g={ABS:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.abs(e.parseNumber(j))},ACOS:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.acos(j)},ACOSH:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.log(j+Math.sqrt(j*j-1))},ACOT:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.atan(1/j)},ACOTH:function(j){return(j=e.parseNumber(j))instanceof Error?j:.5*Math.log((j+1)/(j-1))},AGGREGATE:null,ARABIC:function(j){if(!/^M*(?:D?C{0,3}|C[MD])(?:L?X{0,3}|X[CL])(?:V?I{0,3}|I[XV])$/.test(j))return k.value;var M=0;return j.replace(/[MDLV]|C[MD]?|X[CL]?|I[XV]?/g,function(L){M+={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1}[L]}),M},ASIN:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.asin(j)},ASINH:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.log(j+Math.sqrt(j*j+1))},ATAN:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.atan(j)},ATAN2:function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:Math.atan2(j,M)},ATANH:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.log((1+j)/(1-j))/2},BASE:function(j,M,L){return L=L||0,j=e.parseNumber(j),M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(j,M,L)?k.value:(L=void 0===L?0:L,j=j.toString(M),Array(Math.max(L+1-j.length,0)).join("0")+j)},CEILING:function(j,M,L){return M=void 0===M?1:M,L=void 0===L?0:L,j=e.parseNumber(j),M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(j,M,L)?k.value:0===M?0:(M=Math.abs(M),0<=j?Math.ceil(j/M)*M:0===L?-1*Math.floor(Math.abs(j)/M)*M:-1*Math.ceil(Math.abs(j)/M)*M)}};g.CEILING.MATH=g.CEILING,g.CEILING.PRECISE=g.CEILING,g.COMBIN=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:g.FACT(j)/(g.FACT(M)*g.FACT(j-M))},g.COMBINA=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:0===j&&0===M?1:g.COMBIN(j+M-1,j-1)},g.COS=function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.cos(j)},g.COSH=function(j){return(j=e.parseNumber(j))instanceof Error?j:(Math.exp(j)+Math.exp(-j))/2},g.COT=function(j){return(j=e.parseNumber(j))instanceof Error?j:1/Math.tan(j)},g.COTH=function(j){return(j=e.parseNumber(j))instanceof Error?j:((j=Math.exp(2*j))+1)/(j-1)},g.CSC=function(j){return(j=e.parseNumber(j))instanceof Error?j:1/Math.sin(j)},g.CSCH=function(j){return(j=e.parseNumber(j))instanceof Error?j:2/(Math.exp(j)-Math.exp(-j))},g.DECIMAL=function(j,M){return 1>arguments.length?k.value:parseInt(j,M)},g.DEGREES=function(j){return(j=e.parseNumber(j))instanceof Error?j:180*j/Math.PI},g.EVEN=function(j){return(j=e.parseNumber(j))instanceof Error?j:g.CEILING(j,-2,-1)},g.EXP=Math.exp;var c=[];return g.FACT=function(j){return(j=e.parseNumber(j))instanceof Error?j:0===(j=Math.floor(j))||1===j?1:(0<c[j]||(c[j]=g.FACT(j-1)*j),c[j])},g.FACTDOUBLE=function(j){return(j=e.parseNumber(j))instanceof Error?j:0>=(j=Math.floor(j))?1:j*g.FACTDOUBLE(j-2)},g.FLOOR=function(j,M,L){return M=void 0===M?1:M,L=void 0===L?0:L,j=e.parseNumber(j),M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(j,M,L)?k.value:0===M?0:(M=Math.abs(M),0<=j?Math.floor(j/M)*M:0===L?-1*Math.ceil(Math.abs(j)/M)*M:-1*Math.floor(Math.abs(j)/M)*M)},g.FLOOR.MATH=g.FLOOR,g.GCD=null,g.INT=function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.floor(j)},g.LCM=function(){var j=e.parseNumberArray(e.flatten(arguments));if(j instanceof Error)return j;for(var M,L,T,O=1;void 0!==(T=j.pop());)for(;1<T;){if(T%2){for(M=3,L=Math.floor(Math.sqrt(T));M<=L&&T%M;M+=2);L=M<=L?M:T}else L=2;for(T/=L,O*=L,M=j.length;M;j[--M]%L==0&&1==(j[M]/=L)&&j.splice(M,1));}return O},g.LN=function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.log(j)},g.LOG=function(j,M){return j=e.parseNumber(j),M=void 0===M?10:e.parseNumber(M),e.anyIsError(j,M)?k.value:Math.log(j)/Math.log(M)},g.LOG10=function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.log(j)/Math.log(10)},g.MDETERM=null,g.MINVERSE=null,g.MMULT=null,g.MOD=function(j,M){if(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M))return k.value;if(0===M)return k.div0;var L=Math.abs(j%M);return 0<M?L:-L},g.MROUND=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:0>j*M?k.num:Math.round(j/M)*M},g.MULTINOMIAL=function(){var j=e.parseNumberArray(e.flatten(arguments));if(j instanceof Error)return j;for(var M=0,L=1,T=0;T<j.length;T++)M+=j[T],L*=g.FACT(j[T]);return g.FACT(M)/L},g.MUNIT=null,g.ODD=function(j){if((j=e.parseNumber(j))instanceof Error)return j;var M=Math.ceil(Math.abs(j));return M=1&M?M:M+1,0<j?M:-M},g.PI=function(){return Math.PI},g.POWER=function(j,M){if(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M))return k.value;var L=Math.pow(j,M);return isNaN(L)?k.num:L},g.PRODUCT=function(){var j=e.parseNumberArray(e.flatten(arguments));if(j instanceof Error)return j;for(var M=1,L=0;L<j.length;L++)M*=j[L];return M},g.QUOTIENT=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:parseInt(j/M,10)},g.RADIANS=function(j){return(j=e.parseNumber(j))instanceof Error?j:j*Math.PI/180},g.RAND=function(){return Math.random()},g.RANDBETWEEN=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:j+Math.ceil((M-j+1)*Math.random())-1},g.ROMAN=null,g.ROUND=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:Math.round(j*Math.pow(10,M))/Math.pow(10,M)},g.ROUNDDOWN=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:(0<j?1:-1)*Math.floor(Math.abs(j)*Math.pow(10,M))/Math.pow(10,M)},g.ROUNDUP=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:(0<j?1:-1)*Math.ceil(Math.abs(j)*Math.pow(10,M))/Math.pow(10,M)},g.SEC=function(j){return(j=e.parseNumber(j))instanceof Error?j:1/Math.cos(j)},g.SECH=function(j){return(j=e.parseNumber(j))instanceof Error?j:2/(Math.exp(j)+Math.exp(-j))},g.SERIESSUM=function(j,M,L,T){if(j=e.parseNumber(j),M=e.parseNumber(M),L=e.parseNumber(L),T=e.parseNumberArray(T),e.anyIsError(j,M,L,T))return k.value;for(var O=T[0]*Math.pow(j,M),S=1;S<T.length;S++)O+=T[S]*Math.pow(j,M+S*L);return O},g.SIGN=function(j){return(j=e.parseNumber(j))instanceof Error?j:0>j?-1:0===j?0:1},g.SIN=function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.sin(j)},g.SINH=function(j){return(j=e.parseNumber(j))instanceof Error?j:(Math.exp(j)-Math.exp(-j))/2},g.SQRT=function(j){return(j=e.parseNumber(j))instanceof Error?j:0>j?k.num:Math.sqrt(j)},g.SQRTPI=function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.sqrt(j*Math.PI)},g.SUBTOTAL=null,g.ADD=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:j+M)},g.MINUS=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:j-M)},g.DIVIDE=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:0===M?k.div0:j/M)},g.MULTIPLY=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:j*M)},g.GTE=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.error:j>=M)},g.LT=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.error:j<M)},g.LTE=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.error:j<=M)},g.EQ=function(j,M){return 2!==arguments.length?k.na:j===M},g.NE=function(j,M){return 2!==arguments.length?k.na:j!==M},g.POW=function(j,M){return 2!==arguments.length?k.na:(j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.error:g.POWER(j,M))},g.SUM=function(){for(var j=0,M=Object.keys(arguments),L=0;L<M.length;++L){var T=arguments[M[L]];"number"==typeof T?j+=T:"string"==typeof T?(T=parseFloat(T),!isNaN(T)&&(j+=T)):Array.isArray(T)&&(j+=g.SUM.apply(null,T))}return j},g.SUMIF=function(){var a=e.argsToArray(arguments),b=a.pop();if(a=e.parseNumberArray(e.flatten(a)),a instanceof Error)return a;for(var d=0,f=0;f<a.length;f++)d+=eval(a[f]+b)?a[f]:0;return d},g.SUMIFS=function(){var a=e.argsToArray(arguments),b=e.parseNumberArray(e.flatten(a.shift()));if(b instanceof Error)return b;for(var d=b.length,f=a.length,h=0,l=0;l<d;l++){for(var m=b[l],n="",p=0;p<f;p+=2)n=isNaN(a[p][l])?n+'"'+a[p][l]+'"'+a[p+1]:n+(a[p][l]+a[p+1]),p!==f-1&&(n+=" && ");n=n.slice(0,-4),eval(n)&&(h+=m)}return h},g.SUMPRODUCT=null,g.SUMSQ=function(){var j=e.parseNumberArray(e.flatten(arguments));if(j instanceof Error)return j;for(var M=0,L=j.length,T=0;T<L;T++)M+=ISNUMBER(j[T])?j[T]*j[T]:0;return M},g.SUMX2MY2=function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumberArray(e.flatten(M)),e.anyIsError(j,M))return k.value;for(var L=0,T=0;T<j.length;T++)L+=j[T]*j[T]-M[T]*M[T];return L},g.SUMX2PY2=function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumberArray(e.flatten(M)),e.anyIsError(j,M))return k.value;var L=0;j=e.parseNumberArray(e.flatten(j)),M=e.parseNumberArray(e.flatten(M));for(var T=0;T<j.length;T++)L+=j[T]*j[T]+M[T]*M[T];return L},g.SUMXMY2=function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumberArray(e.flatten(M)),e.anyIsError(j,M))return k.value;var L=0;j=e.flatten(j),M=e.flatten(M);for(var T=0;T<j.length;T++)L+=Math.pow(j[T]-M[T],2);return L},g.TAN=function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.tan(j)},g.TANH=function(j){return(j=e.parseNumber(j))instanceof Error?j:((j=Math.exp(2*j))-1)/(j+1)},g.TRUNC=function(j,M){return M=void 0===M?0:M,j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:(0<j?1:-1)*Math.floor(Math.abs(j)*Math.pow(10,M))/Math.pow(10,M)},g}(),x.misc=function(){var j={UNIQUE:function(){for(var M=[],L=0;L<arguments.length;++L){for(var T=!1,O=arguments[L],S=0;S<M.length&&!(T=M[S]===O);++S);T||M.push(O)}return M}};return j.FLATTEN=e.flatten,j.ARGS2ARRAY=function(){return Array.prototype.slice.call(arguments,0)},j.REFERENCE=function(M,L){try{for(var T=L.split("."),O=M,S=0;S<T.length;++S){var V=T[S];if("]"===V[V.length-1]){var _=V.indexOf("["),z=V.substring(_+1,V.length-1);O=O[V.substring(0,_)][z]}else O=O[V]}return O}catch(W){}},j.JOIN=function(M,L){return M.join(L)},j.NUMBERS=function(){return e.flatten(arguments).filter(function(M){return"number"==typeof M})},j.NUMERAL=null,j}(),x.text=function(){var j={ASC:null,BAHTTEXT:null,CHAR:function(M){return(M=e.parseNumber(M))instanceof Error?M:String.fromCharCode(M)},CLEAN:function(M){return(M||"").replace(/[\0-\x1F]/g,"")},CODE:function(M){return(M||"").charCodeAt(0)},CONCATENATE:function(){for(var L,M=e.flatten(arguments);-1<(L=M.indexOf(!0));)M[L]="TRUE";for(;-1<(L=M.indexOf(!1));)M[L]="FALSE";return M.join("")},DBCS:null,DOLLAR:null,EXACT:function(M,L){return M===L},FIND:function(M,L,T){return L?L.indexOf(M,(void 0===T?0:T)-1)+1:null},FIXED:null,HTML2TEXT:function(M){var L="";return M&&(M instanceof Array?M.forEach(function(T){""!==L&&(L+="\n"),L+=T.replace(/<(?:.|\n)*?>/gm,"")}):L=M.replace(/<(?:.|\n)*?>/gm,"")),L},LEFT:function(M,L){return(L=e.parseNumber(void 0===L?1:L))instanceof Error||"string"!=typeof M?k.value:M?M.substring(0,L):null},LEN:function(M){return 0===arguments.length?k.error:"string"==typeof M?M?M.length:0:M.length?M.length:k.value},LOWER:function(M){return"string"!=typeof M?k.value:M&&M.toLowerCase()},MID:function(M,L,T){return L=e.parseNumber(L),T=e.parseNumber(T),e.anyIsError(L,T)||"string"!=typeof M?T:(--L,M.substring(L,L+T))},NUMBERVALUE:null,PRONETIC:null,PROPER:function(M){return void 0===M||0===M.length||(!0===M&&(M="TRUE"),!1===M&&(M="FALSE"),isNaN(M)&&"number"==typeof M)?k.value:("number"==typeof M&&(M=""+M),M.replace(/\w\S*/g,function(L){return L.charAt(0).toUpperCase()+L.substr(1).toLowerCase()}))},REGEXEXTRACT:function(M,L){var T=M.match(new RegExp(L));return T?T[1<T.length?T.length-1:0]:null},REGEXMATCH:function(M,L,T){return M=M.match(new RegExp(L)),T?M:!!M},REGEXREPLACE:function(M,L,T){return M.replace(new RegExp(L),T)},REPLACE:function(M,L,T,O){return L=e.parseNumber(L),T=e.parseNumber(T),e.anyIsError(L,T)||"string"!=typeof M||"string"!=typeof O?k.value:M.substr(0,L-1)+O+M.substr(L-1+T)},REPT:function(M,L){return(L=e.parseNumber(L))instanceof Error?L:Array(L+1).join(M)},RIGHT:function(M,L){return(L=e.parseNumber(void 0===L?1:L))instanceof Error?L:M?M.substring(M.length-L):null},SEARCH:function(M,L,T){return"string"!=typeof M||"string"!=typeof L?k.value:(T=void 0===T?0:T,0===(M=L.toLowerCase().indexOf(M.toLowerCase(),T-1)+1)?k.value:M)},SPLIT:function(M,L){return M.split(L)},SUBSTITUTE:function(M,L,T,O){if(!(M&&L&&T))return M;if(void 0===O)return M.replace(new RegExp(L,"g"),T);for(var S=0,V=0;0<M.indexOf(L,S);)if(S=M.indexOf(L,S+1),++V===O)return M.substring(0,S)+T+M.substring(S+L.length)},T:function(M){return"string"==typeof M?M:""},TEXT:null,TRIM:function(M){return"string"!=typeof M?k.value:M.replace(/ +/g," ").trim()}};return j.UNICHAR=j.CHAR,j.UNICODE=j.CODE,j.UPPER=function(M){return"string"!=typeof M?k.value:M.toUpperCase()},j.VALUE=null,j}(),x.stats=function(){var g={AVEDEV:null,AVERAGE:function(){for(var j=e.numbers(e.flatten(arguments)),M=j.length,L=0,T=0,O=0;O<M;O++)L+=j[O],T+=1;return L/T},AVERAGEA:function(){for(var j=e.flatten(arguments),M=j.length,L=0,T=0,O=0;O<M;O++){var S=j[O];"number"==typeof S&&(L+=S),!0===S&&L++,null!==S&&T++}return L/T},AVERAGEIF:function(c,a,b){if(b=b||c,c=e.flatten(c),b=e.parseNumberArray(e.flatten(b)),b instanceof Error)return b;for(var d=0,f=0,h=0;h<c.length;h++)eval(c[h]+a)&&(f+=b[h],d++);return f/d},AVERAGEIFS:null,COUNT:function(){return e.numbers(e.flatten(arguments)).length},COUNTA:function(){var j=e.flatten(arguments);return j.length-g.COUNTBLANK(j)},COUNTIN:function(j,M){for(var L=0,T=0;T<j.length;T++)j[T]===M&&L++;return L},COUNTBLANK:function(){for(var L,j=e.flatten(arguments),M=0,T=0;T<j.length;T++)null!==(L=j[T])&&""!==L||M++;return M},COUNTIF:function(){var c=e.argsToArray(arguments),a=c.pop();c=e.flatten(c),/[<>=!]/.test(a)||(a='=="'+a+'"');for(var b=0,d=0;d<c.length;d++)"string"!=typeof c[d]?eval(c[d]+a)&&b++:eval('"'+c[d]+'"'+a)&&b++;return b},COUNTIFS:function(){for(var c=e.argsToArray(arguments),a=Array(e.flatten(c[0]).length),b=0;b<a.length;b++)a[b]=!0;for(b=0;b<c.length;b+=2){var d=e.flatten(c[b]),f=c[b+1];/[<>=!]/.test(f)||(f='=="'+f+'"');for(var h=0;h<d.length;h++)a[h]="string"!=typeof d[h]?a[h]&&eval(d[h]+f):a[h]&&eval('"'+d[h]+'"'+f)}for(b=c=0;b<a.length;b++)a[b]&&c++;return c},COUNTUNIQUE:function(){return UNIQUE.apply(null,e.flatten(arguments)).length},FISHER:function(j){return(j=e.parseNumber(j))instanceof Error?j:Math.log((1+j)/(1-j))/2},FISHERINV:function(j){return(j=e.parseNumber(j))instanceof Error?j:((j=Math.exp(2*j))-1)/(j+1)},FREQUENCY:function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumberArray(e.flatten(M)),e.anyIsError(j,M))return k.value;for(var L=j.length,T=M.length,O=[],S=0;S<=T;S++)for(var V=O[S]=0;V<L;V++)0===S?j[V]<=M[0]&&(O[0]+=1):S<T?j[V]>M[S-1]&&j[V]<=M[S]&&(O[S]+=1):S===T&&j[V]>M[T-1]&&(O[T]+=1);return O},LARGE:function(j,M){return j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),e.anyIsError(j,M)?j:j.sort(function(L,T){return T-L})[M-1]},MAX:function(){var j=e.numbers(e.flatten(arguments));return 0===j.length?0:Math.max.apply(Math,j)},MAXA:function(){var j=e.arrayValuesToNumbers(e.flatten(arguments));return 0===j.length?0:Math.max.apply(Math,j)},MIN:function(){var j=e.numbers(e.flatten(arguments));return 0===j.length?0:Math.min.apply(Math,j)},MINA:function(){var j=e.arrayValuesToNumbers(e.flatten(arguments));return 0===j.length?0:Math.min.apply(Math,j)},MODE:{}};return g.MODE.MULT=function(){var j=e.parseNumberArray(e.flatten(arguments));if(j instanceof Error)return j;for(var S,M=j.length,L={},T=[],O=0,V=0;V<M;V++)L[S=j[V]]=L[S]?L[S]+1:1,L[S]>O&&(O=L[S],T=[]),L[S]===O&&(T[T.length]=S);return T},g.MODE.SNGL=function(){var j=e.parseNumberArray(e.flatten(arguments));return j instanceof Error?j:g.MODE.MULT(j).sort(function(M,L){return M-L})[0]},g.PERCENTILE={},g.PERCENTILE.EXC=function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),e.anyIsError(j,M))return k.value;var L=(j=j.sort(function(O,S){return O-S})).length;if(M<1/(L+1)||M>1-1/(L+1))return k.num;L=M*(L+1)-1;var T=Math.floor(L);return e.cleanFloat(L===T?j[L]:j[T]+(L-T)*(j[T+1]-j[T]))},g.PERCENTILE.INC=function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),e.anyIsError(j,M))return k.value;var L=M*((j=j.sort(function(O,S){return O-S})).length-1),T=Math.floor(L);return e.cleanFloat(L===T?j[L]:j[T]+(L-T)*(j[T+1]-j[T]))},g.PERCENTRANK={},g.PERCENTRANK.EXC=function(j,M,L){if(L=void 0===L?3:L,j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(j,M,L))return k.value;j=j.sort(function(W,te){return W-te});var T=UNIQUE.apply(null,j),O=j.length,S=T.length;L=Math.pow(10,L);for(var V=0,_=!1,z=0;!_&&z<S;)M===T[z]?(V=(j.indexOf(T[z])+1)/(O+1),_=!0):M>=T[z]&&(M<T[z+1]||z===S-1)&&(V=(j.indexOf(T[z])+1+(M-T[z])/(T[z+1]-T[z]))/(O+1),_=!0),z++;return Math.floor(V*L)/L},g.PERCENTRANK.INC=function(j,M,L){if(L=void 0===L?3:L,j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(j,M,L))return k.value;j=j.sort(function(W,te){return W-te});var T=UNIQUE.apply(null,j),O=j.length,S=T.length;L=Math.pow(10,L);for(var V=0,_=!1,z=0;!_&&z<S;)M===T[z]?(V=j.indexOf(T[z])/(O-1),_=!0):M>=T[z]&&(M<T[z+1]||z===S-1)&&(V=(j.indexOf(T[z])+(M-T[z])/(T[z+1]-T[z]))/(O-1),_=!0),z++;return Math.floor(V*L)/L},g.PERMUT=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:FACT(j)/FACT(j-M)},g.PERMUTATIONA=function(j,M){return j=e.parseNumber(j),M=e.parseNumber(M),e.anyIsError(j,M)?k.value:Math.pow(j,M)},g.PHI=function(j){return(j=e.parseNumber(j))instanceof Error?k.value:Math.exp(-.5*j*j)/2.5066282746310002},g.PROB=function(j,M,L,T){if(void 0===L)return 0;if(T=void 0===T?L:T,j=e.parseNumberArray(e.flatten(j)),M=e.parseNumberArray(e.flatten(M)),L=e.parseNumber(L),T=e.parseNumber(T),e.anyIsError(j,M,L,T))return k.value;if(L===T)return 0<=j.indexOf(L)?M[j.indexOf(L)]:0;for(var O=j.sort(function(z,W){return z-W}),S=O.length,V=0,_=0;_<S;_++)O[_]>=L&&O[_]<=T&&(V+=M[j.indexOf(O[_])]);return V},g.QUARTILE={},g.QUARTILE.EXC=function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),e.anyIsError(j,M))return k.value;switch(M){case 1:return g.PERCENTILE.EXC(j,.25);case 2:return g.PERCENTILE.EXC(j,.5);case 3:return g.PERCENTILE.EXC(j,.75);default:return k.num}},g.QUARTILE.INC=function(j,M){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),e.anyIsError(j,M))return k.value;switch(M){case 1:return g.PERCENTILE.INC(j,.25);case 2:return g.PERCENTILE.INC(j,.5);case 3:return g.PERCENTILE.INC(j,.75);default:return k.num}},g.RANK={},g.RANK.AVG=function(j,M,L){if(j=e.parseNumber(j),M=e.parseNumberArray(e.flatten(M)),e.anyIsError(j,M))return k.value;L=(M=(M=e.flatten(M)).sort(L?function(S,V){return S-V}:function(S,V){return V-S})).length;for(var T=0,O=0;O<L;O++)M[O]===j&&T++;return 1<T?(2*M.indexOf(j)+T+1)/2:M.indexOf(j)+1},g.RANK.EQ=function(j,M,L){return j=e.parseNumber(j),M=e.parseNumberArray(e.flatten(M)),e.anyIsError(j,M)?k.value:(M=M.sort(L?function(T,O){return T-O}:function(T,O){return O-T})).indexOf(j)+1},g.RSQ=function(j,M){return j=e.parseNumberArray(e.flatten(j)),M=e.parseNumberArray(e.flatten(M)),e.anyIsError(j,M)?k.value:Math.pow(g.PEARSON(j,M),2)},g.SMALL=function(j,M){return j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),e.anyIsError(j,M)?j:j.sort(function(L,T){return L-T})[M-1]},g.STANDARDIZE=function(j,M,L){return j=e.parseNumber(j),M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(j,M,L)?k.value:(j-M)/L},g.STDEV={},g.STDEV.P=function(){var j=g.VAR.P.apply(this,arguments);return Math.sqrt(j)},g.STDEV.S=function(){var j=g.VAR.S.apply(this,arguments);return Math.sqrt(j)},g.STDEVA=function(){var j=g.VARA.apply(this,arguments);return Math.sqrt(j)},g.STDEVPA=function(){var j=g.VARPA.apply(this,arguments);return Math.sqrt(j)},g.VAR={},g.VAR.P=function(){for(var j=e.numbers(e.flatten(arguments)),M=j.length,L=0,T=g.AVERAGE(j),O=0;O<M;O++)L+=Math.pow(j[O]-T,2);return L/M},g.VAR.S=function(){for(var j=e.numbers(e.flatten(arguments)),M=j.length,L=0,T=g.AVERAGE(j),O=0;O<M;O++)L+=Math.pow(j[O]-T,2);return L/(M-1)},g.VARA=function(){for(var j=e.flatten(arguments),M=j.length,L=0,T=0,O=g.AVERAGEA(j),S=0;S<M;S++){var V=j[S];L="number"==typeof V?L+Math.pow(V-O,2):!0===V?L+Math.pow(1-O,2):L+Math.pow(0-O,2),null!==V&&T++}return L/(T-1)},g.VARPA=function(){for(var j=e.flatten(arguments),M=j.length,L=0,T=0,O=g.AVERAGEA(j),S=0;S<M;S++){var V=j[S];L="number"==typeof V?L+Math.pow(V-O,2):!0===V?L+Math.pow(1-O,2):L+Math.pow(0-O,2),null!==V&&T++}return L/T},g.WEIBULL={},g.WEIBULL.DIST=function(j,M,L,T){return j=e.parseNumber(j),M=e.parseNumber(M),L=e.parseNumber(L),e.anyIsError(j,M,L)?k.value:T?1-Math.exp(-Math.pow(j/L,M)):Math.pow(j,M-1)*Math.exp(-Math.pow(j/L,M))*M/Math.pow(L,M)},g.Z={},g.Z.TEST=function(j,M,L){if(j=e.parseNumberArray(e.flatten(j)),M=e.parseNumber(M),e.anyIsError(j,M))return k.value;L=L||g.STDEV.S(j);var T=j.length;return 1-g.NORM.S.DIST((g.AVERAGE(j)-M)/(L/Math.sqrt(T)),!0)},g}(),x.utils={PROGRESS:function(j,M){return'<div style="width:'+(j||"0")+"%;height:4px;background-color:"+(M||"red")+';margin-top:1px;"></div>'},RATING:function(j){for(var M='<div class="jrating">',L=0;5>L;L++)M=L<j?M+'<div class="jrating-selected"></div>':M+"<div></div>";return M+"</div>"}};for(var E=0;E<Object.keys(x).length;E++)for(var B=x[Object.keys(x)[E]],y=Object.keys(B),w=0;w<y.length;w++)if(B[y[w]])if("function"==typeof B[y[w]]||"object"==typeof B[y[w]]){if(window[y[w]]=B[y[w]],window[y[w]].toString=function(){return"#ERROR"},"object"==typeof B[y[w]])for(var I=Object.keys(B[y[w]]),F=0;F<I.length;F++)window[y[w]][I[F]].toString=function(){return"#ERROR"}}else window[y[w]]=function(){return y[w]+"Not implemented"};else window[y[w]]=function(){return y[w]+"Not implemented"};var G=null,C=null,D=null;window.TABLE=function(){return D},window.COLUMN=window.COL=function(){return parseInt(G)+1},window.ROW=function(){return parseInt(C)+1},window.CELL=function(){return A.getColumnNameFromCoords(G,C)},window.VALUE=function(j,M,L){return D.getValueFromCoords(parseInt(j)-1,parseInt(M)-1,L)},window.THISROWCELL=function(j){return D.getValueFromCoords(parseInt(j)-1,parseInt(C))};var A=function(j,M,L,T,O){if(D=O,G=L,C=T,T="",(O=Object.keys(M)).length)for(L=0;L<O.length;L++)T=-1==O[L].indexOf(".")&&-1==O[L].indexOf("!")?T+"var "+O[L]+" = "+M[O[L]]+";\n":T+(O[L]+" = ")+M[O[L]]+";\n";j=(j=j.replace(/\$/g,"")).replace(/!/g,"."),M="",L=0,O=["=","!",">","<"];for(var S=0;S<j.length;S++)'"'==j[S]&&(L=0==L?1:0),1==L?M+=j[S]:(M+=j[S].toUpperCase(),0<S&&"="==j[S]&&-1==O.indexOf(j[S-1])&&-1==O.indexOf(j[S+1])&&(M+="="));if(j=M=(M=(M=(M=M.replace(/\^/g,"**")).replace(/<>/g,"!=")).replace(/&/g,"+")).replace(/\$/g,""),(M=j.match(/([A-Z]+[0-9]*\.)?(\$?[A-Z]+\$?[0-9]+):(\$?[A-Z]+\$?[0-9]+)?/g))&&M.length)for(L=0;L<M.length;L++)O=A.getTokensFromRange(M[L]),j=j.replace(M[L],"["+O.join(",")+"]");return new Function(T+"; return "+j)()};return A.getColumnNameFromCoords=function(j,M){var L=parseInt(j),T="";return 701<L?(T+=String.fromCharCode(64+parseInt(L/676)),T+=String.fromCharCode(64+parseInt(L%676/26))):25<L&&(T+=String.fromCharCode(64+parseInt(L/26))),(T+=String.fromCharCode(65+L%26))+(parseInt(M)+1)},A.getCoordsFromColumnName=function(j){var M=/^[a-zA-Z]+/.exec(j);if(M){for(var L=0,T=0;T<M[0].length;T++)L+=parseInt(M[0].charCodeAt(T)-64)*Math.pow(26,M[0].length-1-T);return 0>--L&&(L=0),0<(j=parseInt(/[0-9]+$/.exec(j))||null)&&j--,[L,j]}},A.getRangeFromTokens=function(j){j=j.filter(function(O){return"#REF!"!=O});for(var M="",L="",T=0;T<j.length;T++)0<=j[T].indexOf(".")?M=".":0<=j[T].indexOf("!")&&(M="!"),M&&(L=j[T].split(M),j[T]=L[1],L=L[0]+M);return j.sort(function(O,S){var V=Helpers.getCoordsFromColumnName(O),_=Helpers.getCoordsFromColumnName(S);return V[1]>_[1]?1:V[1]<_[1]?-1:V[0]>_[0]?1:V[0]<_[0]?-1:0}),j.length?L+(j[0]+":")+j[j.length-1]:"#REF!"},A.getTokensFromRange=function(j){if(0<j.indexOf(".")){var M=j.split(".");j=M[1],M=M[0]+"."}else 0<j.indexOf("!")?(M=j.split("!"),j=M[1],M=M[0]+"!"):M="";j=j.split(":");var L=A.getCoordsFromColumnName(j[0]),T=A.getCoordsFromColumnName(j[1]);if(L[0]<=T[0]){j=L[0];var O=T[0]}else j=T[0],O=L[0];if(null===L[1]&&null==T[1])for(var S=null,V=null,_=Object.keys(vars),z=0;z<_.length;z++){var W=A.getCoordsFromColumnName(_[z]);W[0]===L[0]&&(null===S||W[1]<S)&&(S=W[1]),W[0]===T[0]&&(null===V||W[1]>V)&&(V=W[1])}else L[1]<=T[1]?(S=L[1],V=T[1]):(S=T[1],V=L[1]);for(L=[];S<=V;S++){for(T=[],z=j;z<=O;z++)T.push(M+A.getColumnNameFromCoords(z,S));L.push(T)}return L},A.setFormula=function(j){for(var M=Object.keys(j),L=0;L<M.length;L++)"function"==typeof j[M[L]]&&(window[M[L]]=j[M[L]])},A}()},"object"==typeof exports&&void 0!==module?module.exports=M():"function"==typeof define&&define.amd?define(M):j.formula=M()},{}],2:[function(j,M,L){var O;O=function(){"use strict";var V,z,W,T=(z=function(te,ee){return!(!te[ee.type]||te[ee.type]!=ee)||!!te.parentNode&&z(te.parentNode,ee)},W=function(te){if(T.current.length>0)for(var ee=0;ee<T.current.length;ee++)T.current[ee]&&!z(te.target,T.current[ee])&&T.current[ee].close()},(V={}).init=function(){document.addEventListener("click",W),V.version="4.9.4"},V.tracking=function(te,ee){if(1==ee)T.current=T.current.filter(function(Z){return null!==Z}),setTimeout(function(){T.current.push(te)},0);else{var Q=T.current.indexOf(te);Q>=0&&(T.current[Q]=null)}},V.path=function(te,ee){if((te=te.split(".")).length){for(var Q=this,Z=null;te.length>1;)if(Z=te.shift(),Q.hasOwnProperty(Z))Q=Q[Z];else{if(void 0===ee)return;Q[Z]={},Q=Q[Z]}return Z=te.shift(),void 0!==ee?(Q[Z]=ee,!0):Q[Z]}return!1},V.setDictionary=function(te){V.dictionary=te;for(var ee=null,Q=0;Q<T.calendar.weekdays.length;Q++)ee=T.translate(T.calendar.weekdays[Q]),T.calendar.weekdays[Q]&&(T.calendar.weekdays[Q]=ee,T.calendar.weekdaysShort[Q]=ee.substr(0,3));for(Q=0;Q<T.calendar.months.length;Q++)(ee=T.translate(T.calendar.months[Q]))&&(T.calendar.months[Q]=ee,T.calendar.monthsShort[Q]=ee.substr(0,3))},V.dictionary={},V.translate=function(te){return V.dictionary[te]||te},V.current=[],V);"undefined"!=typeof document&&T.init(),T.ajax=function(S,V){if(Array.isArray(S)){var _={instance:[],complete:V};if(S.length>0)for(var z=0;z<S.length;z++)S[z].multiple=_,_.instance.push(T.ajax(S[z]));return _}if(S.data||(S.data={}),S.type&&(S.method=S.type),S.method||(S.method="GET"),S.dataType||(S.dataType="json"),S.data){var W=function(X,se){var oe=[],me=Object.keys(X);if(me.length)for(var ce=0;ce<me.length;ce++){if(se)var ge=se+"["+me[ce]+"]";else ge=me[ce];if("object"==typeof X[me[ce]])for(var xe=W(X[me[ce]],ge),Ee=Object.keys(xe),Ve=0;Ve<Ee.length;Ve++)oe[Ee[Ve]]=xe[Ee[Ve]];else oe[ge]=X[me[ce]]}return oe},te=[],ee=W(S.data),Q=Object.keys(ee);for(z=0;z<Q.length;z++)te.push(Q[z]+"="+encodeURIComponent(ee[Q[z]]));"GET"==S.method&&te.length>0&&(S.url.indexOf("?")<0&&(S.url+="?"),S.url+=te.join("&"))}var Z=new XMLHttpRequest;return Z.open(S.method,S.url,!0),Z.setRequestHeader("X-Requested-With","XMLHttpRequest"),"POST"==S.method?(Z.setRequestHeader("Accept","application/json"),Z.setRequestHeader("Content-Type","application/x-www-form-urlencoded")):"json"==S.dataType?Z.setRequestHeader("Content-Type","text/json"):"blob"==S.dataType?Z.responseType="blob":"html"==S.dataType&&Z.setRequestHeader("Content-Type","text/html"),1!=S.cache&&(Z.setRequestHeader("pragma","no-cache"),Z.setRequestHeader("cache-control","no-cache")),1==S.withCredentials&&(Z.withCredentials=!0),"function"==typeof S.beforeSend&&S.beforeSend(Z),Z.onload=function(){if(200===Z.status)if("json"==S.dataType)try{var X=JSON.parse(Z.responseText);S.success&&"function"==typeof S.success&&S.success(X)}catch(oe){S.error&&"function"==typeof S.error&&S.error(oe,X)}else X="blob"==S.dataType?Z.response:Z.responseText,S.success&&"function"==typeof S.success&&S.success(X);else S.error&&"function"==typeof S.error&&S.error(Z.responseText,Z.status);if(T.ajax.queue&&T.ajax.queue.length>0&&T.ajax.send(T.ajax.queue.shift()),T.ajax.requests&&T.ajax.requests.length){var se=T.ajax.requests.indexOf(Z);T.ajax.requests.splice(se,1),T.ajax.requests.length||S.complete&&"function"==typeof S.complete&&S.complete(X),S.group&&T.ajax.oncomplete&&"function"==typeof T.ajax.oncomplete[S.group]&&(T.ajax.pending(S.group)||(T.ajax.oncomplete[S.group](),T.ajax.oncomplete[S.group]=null)),S.multiple&&S.multiple.instance&&(se=S.multiple.instance.indexOf(Z),S.multiple.instance.splice(se,1),S.multiple.instance.length||S.multiple.complete&&"function"==typeof S.multiple.complete&&S.multiple.complete(X))}},Z.options=S,Z.data=te,1==S.queue&&T.ajax.requests.length>0?T.ajax.queue.push(Z):T.ajax.send(Z),Z},T.ajax.send=function(S){S.data?S.send(S.data.join("&")):S.send(),T.ajax.requests.push(S)},T.ajax.exists=function(S,V){var _=new XMLHttpRequest;_.open("HEAD",S,!1),_.send(),_.status&&V(_.status)},T.ajax.pending=function(S){var V=0,_=T.ajax.requests;if(_&&_.length)for(var z=0;z<_.length;z++)(!S||S==_[z].options.group)&&V++;return V},T.ajax.oncomplete={},T.ajax.requests=[],T.ajax.queue=[],T.alert=function(S){T.getWindowWidth()<800&&T.dialog?T.dialog.open({title:"Alert",message:S}):alert(S)},T.animation={},T.animation.slideLeft=function(S,V,_){1==V?(S.classList.add("slide-left-in"),setTimeout(function(){S.classList.remove("slide-left-in"),"function"==typeof _&&_()},400)):(S.classList.add("slide-left-out"),setTimeout(function(){S.classList.remove("slide-left-out"),"function"==typeof _&&_()},400))},T.animation.slideRight=function(S,V,_){1==V?(S.classList.add("slide-right-in"),setTimeout(function(){S.classList.remove("slide-right-in"),"function"==typeof _&&_()},400)):(S.classList.add("slide-right-out"),setTimeout(function(){S.classList.remove("slide-right-out"),"function"==typeof _&&_()},400))},T.animation.slideTop=function(S,V,_){1==V?(S.classList.add("slide-top-in"),setTimeout(function(){S.classList.remove("slide-top-in"),"function"==typeof _&&_()},400)):(S.classList.add("slide-top-out"),setTimeout(function(){S.classList.remove("slide-top-out"),"function"==typeof _&&_()},400))},T.animation.slideBottom=function(S,V,_){1==V?(S.classList.add("slide-bottom-in"),setTimeout(function(){S.classList.remove("slide-bottom-in"),"function"==typeof _&&_()},400)):(S.classList.add("slide-bottom-out"),setTimeout(function(){S.classList.remove("slide-bottom-out"),"function"==typeof _&&_()},100))},T.animation.fadeIn=function(S,V){S.style.display="",S.classList.add("fade-in"),setTimeout(function(){S.classList.remove("fade-in"),"function"==typeof V&&V()},2e3)},T.animation.fadeOut=function(S,V){S.classList.add("fade-out"),setTimeout(function(){S.style.display="none",S.classList.remove("fade-out"),"function"==typeof V&&V()},1e3)},T.calendar=function(S,V){if(S.calendar)return S.calendar.setOptions(V,!0);var _={type:"calendar",options:{},date:null,setOptions:function(ie,he){for(var K={type:"default",validRange:null,startingDay:null,format:"DD/MM/YYYY",readonly:!0,today:!1,time:!1,resetButton:!0,placeholder:"",months:T.calendar.monthsShort,monthsFull:T.calendar.months,weekdays:T.calendar.weekdays,weekdays_short:T.calendar.weekdays,textDone:T.translate("Done"),textReset:T.translate("Reset"),textUpdate:T.translate("Update"),value:null,fullscreen:!1,opened:!1,onopen:null,onclose:null,onchange:null,onupdate:null,mode:null,position:null,dataType:null},ae=0;ae<K.weekdays_short.length;ae++)K.weekdays_short[ae]=K.weekdays_short[ae].substr(0,1);for(var ue in K)ie&&ie.hasOwnProperty(ue)?_.options[ue]=ie[ue]:(void 0===_.options[ue]||!0===he)&&(_.options[ue]=K[ue]);if(Q.style.display=0==_.options.resetButton?"none":"",_.options.readonly?S.setAttribute("readonly","readonly"):S.removeAttribute("readonly"),_.options.placeholder?S.setAttribute("placeholder",_.options.placeholder):S.removeAttribute("placeholder"),T.isNumeric(_.options.value)&&_.options.value>0&&(_.options.value=T.calendar.numToDate(_.options.value),_.options.dataType="numeric"),Q.innerHTML=_.options.textReset,Z.innerHTML=_.options.textDone,ze.innerHTML=_.options.textUpdate,S.setAttribute("data-mask",_.options.format.toLowerCase()),!_.options.value&&_.options.today)var Ce=T.calendar.now();else Ce=_.options.value;return Ce&&(_.options.value=null,_.setValue(Ce)),_},open:function(ie){if(!ee.classList.contains("jcalendar-focus")&&!ee.classList.contains("jcalendar-inline")){if(T.calendar.current=_,T.tracking(_,!0),_.getDays(),"year-month-picker"==_.options.type&&_.getMonths(),_.options.time&&(Re.value=_.date[3],be.value=_.date[4]),ee.classList.add("jcalendar-focus"),T.getWindowWidth()<800||_.options.fullscreen)ee.classList.add("jcalendar-fullsize"),T.animation.slideBottom(se,1);else{ee.classList.remove("jcalendar-fullsize");var he=S.getBoundingClientRect(),K=se.getBoundingClientRect();if(_.options.position)X.style.position="fixed",X.style.top=window.innerHeight<he.bottom+K.height?he.top-(K.height+2)+"px":he.top+he.height+2+"px",X.style.left=he.left+"px";else if(window.innerHeight<he.bottom+K.height?((ae=-1*(he.height+K.height+2))+he.top<0&&(ae=-1*(he.top+he.height)),X.style.top=ae+"px"):X.style.top="2px",window.innerWidth<he.left+K.width){var ae=window.innerWidth-(he.left+K.width+20);X.style.left=ae+"px"}else X.style.left="0px"}"function"==typeof _.options.onopen&&_.options.onopen(S)}},close:function(ie,he){if(ee.classList.contains("jcalendar-focus")){if(!1!==he){var K=ee.querySelector(".jcalendar-selected");if("string"==typeof he)var ae=he;else ae=!K||K.classList.contains("jcalendar-disabled")?_.options.value:_.getValue();_.setValue(ae)}!ie&&"function"==typeof _.options.onclose&&_.options.onclose(S),ee.classList.remove("jcalendar-focus"),T.tracking(_,!1),T.calendar.current=null}return _.options.value},prev:function(){"years"==_.options.mode?(_.date[0]=_.date[0]-12,_.getYears()):"months"==_.options.mode?(_.date[0]=parseInt(_.date[0])-1,_.getMonths()):(_.date[1]<2?(_.date[0]=_.date[0]-1,_.date[1]=12):_.date[1]=_.date[1]-1,_.getDays())},next:function(){"years"==_.options.mode?(_.date[0]=parseInt(_.date[0])+12,_.getYears()):"months"==_.options.mode?(_.date[0]=parseInt(_.date[0])+1,_.getMonths()):(_.date[1]>11?(_.date[0]=parseInt(_.date[0])+1,_.date[1]=1):_.date[1]=parseInt(_.date[1])+1,_.getDays())},setToday:function(){var ie=(new Date).toISOString().substr(0,10);return _.setValue(ie),ie},setValue:function(ie){ie||(ie=""+ie);var he=ie,K=_.options.value;if(K!=he){if(he){_.setLabel(he,_.options),(ue=he.split(" "))[1]||(ue[1]="00:00:00");var Ce=ue[1].split(":"),ue=ue[0].split("-"),je=parseInt(ue[0]),pe=parseInt(ue[1]),Me=parseInt(ue[2]),Se=parseInt(Ce[0]),Fe=parseInt(Ce[1]);_.date=[je,pe,Me,Se,Fe,0],ie=_.setLabel(he,_.options)}else _.date=null,ie="";_.options.value=he,"function"==typeof _.options.onchange&&_.options.onchange(S,he,K),S.value!=ie&&(S.value=ie,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value}))}_.getDays()},getValue:function(){return _.date?_.options.time?T.two(_.date[0])+"-"+T.two(_.date[1])+"-"+T.two(_.date[2])+" "+T.two(_.date[3])+":"+T.two(_.date[4])+":"+T.two(0):T.two(_.date[0])+"-"+T.two(_.date[1])+"-"+T.two(_.date[2])+" "+T.two(0)+":"+T.two(0)+":"+T.two(0):""},update:function(ie,he){if(!ie.classList.contains("jcalendar-disabled")){var K=ee.querySelector(".jcalendar-selected");K&&K.classList.remove("jcalendar-selected"),ie.classList.add("jcalendar-selected"),ie.classList.contains("jcalendar-set-month")?_.date[1]=he:_.date[2]=ie.innerText,_.options.time?(_.date[3]=Re.value,_.date[4]=be.value):_.close()}te()},reset:function(){_.setValue(""),_.date=null,_.close(!1,!1)},getDays:function(){_.options.mode="days";var ie=new Date,he=_.date&&T.isNumeric(_.date[0])?_.date[0]:parseInt(ie.getFullYear()),K=_.date&&T.isNumeric(_.date[1])?_.date[1]:parseInt(ie.getMonth())+1,ae=_.date&&T.isNumeric(_.date[2])?_.date[2]:parseInt(ie.getDate()),ue=_.date&&T.isNumeric(_.date[3])?_.date[3]:parseInt(ie.getHours()),Ce=_.date&&T.isNumeric(_.date[4])?_.date[4]:parseInt(ie.getMinutes());_.date=[he,K,ae,ue,Ce,0],oe.innerHTML=he,me.innerHTML=_.options.months[K-1];var je=ie.getMonth()==K-1&&ie.getFullYear()==he,pe=ie.getDate(),Me=(ie=new Date(he,K,0,0,0)).getDate(),Se=(ie=new Date(he,K-1,0,0,0)).getDay()+1;Se-=Fe=_.options.startingDay||0,ge.innerHTML="",($e=document.createElement("tr")).setAttribute("align","center"),ge.appendChild($e);for(var Te=0;Te<7;Te++)(Ne=document.createElement("td")).classList.add("jcalendar-weekday"),Ne.innerHTML=_.options.weekdays_short[Fe],$e.appendChild(Ne),++Fe>6&&(Fe=0);for(var Fe=0,Pe=0,de=0;de<6;de++){var $e;($e=document.createElement("tr")).setAttribute("align","center");var De=!0;for(Te=0;Te<7;Te++){var Ne;if((Ne=document.createElement("td")).classList.add("jcalendar-set-day"),Fe>=Se&&Fe<Se+Me){Pe++,Ne.innerHTML=Pe,Pe==ae&&Ne.classList.add("jcalendar-selected"),je&&pe==Pe&&(Ne.style.fontWeight="bold");var _e=T.calendar.now(new Date(he,K-1,Pe),!0);if(_.options.validRange){if(!_.options.validRange[0]||_e>=_.options.validRange[0])var Le=!0;else Le=!1;if(!_.options.validRange[1]||_e<=_.options.validRange[1])var Ze=!0;else Ze=!1;Le&&Ze||Ne.classList.add("jcalendar-disabled")}De=!1}$e.appendChild(Ne),Fe++}0==De&&ge.appendChild($e)}Ee.style.display=_.options.time?"":"none",te()},getMonths:function(){_.options.mode="months";var ie=_.options.months,K=new Date,ae=parseInt(K.getFullYear()),ue=parseInt(K.getMonth())+1,Ce=_.date&&T.isNumeric(_.date[0])?_.date[0]:ae,je=_.date&&T.isNumeric(_.date[1])?_.date[1]:ue;oe.innerHTML=_.date[0],me.innerHTML=ie[je-1];var pe=document.createElement("table");pe.setAttribute("width","100%");for(var Me=null,Se=0;Se<12;Se++){Se%4||((Me=document.createElement("tr")).setAttribute("align","center"),pe.appendChild(Me));var Fe=document.createElement("td");if(Fe.classList.add("jcalendar-set-month"),Fe.setAttribute("data-value",Se+1),Fe.innerText=ie[Se],_.options.validRange){var $e=Ce+"-"+T.two(Se+1);if(!_.options.validRange[0]||$e>=_.options.validRange[0].substr(0,7))var Te=!0;else Te=!1;if(!_.options.validRange[1]||$e<=_.options.validRange[1].substr(0,7))var Ne=!0;else Ne=!1;Te&&Ne||Fe.classList.add("jcalendar-disabled")}Se+1==je&&Fe.classList.add("jcalendar-selected"),ae==Ce&&Se+1==ue&&(Fe.style.fontWeight="bold"),Me.appendChild(Fe)}ge.innerHTML='<tr><td colspan="7"></td></tr>',ge.children[0].children[0].appendChild(pe),te()},getYears:function(){_.options.mode="years";for(var ie=new Date,he=ie.getFullYear(),K=_.date&&T.isNumeric(_.date[0])?_.date[0]:parseInt(ie.getFullYear()),ae=[],ue=0;ue<25;ue++)ae[ue]=parseInt(_.date[0])+(ue-12);var Ce=document.createElement("table");for(Ce.setAttribute("width","100%"),ue=0;ue<25;ue++){if(!(ue%5)){var je=document.createElement("tr");je.setAttribute("align","center"),Ce.appendChild(je)}var pe=document.createElement("td");pe.classList.add("jcalendar-set-year"),pe.innerText=ae[ue],K==ae[ue]&&pe.classList.add("jcalendar-selected"),he==ae[ue]&&(pe.style.fontWeight="bold"),je.appendChild(pe)}ge.innerHTML='<tr><td colspan="7"></td></tr>',ge.firstChild.firstChild.appendChild(Ce),te()},setLabel:function(ie,he){return T.calendar.getDateString(ie,he)},fromFormatted:function(ie,he){return T.calendar.extractDateFromString(ie,he)}},z=function(ie){if(T.findElement(ie.target,"jcalendar-container")){var K=ie.target.className;if("jcalendar-prev"==K)_.prev();else if("jcalendar-next"==K)_.next();else if("jcalendar-month"==K)_.getMonths();else if("jcalendar-year"==K)_.getYears();else if("jcalendar-set-year"==K)_.date[0]=ie.target.innerText,"year-month-picker"==_.options.type?_.getMonths():_.getDays();else if(ie.target.classList.contains("jcalendar-set-month")){var ae=parseInt(ie.target.getAttribute("data-value"));"year-month-picker"==_.options.type?_.update(ie.target,ae):(_.date[1]=ae,_.getDays())}else"jcalendar-confirm"==K||"jcalendar-update"==K||"jcalendar-close"==K?_.close():"jcalendar-backdrop"==K?_.close(!1,!1):"jcalendar-reset"==K?_.reset():ie.target.classList.contains("jcalendar-set-day")&&ie.target.innerText&&_.update(ie.target)}else _.close()},W=function(ie){if(ie.target.value&&ie.target.value.length>3){var he=T.calendar.extractDateFromString(ie.target.value,_.options.format);he&&_.setValue(he)}},te=function(){var ie=ee.querySelector(".jcalendar-selected");ie&&ie.classList.contains("jcalendar-disabled")?(ze.setAttribute("disabled","disabled"),Re.setAttribute("disabled","disabled"),be.setAttribute("disabled","disabled")):(ze.removeAttribute("disabled"),Re.removeAttribute("disabled"),be.removeAttribute("disabled")),"function"==typeof _.options.onupdate&&_.options.onupdate(S,_.getValue())},ee=null,Q=null,Z=null,X=null,se=null,oe=null,me=null,ce=null,ge=null,xe=null,Ee=null,Ve=null,ze=null,Re=null,be=null;return function(){"INPUT"==S.tagName&&S.value&&(V.value=S.value),(Q=document.createElement("div")).className="jcalendar-reset",(Z=document.createElement("div")).className="jcalendar-confirm",(xe=document.createElement("div")).className="jcalendar-controls",xe.style.borderBottom="1px solid #ddd",xe.appendChild(Q),xe.appendChild(Z),(X=document.createElement("div")).className="jcalendar-container",(se=document.createElement("div")).className="jcalendar-content",X.appendChild(se),"DIV"==S.tagName?(ee=S).classList.add("jcalendar-inline"):(se.appendChild(xe),(ee=document.createElement("div")).className="jcalendar"),ee.classList.add("jcalendar-container"),ee.appendChild(X);var ie=document.createElement("div");ie.className="jcalendar-table",se.appendChild(ie);var he=document.createElement("td");he.setAttribute("colspan","2"),he.className="jcalendar-prev",(oe=document.createElement("span")).className="jcalendar-year",(me=document.createElement("span")).className="jcalendar-month";var K=document.createElement("td");K.className="jcalendar-header",K.setAttribute("colspan","3"),K.appendChild(me),K.appendChild(oe);var ae=document.createElement("td");ae.setAttribute("colspan","2"),ae.className="jcalendar-next";var ue=document.createElement("thead"),Ce=document.createElement("tr");Ce.appendChild(he),Ce.appendChild(K),Ce.appendChild(ae),ue.appendChild(Ce),ce=document.createElement("table"),ge=document.createElement("tbody"),ce.setAttribute("cellpadding","0"),ce.setAttribute("cellspacing","0"),ce.appendChild(ue),ce.appendChild(ge),ie.appendChild(ce),(Re=document.createElement("select")).className="jcalendar-select",Re.onchange=function(){_.date[3]=this.value,"function"==typeof _.options.onupdate&&_.options.onupdate(S,_.getValue())};for(var je=0;je<24;je++)(pe=document.createElement("option")).value=je,pe.innerHTML=T.two(je),Re.appendChild(pe);for((be=document.createElement("select")).className="jcalendar-select",be.onchange=function(){_.date[4]=this.value,"function"==typeof _.options.onupdate&&_.options.onupdate(S,_.getValue())},je=0;je<60;je++){var pe;(pe=document.createElement("option")).value=je,pe.innerHTML=T.two(je),be.appendChild(pe)}var Me=document.createElement("div");Me.className="jcalendar-controls",(Ee=document.createElement("div")).className="jcalendar-time",Ee.style.maxWidth="140px",Ee.appendChild(Re),Ee.appendChild(be),(ze=document.createElement("button")).setAttribute("type","button"),ze.className="jcalendar-update",(Ve=document.createElement("div")).style.flexGrow="10",Ve.appendChild(ze),Me.appendChild(Ee),"INPUT"==S.tagName&&Me.appendChild(Ve),se.appendChild(Me);var Se=document.createElement("div");Se.className="jcalendar-backdrop",ee.appendChild(Se),S.addEventListener("keyup",W),ee.addEventListener("swipeleft",function(Fe){T.animation.slideLeft(ce,0,function(){_.next(),T.animation.slideRight(ce,1)}),Fe.preventDefault(),Fe.stopPropagation()}),ee.addEventListener("swiperight",function(Fe){T.animation.slideRight(ce,0,function(){_.prev(),T.animation.slideLeft(ce,1)}),Fe.preventDefault(),Fe.stopPropagation()}),S.onmouseup=function(){_.open()},"ontouchend"in document.documentElement?ee.addEventListener("touchend",z):ee.addEventListener("mouseup",z),T.calendar.hasEvents||(T.calendar.hasEvents=!0,document.addEventListener("keydown",T.calendar.keydown)),_.setOptions(V),"INPUT"==S.tagName?(S.parentNode.insertBefore(ee,S.nextSibling),S.setAttribute("autocomplete","off"),S.classList.add("jcalendar-input"),S.value=_.setLabel(_.getValue(),_.options)):(_.getDays(),_.options.time&&(Re.value=_.date[3],be.value=_.date[4])),1==_.options.opened&&_.open(),S.change=_.setValue,S.val=function(Fe){if(void 0===Fe)return _.getValue();_.setValue(Fe)},S.calendar=ee.calendar=_}(),_},T.calendar.keydown=function(S){var V=null;(V=T.calendar.current)&&(13==S.which?V.close(!1,!0):27==S.which&&V.close(!1,!1))},T.calendar.prettify=function(S,V){V||(V={justNow:"Just now",xMinutesAgo:"{0}m ago",xHoursAgo:"{0}h ago",xDaysAgo:"{0}d ago",xWeeksAgo:"{0}w ago",xMonthsAgo:"{0} mon ago",xYearsAgo:"{0}y ago"});var _=new Date,z=new Date(S),W=parseInt((_-z)/1e3/60);if(String.prototype.format=function(ee){return this.replace("{0}",ee)},0==W)var te=V.justNow;else te=W<90?V.xMinutesAgo.format(W):W<1440?V.xHoursAgo.format(Math.round(W/60)):W<20160?V.xDaysAgo.format(Math.round(W/1440)):W<43200?V.xWeeksAgo.format(Math.round(W/10080)):W<1036800?V.xMonthsAgo.format(Math.round(W/43200)):V.xYearsAgo.format(Math.round(W/525600));return te},T.calendar.prettifyAll=function(){for(var S=document.querySelectorAll(".prettydate"),V=0;V<S.length;V++)S[V].getAttribute("data-date")?S[V].innerHTML=T.calendar.prettify(S[V].getAttribute("data-date")):(S[V].setAttribute("data-date",S[V].innerHTML),S[V].innerHTML=T.calendar.prettify(S[V].innerHTML))},T.calendar.now=function(S,V){if(Array.isArray(S))var _=S[0],z=S[1],W=S[2],te=S[3],ee=S[4],Q=S[5];else S||(S=new Date),_=S.getFullYear(),z=S.getMonth()+1,W=S.getDate(),te=S.getHours(),ee=S.getMinutes(),Q=S.getSeconds();return 1==V?T.two(_)+"-"+T.two(z)+"-"+T.two(W):T.two(_)+"-"+T.two(z)+"-"+T.two(W)+" "+T.two(te)+":"+T.two(ee)+":"+T.two(Q)},T.calendar.toArray=function(S){var _=(V=S.split(-1!==S.indexOf("T")?"T":" "))[1],V=V[0].split("-"),z=parseInt(V[0]),W=parseInt(V[1]),te=parseInt(V[2]);if(_){_=_.split(":");var ee=parseInt(_[0]),Q=parseInt(_[1])}else ee=0,Q=0;return[z,W,te,ee,Q,0]},T.calendar.extractDateFromString=function(S,V){if(S>0&&Number(S)==S)return(Q=new Date(Math.round(86400*(S-25569)*1e3))).getFullYear()+"-"+T.two(Q.getMonth())+"-"+T.two(Q.getDate())+" 00:00:00";var _=""+S,z=V.replace(/[0-9]/g,""),W=1,te=z.search("YYYY");te=_.substr(te,4),parseInt(te)!=te&&(W=0);var ee=z.search("MM");ee=_.substr(ee,2),(parseInt(ee)!=ee||ee>12)&&(W=0);var Q=z.search("DD");Q=_.substr(Q,2),(parseInt(Q)!=Q||Q>31)&&(W=0);var Z=z.search("HH");Z>=0?(Z=_.substr(Z,2),(!parseInt(Z)||Z>23)&&(Z="00")):Z="00";var X=z.search("MI");X>=0?(X=_.substr(X,2),(!parseInt(X)||X>59)&&(X="00")):X="00";var se=z.search("SS");return se>=0?(se=_.substr(se,2),(!parseInt(se)||se>59)&&(se="00")):se="00",1==W&&S.length==z.length?te+"-"+ee+"-"+Q+" "+Z+":"+X+":"+se:""},T.calendar.dateToNum=function(S,V){S=new Date(S),V||(V="1899-12-30 "+S.getHours()+":"+S.getMinutes()+":"+S.getSeconds()),V=new Date(V);var _=S.getTime()-V.getTime();return Math.round(_/864e5)},T.calendar.numToDate=function(S){var V=new Date(Math.round(86400*(S-25569)*1e3));return V.getFullYear()+"-"+T.two(V.getMonth()+1)+"-"+T.two(V.getDate())+" 00:00:00"},T.calendar.getDateString=function(S,V){if(V||(V={}),V&&"object"==typeof V)var _=V.format;else _=V;if(_||(_="YYYY-MM-DD"),"number"==typeof S&&_.indexOf("[h]")>=0){var z=parseFloat(24*Number(S));if(_.indexOf("mm")>=0){if((W=(""+z).split("."))[1]){var te=60*parseFloat("0."+W[1]);te=parseFloat(te.toFixed(2))}else te=0;z=parseInt(W[0])+":"+T.two(te)}return z}S instanceof Date?S=T.calendar.now(S):S&&T.isNumeric(S)&&(S=T.calendar.numToDate(S));for(var Q=new RegExp(["DAY","WD","DDDD","DDD","DD","D","Q","HH24","HH12","HH","H","AM/PM","MI","SS","MS","YYYY","YYY","YY","Y","MONTH","MON","MMMMM","MMMM","MMM","MM","M","."].join("|"),"gi"),Z=_.match(Q),X=0;X<Z.length;X++)"MM"==Z[X].toUpperCase()&&(Z[X-1]&&Z[X-1].toUpperCase().indexOf("H")>=0||Z[X-2]&&Z[X-2].toUpperCase().indexOf("H")>=0||Z[X+1]&&Z[X+1].toUpperCase().indexOf("S")>=0||Z[X+2]&&Z[X+2].toUpperCase().indexOf("S")>=0)&&(Z[X]="mi");var se={tokens:Z};if(S){var oe=-1!==(te=""+S).indexOf("T")?"T":" ",W=0,me=0,ce=0;if((te=te.split(oe))[1]&&(me=(W=te[1].split(":"))[1]?W[1]:0,ce=W[2]?W[2]:0,W=W[0]?W[0]:0),(te=te[0].split("-"))[0]&&te[1]&&te[2]&&te[0]>0&&te[1]>0&&te[1]<13&&te[2]>0&&te[2]<32){se.data=[te[0],te[1],te[2],W,me,ce],se.value=[];var ge=new Date(se.data[0],se.data[1]-1,se.data[2],se.data[3],se.data[4],se.data[5]),xe=function(ze){var Re=this.tokens[ze],be=Re.toUpperCase(),re=null;"YYYY"===be?re=this.data[0]:"YYY"===be?re=this.data[0].substring(1,4):"YY"===be?re=this.data[0].substring(2,4):"Y"===be?re=this.data[0].substring(3,4):"MON"===Re?re=T.calendar.months[ge.getMonth()].substr(0,3).toUpperCase():"mon"===Re?re=T.calendar.months[ge.getMonth()].substr(0,3).toLowerCase():"MONTH"===Re?re=T.calendar.months[ge.getMonth()].toUpperCase():"month"===Re?re=T.calendar.months[ge.getMonth()].toLowerCase():"MMMMM"===be?re=T.calendar.months[ge.getMonth()].substr(0,1):"MMMM"===be||"Month"===Re?re=T.calendar.months[ge.getMonth()]:"MMM"===be||"Mon"==Re?re=T.calendar.months[ge.getMonth()].substr(0,3):"MM"===be?re=T.two(this.data[1]):"M"===be?re=ge.getMonth()+1:"DAY"===Re?re=T.calendar.weekdays[ge.getDay()].toUpperCase():"day"===Re?re=T.calendar.weekdays[ge.getDay()].toLowerCase():"DDDD"===be||"Day"==Re?re=T.calendar.weekdays[ge.getDay()]:"DDD"===be?re=T.calendar.weekdays[ge.getDay()].substr(0,3):"DD"===be?re=T.two(this.data[2]):"D"===be?re=this.data[2]:"Q"===be?re=Math.floor((ge.getMonth()+3)/3):"HH24"===be||"HH"===be?re=T.two(this.data[3]):"HH12"===be?re=T.two(this.data[3]>12?this.data[3]-12:this.data[3]):"H"===be?re=this.data[3]:"MI"===be?re=T.two(this.data[4]):"SS"===be?re=T.two(this.data[5]):"MS"===be?re=ge.getMilliseconds():"AM/PM"===be?re=this.data[3]>=12?"PM":"AM":"WD"===be&&(re=T.calendar.weekdays[ge.getDay()]),this.value[ze]=null===re?this.tokens[ze]:re};for(X=0;X<se.tokens.length;X++)xe.call(se,X);S=se.value.join("")}else S=""}return S},T.calendar.weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],T.calendar.months=["January","February","March","April","May","June","July","August","September","October","November","December"],T.calendar.weekdaysShort=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],T.calendar.monthsShort=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],T.color=function(S,V){if(S.color)return S.color.setOptions(V,!0);var _={type:"color",options:{}},z=null,W=null,te=null,ee=null,Q=null,Z=null,X=null;_.setOptions=function(ue,Ce){var je={placeholder:"",value:null,onopen:null,onclose:null,onchange:null,closeOnChange:!0,palette:null,position:null,doneLabel:"Done",resetLabel:"Reset",fullscreen:!1,opened:!1};for(var pe in ue||(ue={}),ue&&!ue.palette&&(ue.palette=T.palette()),je)ue&&ue.hasOwnProperty(pe)?_.options[pe]=ue[pe]:(void 0===_.options[pe]||!0===Ce)&&(_.options[pe]=je[pe]);return ee&&(ee.innerHTML=_.options.resetLabel),Q&&(Q.innerHTML=_.options.doneLabel),_.options.palette&&X&&X.updateContent(0,xe()),"string"==typeof _.options.value&&(S.value=_.options.value),_.options.placeholder?S.setAttribute("placeholder",_.options.placeholder):S.getAttribute("placeholder")&&S.removeAttribute("placeholder"),_},_.open=function(){if(!z.classList.contains("jcolor-focus")){T.tracking(_,!0),z.classList.add("jcolor-focus");var ue=te.getBoundingClientRect();if(T.getWindowWidth()<800||1==_.options.fullscreen)te.style.top="",te.classList.add("jcolor-fullscreen"),T.animation.slideBottom(te,1),W.style.display="block";else{te.classList.contains("jcolor-fullscreen")&&(te.classList.remove("jcolor-fullscreen"),W.style.display="");var Ce=S.getBoundingClientRect();_.options.position?(te.style.position="fixed",te.style.top=window.innerHeight<Ce.bottom+ue.height?Ce.top-(ue.height+2)+"px":Ce.top+Ce.height+2+"px",te.style.left=Ce.left+"px"):te.style.top=window.innerHeight<Ce.bottom+ue.height?-1*(ue.height+Ce.height+2)+"px":"2px"}if("function"==typeof _.options.onopen&&_.options.onopen(S),X.setBorder(X.getActive()),_.options.value){var je=ge(_.options.value);ie.forEach(function(pe,Me){pe.value=je[Me],pe.dispatchEvent(new Event("input"))})}}},_.close=function(ue){return z.classList.contains("jcolor-focus")&&(z.classList.remove("jcolor-focus"),W.style.display="",!ue&&"function"==typeof _.options.onclose&&_.options.onclose(S),T.tracking(_,!1)),_.options.value},_.setValue=function(ue){if(ue||(ue=""),ue!=_.options.value){_.options.value=ue,re=ue;var Ce=z.querySelector(".jcolor-selected");Ce&&Ce.classList.remove("jcolor-selected"),_.values[ue]&&_.values[ue].classList.add("jcolor-selected"),"function"==typeof _.options.onchange&&_.options.onchange(S,ue),S.value!=_.options.value&&(S.value=_.options.value,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value})),1==_.options.closeOnChange&&_.close()}},_.getValue=function(){return _.options.value};var se=!1,oe=function(ue){var Ce=ue.toString(16);return 1===Ce.length?"0"+Ce:Ce},me=function(ue,Ce,je){return"#"+oe(ue)+oe(Ce)+oe(je)},ce=function(ue){return parseInt("0x"+ue)},ge=function(ue){return[ce(ue.substr(1,2)),ce(ue.substr(3,2)),ce(ue.substr(5,2))]},xe=function(){var ue=document.createElement("div");ue.className="jcolor-grid",_.values=[];var Ce=document.createElement("table");Ce.setAttribute("cellpadding","7"),Ce.setAttribute("cellspacing","0");for(var je=0;je<_.options.palette.length;je++){for(var pe=document.createElement("tr"),Me=0;Me<_.options.palette[je].length;Me++){var Se=document.createElement("td"),Fe=_.options.palette[je][Me];Fe.length<7&&"#"!==Fe.substr(0,1)&&(Fe="#"+Fe),Se.style.backgroundColor=Fe,Se.setAttribute("data-value",Fe),Se.innerHTML="",pe.appendChild(Se),_.options.value==Fe&&Se.classList.add("jcolor-selected"),_.values[Fe]=Se}Ce.appendChild(pe)}return ue.appendChild(Ce),ue.addEventListener("mousedown",function($e){if("TD"==$e.target.tagName){var Te=$e.target.getAttribute("data-value");Te&&_.setValue(Te)}}),ue},Ee=document.createElement("canvas");Ee.width=200,Ee.height=160;var Ve=Ee.getContext("2d"),ze=function(){var ue=Z.firstChild.getBoundingClientRect();Ee.width=ue.width-14,Re()},Re=function(){var ue=Ve.createLinearGradient(0,0,Ee.width,0);ue.addColorStop(0,"rgb(255,0,0)"),ue.addColorStop(.15,"rgb(255,0,255)"),ue.addColorStop(.33,"rgb(0,0,255)"),ue.addColorStop(.49,"rgb(0,255,255)"),ue.addColorStop(.67,"rgb(0,255,0)"),ue.addColorStop(.84,"rgb(255,255,0)"),ue.addColorStop(1,"rgb(255,0,0)"),Ve.fillStyle=ue,Ve.fillRect(0,0,Ee.width,Ee.height),(ue=Ve.createLinearGradient(0,0,0,Ee.height)).addColorStop(0,"rgba(255,255,255,1)"),ue.addColorStop(.5,"rgba(255,255,255,0)"),ue.addColorStop(.5,"rgba(0,0,0,0)"),ue.addColorStop(1,"rgba(0,0,0,1)"),Ve.fillStyle=ue,Ve.fillRect(0,0,Ee.width,Ee.height)},be=function(){var ue=document.createElement("div");ue.className="jcolor-hsl";var Ce=document.createElement("div");Ce.className="jcolor-point";var je=document.createElement("div");je.appendChild(Ee),je.appendChild(Ce),ue.appendChild(je);var pe=function(Me,Se,Fe){if(1===Me){var $e=ue.getBoundingClientRect(),Te=Se-$e.left,Ne=Fe-$e.top;Te<0&&(Te=0),Ne<0&&(Ne=0),Te>$e.width&&(Te=$e.width),Ne>$e.height&&(Ne=$e.height),Ce.style.left=Te+"px",Ce.style.top=Ne+"px";var Pe=Ve.getImageData(Te,Ne,1,1).data;re=me(Pe[0],Pe[1],Pe[2])}};return ue.addEventListener("mousedown",function(Me){pe(Me.buttons,Me.clientX,Me.clientY)}),ue.addEventListener("mousemove",function(Me){pe(Me.buttons,Me.clientX,Me.clientY)}),ue.addEventListener("touchmove",function(Me){pe(1,Me.changedTouches[0].clientX,Me.changedTouches[0].clientY)}),ue},re="",ie=[],K=function(){var ue=document.createElement("div");ue.className="jcolor-sliders";var Ce=document.createElement("div"),je=function(Fe){var $e=document.createElement("div");$e.className="jcolor-sliders-input-container";var Te=document.createElement("label");Te.innerText=Fe;var Ne=document.createElement("div");Ne.className="jcolor-sliders-input-subcontainer";var Pe=document.createElement("input");Pe.type="range",Pe.min=0,Pe.max=255,Pe.value=0,$e.appendChild(Te),Ne.appendChild(Pe);var de=document.createElement("div");return de.innerText=Pe.value,Pe.addEventListener("input",function(){de.innerText=Pe.value}),Ne.appendChild(de),$e.appendChild(Ne),Ce.appendChild($e),Pe};ie=[je("Red"),je("Green"),je("Blue")],ue.appendChild(Ce);var pe=document.createElement("div");pe.className="jcolor-sliders-final-color";var Me=document.createElement("div");return Me.style.visibility="hidden",Me.innerText="a",pe.appendChild(Me),ie.forEach(function(Fe){Fe.addEventListener("input",function(){(function(){var Fe=me(parseInt(ie[0].value),parseInt(ie[1].value),parseInt(ie[2].value));Me.innerText=Fe,Me.style.color=Fe,Me.style.removeProperty("visibility"),re=Fe})(),function(){if(""!==re)for(var ue=0;ue<ie.length;ue++){var Ce=ge(re);Ce[ue]=0;var je="linear-gradient(90deg, rgb(";je+=Ce.join(", "),je+="), rgb(",Ce[ue]=255,je+=Ce.join(", "),ie[ue].style.backgroundImage=je+="))"}}()})}),ue.appendChild(pe),ue};return function(){_.setOptions(V),"INPUT"==S.tagName&&(S.classList.add("jcolor-input"),S.readOnly=!0),(z=document.createElement("div")).className="jcolor",(W=document.createElement("div")).className="jcolor-backdrop",z.appendChild(W),(te=document.createElement("div")).className="jcolor-content";var ue=document.createElement("div");ue.className="jcolor-controls",te.appendChild(ue),(ee=document.createElement("div")).className="jcolor-reset",ee.innerHTML=_.options.resetLabel,ee.onclick=function(Ce){_.setValue(""),_.close()},ue.appendChild(ee),(Q=document.createElement("div")).className="jcolor-close",Q.innerHTML=_.options.doneLabel,Q.onclick=function(Ce){X.getActive()>0&&_.setValue(re),_.close()},ue.appendChild(Q),Z=document.createElement("div"),te.appendChild(Z),X=T.tabs(Z,{animation:!0,data:[{title:"Grid",contentElement:xe()},{title:"Spectrum",contentElement:be()},{title:"Sliders",contentElement:K()}],onchange:function(Ce,je,pe){if(1===pe)ze();else{var Me=""!==re?re:_.getValue();if(2===pe&&Me){var Se=ge(Me);ie.forEach(function(Fe,$e){Fe.value=Se[$e],Fe.dispatchEvent(new Event("input"))})}}},palette:"modern"}),z.appendChild(te),"INPUT"==S.tagName?S.parentNode.insertBefore(z,S.nextSibling):S.appendChild(z),S.addEventListener("mouseup",function(Ce){_.open()}),W.addEventListener("mousedown",function(Ce){se=!0}),W.addEventListener("mouseup",function(Ce){se&&(_.close(),se=!1)}),window.addEventListener("resize",function(){z.classList.contains("jcolor-focus")&&1==X.getActive()&&ze()}),1==_.options.opened&&_.open(),S.change=_.setValue,S.val=function(Ce){if(void 0===Ce)return _.getValue();_.setValue(Ce)},S.color=_,z.color=_}(),_},T.contextmenu=function(S,V){var _={options:{}},z={items:null,onclick:null};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];function te(ee){if(!ee.type||"line"!=ee.type&&"divisor"!=ee.type){Q=document.createElement("div");var Z=document.createElement("a");if(Z.innerHTML=ee.title,ee.tooltip&&Q.setAttribute("title",ee.tooltip),ee.icon&&Q.setAttribute("data-icon",ee.icon),ee.id&&(Q.id=ee.id),ee.disabled?Q.className="jcontextmenu-disabled":ee.onclick&&(Q.method=ee.onclick,Q.addEventListener("mousedown",function(Ee){Ee.preventDefault()}),Q.addEventListener("mouseup",function(){this.method(this)})),Q.appendChild(Z),ee.submenu){var X=document.createElement("span");X.innerHTML="&#9658;",Q.appendChild(X),Q.classList.add("jcontexthassubmenu");var se=document.createElement("div");se.classList.add("jcontextmenu"),se.setAttribute("tabindex","900");for(var oe=ee.submenu,me=0;me<oe.length;me++){var ce=te(oe[me]);se.appendChild(ce)}Q.appendChild(se)}else if(ee.shortcut){var ge=document.createElement("span");ge.innerHTML=ee.shortcut,Q.appendChild(ge)}}else var Q=document.createElement("hr");return Q}return S.classList.add("jcontextmenu"),S.setAttribute("tabindex","900"),_.open=function(ee,Q){if(Q&&(_.options.items=Q,_.create(Q)),_.options.items&&_.options.items.length>0||S.children.length){if(ee.target)var Z=ee.clientX,X=ee.clientY;else Z=ee.x,X=ee.y;S.classList.add("jcontextmenu-focus"),S.focus();var se=S.getBoundingClientRect();if(window.innerHeight<X+se.height){var oe=X-se.height;oe<0&&(oe=0),S.style.top=oe+"px"}else S.style.top=X+"px";S.style.left=window.innerWidth<Z+se.width?Z-se.width>0?Z-se.width+"px":"10px":Z+"px"}},_.close=function(){S.classList.contains("jcontextmenu-focus")&&S.classList.remove("jcontextmenu-focus")},_.create=function(ee){S.innerHTML="";for(var Q=0;Q<ee.length;Q++){var Z=te(ee[Q]);S.appendChild(Z)}},"function"==typeof _.options.onclick&&S.addEventListener("click",function(ee){_.options.onclick(_,ee)}),_.options.items&&_.create(_.options.items),S.addEventListener("blur",function(ee){_.close()}),T.contextmenu.hasEvents||(window.addEventListener("mousewheel",function(){_.close()}),document.addEventListener("contextmenu",function(ee){var Q=T.contextmenu.getElement(ee.target);if(Q){var Z=document.querySelector("#"+Q);Z?(Z.contextmenu.open(ee),ee.preventDefault()):console.error("JSUITES: Contextmenu id not found")}}),T.contextmenu.hasEvents=!0),S.contextmenu=_,_},T.contextmenu.getElement=function(S){var V=0;return function _(z){z.parentNode&&z.getAttribute("aria-contextmenu-id")?V=z.getAttribute("aria-contextmenu-id"):z.parentNode&&_(z.parentNode)}(S),V},T.dropdown=function(S,V){if(S.dropdown)return S.dropdown.setOptions(V,!0);var _={type:"dropdown",options:{}},z=function(re,ie){re&&re.length&&(!1!==_.options.sortResults&&re.sort("function"==typeof _.options.sortResults?_.options.sortResults:W),_.setData(re),"function"==typeof _.options.onload&&_.options.onload(S,_,re,ie)),ie&&ee(ie),null==ie&&(_.options.value=""),S.value=_.options.value,1==_.options.opened&&_.open()},W=function(re,ie){var he,K;return"string"==typeof re?he=re:re.text?he=re.text:re.name&&(he=re.name),"string"==typeof ie?K=ie:ie.text?K=ie.text:ie.name&&(K=ie.name),"string"==typeof he||"string"==typeof K?("string"!=typeof he&&(he=""+he),"string"!=typeof K&&(K=""+K),he.localeCompare(K)):he-K},te=function(){_.value={};for(var re=0;re<_.items.length;re++)1==_.items[re].selected&&(_.items[re].element&&_.items[re].element.classList.remove("jdropdown-selected"),_.items[re].selected=null);_.options.value=""},ee=function(re){if(te(),null!==re)if(re){Array.isArray(re)||(re=(""+re).split(";"));for(var ie=0;ie<re.length;ie++)_.value[re[ie]]=""}else void 0!==_.value[""]&&(_.value[""]="");for(ie=0;ie<_.items.length;ie++)void 0!==_.value[Q(ie)]&&(_.items[ie].element&&_.items[ie].element.classList.add("jdropdown-selected"),_.items[ie].selected=!0,_.value[Q(ie)]=Z(ie));_.options.value=Object.keys(_.value).join(";"),_.header.value=_.getText()},Q=function(re,ie){if(_.options.format)var he="id";else he="value";return _.items[re]?void 0!==ie?_.items[re].data[he]=ie:_.items[re].data[he]:""},Z=function(re,ie){if(_.options.format)var he="name";else he="text";return _.items[re]?void 0!==ie?_.items[re].data[he]=ie:_.items[re].data[he]:""},X=function(){return Object.keys(_.value)},se=function(){for(var re=[],ie=Object.keys(_.value),he=0;he<ie.length;he++)re.push(_.value[ie[he]]);return re};_.setOptions=function(re,ie){re||(re={});var he={url:null,data:[],format:0,multiple:!1,autocomplete:!1,remoteSearch:!1,lazyLoading:!1,type:null,width:null,maxWidth:null,opened:!1,value:null,placeholder:"",newOptions:!1,position:!1,onchange:null,onload:null,onopen:null,onclose:null,onfocus:null,onblur:null,oninsert:null,onbeforeinsert:null,sortResults:!1,autofocus:!1};for(var K in he)re&&re.hasOwnProperty(K)?_.options[K]=re[K]:(void 0===_.options[K]||!0===ie)&&(_.options[K]=he[K]);return(1==_.options.remoteSearch||"searchbar"===_.options.type)&&(_.options.autocomplete=!0),1==_.options.newOptions?_.header.classList.add("jdropdown-add"):_.header.classList.remove("jdropdown-add"),1==_.options.autocomplete?_.header.removeAttribute("readonly"):_.header.setAttribute("readonly","readonly"),_.options.placeholder?_.header.setAttribute("placeholder",_.options.placeholder):_.header.removeAttribute("placeholder"),S.classList.remove("jdropdown-searchbar"),S.classList.remove("jdropdown-picker"),S.classList.remove("jdropdown-list"),"searchbar"==_.options.type?S.classList.add("jdropdown-searchbar"):"list"==_.options.type?S.classList.add("jdropdown-list"):"picker"==_.options.type?S.classList.add("jdropdown-picker"):T.getWindowWidth()<800?_.options.autocomplete?(S.classList.add("jdropdown-searchbar"),_.options.type="searchbar"):(S.classList.add("jdropdown-picker"),_.options.type="picker"):(_.options.width?(S.style.width=_.options.width,S.style.minWidth=_.options.width):(S.style.removeProperty("width"),S.style.removeProperty("min-width")),S.classList.add("jdropdown-default"),_.options.type="default"),"searchbar"==_.options.type?oe.appendChild(ge):me.insertBefore(ge,me.firstChild),_.options.url&&!re.data?T.ajax({url:_.options.url,method:"GET",dataType:"json",success:function(ae){ae&&z(ae,_.options.value)}}):z(_.options.data,_.options.value),_};var oe=null,me=null,ce=null,ge=null,xe=null,Ee=null,Ve=null;_.getUrl=function(){return _.options.url},_.setUrl=function(re,ie){_.options.url=re,T.ajax({url:_.options.url,method:"GET",dataType:"json",success:function(he){_.setData(he),"function"==typeof ie&&ie(_)}})},_.setId=function(re,ie){if(_.options.format)var he="id";else he="value";"object"==typeof re?re[he]=ie:_.items[re].data[he]=ie},_.add=function(re,ie){if(!re){var he=1==_.options.autocomplete?_.header.value:"";if(!(re=prompt(T.translate("Add A New Option"),he)))return!1}if(ie||(ie=T.guid()),_.options.format)var K={id:ie,name:re};else K={value:ie,text:re};if("function"==typeof _.options.onbeforeinsert){var ae=_.options.onbeforeinsert(_,K);if(!1===ae)return!1;ae&&(K=ae)}_.options.data.push(K);var ue=_.createItem(K);return ce.appendChild(ue.element),"function"==typeof _.options.oninsert&&_.options.oninsert(_,K,ue),"none"==ce.style.display&&(ce.style.display=""),_.results&&_.results.push(ue),K},_.createItem=function(re,ie,he){_.options.format?(!re.id&&void 0!==re.value&&(re.id=re.value),!re.name&&void 0!==re.text&&(re.name=re.text)):(!re.value&&void 0!==re.id&&(re.value=re.id),!re.text&&void 0!==re.name&&(re.text=re.name));var K={};if(K.element=document.createElement("div"),K.element.className="jdropdown-item",K.element.indexValue=_.items.length,K.data=re,ie&&(K.group=ie),re.id&&K.element.setAttribute("id",re.id),1==re.disabled&&K.element.setAttribute("data-disabled",!0),re.tooltip&&K.element.setAttribute("title",re.tooltip),re.image){var ae=document.createElement("img");ae.className="jdropdown-image",ae.src=re.image,re.title||ae.classList.add("jdropdown-image-small"),K.element.appendChild(ae)}else if(re.icon){var ue=document.createElement("span");ue.className="jdropdown-icon material-icons",ue.innerText=re.icon,re.title||ue.classList.add("jdropdown-icon-small"),re.color&&(ue.style.color=re.color),K.element.appendChild(ue)}else if(re.color){var Ce=document.createElement("div");Ce.className="jdropdown-color",Ce.style.backgroundColor=re.color,K.element.appendChild(Ce)}if(_.options.format)var je=re.name;else je=re.text;var pe=document.createElement("div");if(pe.className="jdropdown-description",pe.innerHTML=je||"&nbsp;",re.title){var Me=document.createElement("div");Me.className="jdropdown-title",Me.innerText=re.title,pe.appendChild(Me)}if(_.options.format)var Se=re.id;else Se=re.value;return _.value[Se]&&(K.element.classList.add("jdropdown-selected"),K.selected=!0),_.items.push(K),K.element.appendChild(pe),K},_.appendData=function(re){if(re.length){for(var ie=[],he=[],K=0;K<re.length;K++)re[K].group?(he[re[K].group]||(he[re[K].group]=[]),he[re[K].group].push(K)):ie.push(K);var ae=0,ue=Object.keys(he);if(ue.length>0)for(K=0;K<ue.length;K++){var Ce=document.createElement("div");Ce.className="jdropdown-group";var je=document.createElement("div");je.className="jdropdown-group-name",je.innerHTML=ue[K];var pe=document.createElement("i");pe.className="jdropdown-group-arrow jdropdown-group-arrow-down",je.appendChild(pe);var Me=document.createElement("div");Me.className="jdropdown-group-items";for(var Se=0;Se<he[ue[K]].length;Se++){var Fe=_.createItem(re[he[ue[K]][Se]],Ce,ue[K]);(0==_.options.lazyLoading||ae<200)&&(Me.appendChild(Fe.element),ae++)}Ce.appendChild(je),Ce.appendChild(Me),_.groups.push(Ce),Me.children.length>0&&ce.appendChild(Ce)}if(ie.length)for(K=0;K<ie.length;K++)Fe=_.createItem(re[ie[K]]),(0==_.options.lazyLoading||ae<200)&&(ce.appendChild(Fe.element),ae++)}},_.setData=function(re){if(re.length){for(var ie=0;ie<re.length;ie++)"object"!=typeof re[ie]&&(re[ie]=_.options.format?{id:re[ie],name:re[ie]}:{value:re[ie],text:re[ie]});te(),ce.innerHTML="",_.header.value="",_.items=[],_.appendData(re),_.options.data=re}},_.getData=function(){return _.options.data},_.getPosition=function(re){for(var ie=0;ie<_.items.length;ie++)if(Q(ie)==re)return ie;return!1},_.getText=function(re){var ie=se();return re?ie:ie.join("; ")},_.getValue=function(re){var ie=X();return re?ie:ie.join(";")};var Re=function(re){"function"==typeof _.options.onchange&&_.options.onchange(S,_,re,_.options.value),S.value!=_.options.value&&(S.value=_.options.value,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value}))};_.setValue=function(re){var ie=_.getValue();Array.isArray(re)&&(re=re.join(";")),ie!==re&&(ee(re),Re(ie))},_.resetSelected=function(){_.setValue(null)},_.selectIndex=function(re,ie){if(re=parseInt(re),_.items&&_.items[re]&&(!0===ie||!0!==_.items[re].data.disabled))if(_.setCursor(re,!1),_.options.multiple){var he=_.options.value;_.items[re].selected?(_.items[re].element.classList.remove("jdropdown-selected"),_.items[re].selected=!1,delete _.value[Q(re)]):(_.items[re].element.classList.add("jdropdown-selected"),_.items[re].selected=!0,_.value[Q(re)]=Z(re)),_.options.value=Object.keys(_.value).join(";"),0==_.options.autocomplete&&(_.header.value=se().join("; ")),Re(he)}else _.setValue(_.items[re].selected?null:Q(re)),_.close()},_.selectItem=function(re){_.selectIndex(re.indexValue)};var be=function(re,ie){for(var he=0;he<ie.length;he++)if(_.options.format){if(ie[he].id==re)return!0}else if(ie[he].value==re)return!0;return!1};return _.find=function(re){if(_.search==re.trim())return!1;if(_.search=re,_.setCursor(),_.groups.length)for(var ie=0;ie<_.groups.length;ie++)_.groups[ie].lastChild.innerHTML="";if(ce.innerHTML="",1==_.options.remoteSearch){_.results=null;var he=_.options.url+(_.options.url.indexOf("?")>0?"&":"?")+"q="+re;T.ajax({url:he,method:"GET",dataType:"json",success:function(Me){_.items=[];var Se=Object.keys(_.value);if(Se.length)for(var Fe=0;Fe<Se.length;Fe++)be(Se[Fe],Me)||Me.unshift(_.options.format?{id:Se[Fe],name:_.value[Se[Fe]]}:{value:Se[Fe],text:_.value[Se[Fe]]});_.appendData(Me),ce.style.display=Me.length?"":"none"}})}else{re=new RegExp(re,"gi");var K=[];for(ie=0;ie<_.items.length;ie++){var ae=Z(ie),ue=_.items[ie].data.title||"",Ce=_.items[ie].data.group||"",je=_.items[ie].data.synonym||"";je&&(je=je.join(" ")),(null==re||1==_.items[ie].selected||ae.match(re)||ue.match(re)||Ce.match(re)||je.match(re))&&K.push(_.items[ie])}if(K.length){ce.style.display="",_.results=K;var pe=K.length||0;for(1==_.options.lazyLoading&&pe>200&&(pe=200),ie=0;ie<pe;ie++)_.results[ie].group?(_.results[ie].group.parentNode||ce.appendChild(_.results[ie].group),_.results[ie].group.lastChild.appendChild(_.results[ie].element)):ce.appendChild(_.results[ie].element)}else ce.style.display="none",_.results=null}1==_.options.autofocus&&_.first()},_.open=function(){if(!S.classList.contains("jdropdown-focus")){T.dropdown.current=_,T.tracking(_,!0),S.classList.add("jdropdown-focus"),T.getWindowWidth()<800&&(null==_.options.type||"picker"==_.options.type)&&T.animation.slideBottom(me,1),1==_.options.autocomplete&&(_.header.value=_.search,_.header.focus());var re=X();if(re[0]){var ie=_.getPosition(re[0]);!1!==ie&&_.setCursor(ie)}if(!_.options.type||"default"==_.options.type){var he=S.getBoundingClientRect(),K=me.getBoundingClientRect();_.options.position?(me.style.position="fixed",window.innerHeight<he.bottom+K.height?(me.style.top="",me.style.bottom=window.innerHeight-he.top+1+"px"):(me.style.top=he.bottom+"px",me.style.bottom=""),me.style.left=he.left+"px"):window.innerHeight<he.bottom+K.height?(me.style.top="",me.style.bottom=he.height+1+"px"):(me.style.top="",me.style.bottom=""),me.style.minWidth=he.width+"px",_.options.maxWidth&&(me.style.maxWidth=_.options.maxWidth),ce.style.display=_.items.length||1!=_.options.autocomplete?"":"none"}}"function"==typeof _.options.onopen&&_.options.onopen(S)},_.close=function(re){return S.classList.contains("jdropdown-focus")&&(_.header.value=_.getText(),_.setCursor(),!re&&"function"==typeof _.options.onclose&&_.options.onclose(S),_.header.blur&&_.header.blur(),S.classList.remove("jdropdown-focus"),T.tracking(_,!1),T.dropdown.current=null),_.getValue()},_.setCursor=function(re,ie){if(null!=_.currentIndex&&_.items&&_.items[_.currentIndex]&&_.items[_.currentIndex].element.classList.remove("jdropdown-cursor"),null==re)_.currentIndex=null;else if(re=parseInt(re),_.items[re].element.parentNode&&(_.items[re].element.classList.add("jdropdown-cursor"),_.currentIndex=re,!1!==ie&&_.items[_.currentIndex].element)){var K=_.items[_.currentIndex].element;ce.scrollTop=K.offsetTop-K.scrollTop+K.clientTop-95}},_.resetCursor=_.setCursor,_.updateCursor=_.setCursor,_.reset=function(){_.setCursor(),_.setValue(null)},_.first=function(){!0===_.options.lazyLoading&&_.loadFirst();var re=ce.querySelectorAll(".jdropdown-item");re.length&&_.setCursor(re[0].indexValue)},_.last=function(){!0===_.options.lazyLoading&&_.loadLast();var re=ce.querySelectorAll(".jdropdown-item");re.length&&_.setCursor(re[re.length-1].indexValue)},_.next=function(re){var ie=null;if(re){if(1==re.length){var he=_.currentIndex||-1;re=re.toLowerCase();var K=null,ae=null,ue=ce.querySelectorAll(".jdropdown-item");if(ue.length){for(var Ce=0;Ce<ue.length;Ce++)if(ue[Ce].indexValue>he&&(K=_.items[ue[Ce].indexValue])&&(ae=K.element.innerText[0])&&re==(ae=ae.toLowerCase())){ie=ue[Ce].indexValue;break}_.setCursor(ie)}}}else if(null==_.currentIndex||null==_.currentIndex)_.first();else{var je=_.items[_.currentIndex].element,pe=je.nextElementSibling;pe?(pe.classList.contains("jdropdown-group")&&(pe=pe.lastChild.firstChild),ie=pe.indexValue):je.parentNode.classList.contains("jdropdown-group-items")&&((pe=je.parentNode.parentNode.nextElementSibling)&&(pe.classList.contains("jdropdown-group")?pe=pe.lastChild.firstChild:pe.classList.contains("jdropdown-item")?ie=pe.indexValue:pe=null),pe&&(ie=pe.indexValue)),null!==ie&&_.setCursor(ie)}},_.prev=function(){var re=null;if(null===_.currentIndex)_.first();else{var ie=_.items[_.currentIndex].element,he=ie.previousElementSibling;he?(he.classList.contains("jdropdown-group")&&(he=he.lastChild.lastChild),re=he.indexValue):ie.parentNode.classList.contains("jdropdown-group-items")&&((he=ie.parentNode.parentNode.previousElementSibling)&&(he.classList.contains("jdropdown-group")?he=he.lastChild.lastChild:he.classList.contains("jdropdown-item")?re=he.indexValue:he=null),he&&(re=he.indexValue))}null!==re&&_.setCursor(re)},_.loadFirst=function(){if(_.results)var re=_.results;else re=_.items;var ie=re.length||0;1==_.options.lazyLoading&&ie>200&&(ie=200),ce.innerHTML="";for(var he=0;he<ie;he++)re[he].group?(re[he].group.parentNode||ce.appendChild(re[he].group),re[he].group.lastChild.appendChild(re[he].element)):ce.appendChild(re[he].element);ce.scrollTop=0},_.loadLast=function(){if(_.results)var re=_.results;else re=_.items;var ie=re.length;if(ie>200){ie-=200,ce.innerHTML="";for(var he=ie;he<re.length;he++)re[he].group?(re[he].group.parentNode||ce.appendChild(re[he].group),re[he].group.lastChild.appendChild(re[he].element)):ce.appendChild(re[he].element);ce.scrollTop=ce.scrollHeight}},_.loadUp=function(){var re=!1;if(_.results)var ie=_.results;else ie=_.items;var K=ce.querySelectorAll(".jdropdown-item")[0].indexValue,ae=ie.indexOf(K=_.items[K])-1;if(ae>0){for(var ue=0;ae>0&&ie[ae]&&ue<200;)ie[ae].group?(ie[ae].group.parentNode||ce.insertBefore(ie[ae].group,ce.firstChild),ie[ae].group.lastChild.insertBefore(ie[ae].element,ie[ae].group.lastChild.firstChild)):ce.insertBefore(ie[ae].element,ce.firstChild),ae--,ue++;re=!0}return re},_.loadDown=function(){var re=!1;if(_.results)var ie=_.results;else ie=_.items;var he=ce.querySelectorAll(".jdropdown-item"),K=he[he.length-1].indexValue,ae=ie.indexOf(K=_.items[K])+1;if(ae<ie.length){for(var ue=0;ae<ie.length&&ie[ae]&&ue<200;)ie[ae].group?(ie[ae].group.parentNode||ce.appendChild(ie[ae].group),ie[ae].group.lastChild.appendChild(ie[ae].element)):ce.appendChild(ie[ae].element),ae++,ue++;re=!0}return re},function(){if(V||(V={}),"SELECT"==S.tagName){var re=T.dropdown.extractFromDom(S,V);S=re.el,V=re.options}!V.placeholder&&S.getAttribute("placeholder")&&(V.placeholder=S.getAttribute("placeholder")),_.value={},_.items=[],_.groups=[],_.search="",_.results=null,S.classList.add("jdropdown"),(oe=document.createElement("div")).className="jdropdown-container-header",_.header=document.createElement("input"),_.header.className="jdropdown-header",_.header.type="text",_.header.setAttribute("autocomplete","off"),_.header.onfocus=function(){"function"==typeof _.options.onfocus&&_.options.onfocus(S)},_.header.onblur=function(){"function"==typeof _.options.onblur&&_.options.onblur(S)},_.header.onkeyup=function(ie){1!=_.options.autocomplete||Ve?_.options.autocomplete||_.next(ie.key):(_.search!=_.header.value.trim()&&(Ve=setTimeout(function(){_.find(_.header.value.trim()),Ve=null},400)),S.classList.contains("jdropdown-focus")||_.open())},T.dropdown.hasEvents||(T.dropdown.hasEvents=!0,document.addEventListener("keydown",T.dropdown.keydown)),(me=document.createElement("div")).className="jdropdown-container",(ce=document.createElement("div")).className="jdropdown-content",(ge=document.createElement("div")).className="jdropdown-close",ge.innerHTML="Done",(xe=document.createElement("div")).className="jdropdown-reset",xe.innerHTML="x",xe.onclick=function(){_.reset(),_.close()},(Ee=document.createElement("div")).className="jdropdown-backdrop",oe.appendChild(_.header),me.appendChild(ce),S.appendChild(oe),S.appendChild(me),S.appendChild(Ee),_.setOptions(V),"ontouchsend"in document.documentElement?S.addEventListener("touchsend",T.dropdown.mouseup):S.addEventListener("mouseup",T.dropdown.mouseup),1==_.options.lazyLoading&&T.lazyLoading(ce,{loadUp:_.loadUp,loadDown:_.loadDown}),S.change=_.setValue,S.val=function(ie){if(void 0===ie)return _.getValue(!!_.options.multiple);_.setValue(ie)},S.dropdown=_}(),_},T.dropdown.keydown=function(S){var V=null;if(V=T.dropdown.current)if(13==S.which||9==S.which)V.header.value&&null==V.currentIndex&&V.options.newOptions?V.add():(null==V.currentIndex&&1==V.options.autocomplete&&""!=V.header.value&&V.find(V.header.value),V.selectIndex(V.currentIndex));else if(38==S.which)null==V.currentIndex?V.first():V.currentIndex>0&&V.prev(),S.preventDefault();else if(40==S.which)null==V.currentIndex?V.first():V.currentIndex+1<V.items.length&&V.next(),S.preventDefault();else if(36==S.which)V.first(),S.target.classList.contains("jdropdown-header")||S.preventDefault();else if(35==S.which)V.last(),S.target.classList.contains("jdropdown-header")||S.preventDefault();else if(27==S.which)V.close();else if(33==S.which){if(null==V.currentIndex)V.first();else if(V.currentIndex>0)for(var _=0;_<7;_++)V.prev();S.preventDefault()}else if(34==S.which){if(null==V.currentIndex)V.first();else if(V.currentIndex+1<V.items.length)for(_=0;_<7;_++)V.next();S.preventDefault()}},T.dropdown.mouseup=function(S){var V=T.findElement(S.target,"jdropdown");if(V){var _=V.dropdown;if(S.target.classList.contains("jdropdown-header"))if(V.classList.contains("jdropdown-focus")&&V.classList.contains("jdropdown-default")){var z=V.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var W=S.changedTouches[0].clientX;else W=S.clientX;z.width-(W-z.left)<30?S.target.classList.contains("jdropdown-add")?_.add():_.close():0==_.options.autocomplete&&_.close()}else _.open();else if(S.target.classList.contains("jdropdown-group-name")){var ee=S.target.nextSibling.children;if("none"!=S.target.nextSibling.style.display)for(var Q=0;Q<ee.length;Q++)"none"!=ee[Q].style.display&&_.selectItem(ee[Q])}else S.target.classList.contains("jdropdown-group-arrow")?S.target.classList.contains("jdropdown-group-arrow-down")?(S.target.classList.remove("jdropdown-group-arrow-down"),S.target.classList.add("jdropdown-group-arrow-up"),S.target.parentNode.nextSibling.style.display="none"):(S.target.classList.remove("jdropdown-group-arrow-up"),S.target.classList.add("jdropdown-group-arrow-down"),S.target.parentNode.nextSibling.style.display=""):S.target.classList.contains("jdropdown-item")?_.selectItem(S.target):S.target.classList.contains("jdropdown-image")||S.target.classList.contains("jdropdown-description")?_.selectItem(S.target.parentNode):S.target.classList.contains("jdropdown-title")?_.selectItem(S.target.parentNode.parentNode):(S.target.classList.contains("jdropdown-close")||S.target.classList.contains("jdropdown-backdrop"))&&_.close()}},T.dropdown.extractFromDom=function(S,V){var _=S;if(V||(V={}),S.getAttribute("multiple")&&(!V||null==V.multiple)&&(V.multiple=!0),S.getAttribute("placeholder")&&(!V||null==V.placeholder)&&(V.placeholder=S.getAttribute("placeholder")),S.getAttribute("data-autocomplete")&&(!V||null==V.autocomplete)&&(V.autocomplete=!0),(!V||null==V.width)&&(V.width=S.offsetWidth),S.value&&(!V||null==V.value)&&(V.value=S.value),!V||null==V.data){V.data=[];for(var z=0;z<S.children.length;z++)if("OPTGROUP"==S.children[z].tagName)for(var W=0;W<S.children[z].children.length;W++)V.data.push({value:S.children[z].children[W].value,text:S.children[z].children[W].innerHTML,group:S.children[z].getAttribute("label")});else V.data.push({value:S.children[z].value,text:S.children[z].innerHTML})}(!V||null==V.onchange)&&(V.onchange=function(ee,Q,Z,X){1==V.multiple?obj.items[Q].classList.contains("jdropdown-selected")?_.options[Q].setAttribute("selected","selected"):_.options[Q].removeAttribute("selected"):_.value=X});var te=document.createElement("div");return S.parentNode.insertBefore(te,S),S.style.display="none",{el:S=te,options:V}},T.editor=function(S,V){var _={options:{}},z={value:null,snippet:null,toolbar:null,remoteParser:null,placeholder:null,parseURL:!1,filterPaste:!0,dropZone:!1,dropAsSnippet:!1,acceptImages:!1,acceptFiles:!1,maxFileSize:5e6,allowImageResize:!0,border:!0,padding:!0,maxHeight:null,height:null,focus:!1,onclick:null,onfocus:null,onblur:null,onload:null,onkeyup:null,onkeydown:null,onchange:null};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];var ee=null,Q=null,Z=[];S.innerHTML="",_.el=S,"function"==typeof _.options.onclick&&(S.onclick=function(de){_.options.onclick(S,_,de)}),S.classList.add("jeditor-container"),1==_.options.padding&&S.classList.add("jeditor-padding"),0==_.options.border&&(S.style.border="0px");var X=document.createElement("div");X.className="jsnippet",X.setAttribute("contenteditable",!1);var se=document.createElement("div");se.className="jeditor-toolbar";var oe=document.createElement("div");if(oe.setAttribute("contenteditable",!0),oe.setAttribute("spellcheck",!1),oe.className="jeditor",_.options.placeholder&&oe.setAttribute("data-placeholder",_.options.placeholder),(_.options.maxHeight||_.options.height)&&(oe.style.overflowY="auto",_.options.maxHeight&&(oe.style.maxHeight=_.options.maxHeight),_.options.height&&(oe.style.height=_.options.height)),_.options.value)var me=_.options.value;else me=S.innerHTML?S.innerHTML:"";me||(me="");var ce=function(de){"function"==typeof _.options.onchange&&_.options.onchange(S,_,de),_.options.value=_.getData(),S.value!=_.options.value&&(S.value=_.options.value,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value}))},xe=function(de){var De,_e;window.getSelection&&(De=window.getSelection()).rangeCount&&((_e=De.getRangeAt(0)).toString(),_e.deleteContents(),_e.insertNode(de),_e.setStartAfter(de),_e.setEndAfter(de),De.removeAllRanges(),De.addRange(_e))},Ee=function(){var de=null;if(de=X.children[0]){de.classList.contains("jslider-grid")||de.classList.add("jslider-grid");var De=de.children.length;de.setAttribute("data-number",De>4?4:De),De>4?de.setAttribute("data-total",De-4):de.removeAttribute("data-total")}},ze=function(de){X.innerHTML="";for(var De=["image","title","description","host","url"],_e=0;_e<De.length;_e++){var Le=document.createElement("div");if(Le.className="jsnippet-"+De[_e],Le.setAttribute("data-k",De[_e]),X.appendChild(Le),de[De[_e]])if("image"==De[_e]){Array.isArray(de.image)||(de.image=[de.image]);for(var Ze=0;Ze<de.image.length;Ze++){var et=document.createElement("img");et.src=de.image[Ze],Le.appendChild(et)}}else Le.innerHTML=de[De[_e]]}oe.appendChild(document.createElement("br")),oe.appendChild(X)},Re=function(){clearTimeout(ee),ee=setTimeout(function(){if(!oe.querySelector(".jsnippet")){var De=oe.innerHTML.replace(/\n/g," "),_e=document.createElement("div");_e.innerHTML=De;var Ze=T.editor.detectUrl(_e.innerText);if(Ze)if("jpg"==Ze[0].substr(-3)||"png"==Ze[0].substr(-3)||"gif"==Ze[0].substr(-3))_.addImage(Ze[0],!0);else{var et=T.editor.youtubeParser(Ze[0]);_.parseWebsite(Ze[0],et)}}},1e3)};_.parseContent=function(){Re()},_.parseWebsite=function(de,De){if(_.options.remoteParser){De&&(de="https://www.youtube.com/watch?v="+De);var _e={title:"",description:"",image:"",host:de.split("/")[2],url:de};T.ajax({url:_.options.remoteParser+encodeURI(de.trim()),method:"GET",dataType:"json",success:function(Le){Le.title&&(_e.title=Le.title),Le.description&&(_e.description=Le.description),Le.host&&(_e.host=Le.host),Le.url&&(_e.url=Le.url),ze(_e),Le.image?_.addImage(Le.image,!0):Le["og:image"]&&_.addImage(Le["og:image"],!0)}})}else console.log("The remoteParser is not defined")},_.setData=function(de){oe.innerHTML=de,_.options.focus&&T.editor.setCursor(oe,!0),Z=[]},_.getFiles=function(){for(var de=oe.querySelectorAll(".jfile"),De=[],_e=0;_e<de.length;_e++)Z[de[_e].src]&&De.push(Z[de[_e].src]);return De},_.getText=function(){return oe.innerText},_.getData=function(de){if(de){var De={content:""};if(X.innerHTML){De.snippet={};for(var Le=0;Le<X.children.length;Le++){var Ze=X.children[Le].getAttribute("data-k");if(Ze)if("image"==Ze){De.snippet.image||(De.snippet.image=[]);for(var et=0;et<X.children[Le].children.length;et++)De.snippet.image.push(X.children[Le].children[et].getAttribute("src"))}else De.snippet[Ze]=X.children[Le].innerHTML}}var Dt=Object.keys(Z);if(Dt.length)for(De.files=[],Le=0;Le<Dt.length;Le++)De.files.push(Z[Dt[Le]]);var ln=oe.innerHTML;ln=(ln=(ln=ln.replace(/<br>/g,"\n")).replace(/<\/div>/g,"</div>\n")).replace(/<(?:.|\n)*?>/gm,""),De.content=ln.trim()}else De=oe.innerHTML;return De},_.reset=function(){oe.innerHTML="",X.innerHTML="",Z=[]},_.addPdf=function(de){if("data"!=de.result.substr(0,4))console.error("Invalid source");else{var De=document.createElement("canvas");De.width=60,De.height=60;var _e=new Image;De.getContext("2d").drawImage(_e,0,0,De.width,De.height),De.toBlob(function(Ze){var et=document.createElement("img");et.src=window.URL.createObjectURL(Ze),et.title=de.name,et.className="jfile pdf",Z[et.src]={file:et.src,extension:"pdf",content:de.result},xe(et)})}},_.addImage=function(de,De){if("data"==de.substr(0,4)||_.options.remoteParser){if("data"==de.substr(0,4))_e=(_e=(_e=de.split(";"))[0].split("/"))[1];else{var _e=de.substr(de.lastIndexOf(".")+1);de=_.options.remoteParser+de}var Le=new Image;Le.onload=function(){var et=document.createElement("canvas");et.width=Le.width,et.height=Le.height,et.getContext("2d").drawImage(Le,0,0,et.width,et.height),et.toBlob(function(ln){var vn=document.createElement("img");vn.src=window.URL.createObjectURL(ln),vn.classList.add("jfile"),vn.setAttribute("tabindex","900"),Z[vn.src]={file:vn.src,extension:_e,content:et.toDataURL()},_.options.dropAsSnippet||De?(function(de){X.innerHTML||ze({}),X.children[0].appendChild(de),Ee()}(vn),Z[vn.src].snippet=!0):xe(vn),ce()})},Le.src=de}else console.error("remoteParser not defined in your initialization")},_.addFile=function(de){for(var De=[],_e=0;_e<de.length;_e++)if(de[_e].size>_.options.maxFileSize)alert("The file is too big");else{var Le=de[_e].type.split("/");(Le="image"==Le[0]?1:"pdf"==Le[1]?2:0)?(De[_e]=new FileReader,De[_e].index=_e,De[_e].type=Le,De[_e].name=de[_e].name,De[_e].date=de[_e].lastModified,De[_e].size=de[_e].size,De[_e].addEventListener("load",function(Ze){2==Ze.target.type?1==_.options.acceptFiles&&_.addPdf(Ze.target):_.addImage(Ze.target.result)},!1),De[_e].readAsDataURL(de[_e])):alert("The extension is not allowed")}},_.destroy=function(){oe.removeEventListener("mouseup",re),oe.removeEventListener("mousedown",ie),oe.removeEventListener("mousemove",he),oe.removeEventListener("keyup",K),oe.removeEventListener("keydown",ae),oe.removeEventListener("dragstart",Se),oe.removeEventListener("dragenter",Fe),oe.removeEventListener("dragover",$e),oe.removeEventListener("drop",Te),oe.removeEventListener("paste",Me),"function"==typeof _.options.onblur&&oe.removeEventListener("blur",Ne),"function"==typeof _.options.onfocus&&oe.removeEventListener("focus",Pe),S.editor=null,S.classList.remove("jeditor-container"),se.remove(),X.remove(),oe.remove()};var re=function(de){Q&&Q.e&&Q.e.classList.remove("resizing"),Q=!1},ie=function(de){var De=function(et){var Dt=et.getBoundingClientRect();Dt.width-(de.clientX-Dt.left)<40&&de.clientY-Dt.top<40&&(et.innerHTML="",et.remove())};if("IMG"==de.target.tagName)if(de.target.style.cursor){var _e=de.target.getBoundingClientRect();Q={e:de.target,x:de.clientX,y:de.clientY,w:_e.width,h:_e.height,d:de.target.style.cursor},de.target.width||(de.target.width=_e.width+"px"),de.target.height||(de.target.height=_e.height+"px");var Le=window.getSelection();if(Le.rangeCount)for(var Ze=0;Ze<Le.rangeCount;Ze++)Le.removeRange(Le.getRangeAt(Ze));de.target.classList.add("resizing")}else Q=!0;else de.target.classList.contains("jsnippet")?De(de.target):de.target.parentNode.classList.contains("jsnippet")&&De(de.target.parentNode),Q=!0},he=function(de){if("IMG"==de.target.tagName&&!de.target.parentNode.classList.contains("jsnippet-image")&&1==_.options.allowImageResize&&de.target.getAttribute("tabindex")){var De=de.target.getBoundingClientRect();de.target.style.cursor=de.clientY-De.top<5?De.width-(de.clientX-De.left)<5?"ne-resize":de.clientX-De.left<5?"nw-resize":"n-resize":De.height-(de.clientY-De.top)<5?De.width-(de.clientX-De.left)<5?"se-resize":de.clientX-De.left<5?"sw-resize":"s-resize":De.width-(de.clientX-De.left)<5?"e-resize":de.clientX-De.left<5?"w-resize":""}if(1==de.which&&Q&&Q.d){if("e-resize"==Q.d||"ne-resize"==Q.d||"se-resize"==Q.d)if(Q.e.width=Q.w+(de.clientX-Q.x),de.shiftKey)Q.e.height=Q.h+(_e=Q.h/Q.w*(de.clientX-Q.x));else var _e=null;_e||("s-resize"==Q.d||"se-resize"==Q.d||"sw-resize"==Q.d)&&(de.shiftKey||(Q.e.height=Q.h+(de.clientY-Q.y)))}},K=function(de){oe.innerHTML||(oe.innerHTML="<div><br></div>"),"function"==typeof _.options.onkeyup&&_.options.onkeyup(S,_,de)},ae=function(de){1==_.options.parseURL&&Re(),"function"==typeof _.options.onkeydown&&_.options.onkeydown(S,_,de),"Delete"==de.key&&"IMG"==de.target.tagName&&de.target.parentNode.classList.contains("jsnippet-image")&&(de.target.remove(),Ee())},ue=[HTMLUnknownElement],Ce=["color","font-weight","font-size","background","background-color","margin"],je=function(de){if(de.attributes&&de.attributes.length){var _e=null,Le=de.getAttribute("style");if(Le){_e=[];for(var Ze=Le.split(";"),et=0;et<Ze.length;et++){var Dt=Ze[et].trim().split(":");if(Ce.indexOf(Dt[0].trim())>=0){var ln=Dt.shift();Dt=Dt.join(":"),_e.push(ln+":"+Dt)}}}if("IMG"==de.tagName)_.options.acceptImages?(de.setAttribute("tabindex","900"),_.addImage(de.src)):de.remove();else for(var dr=de.attributes.length-1;dr>=0;dr--)de.removeAttribute(de.attributes[dr].name);de.style="",_e&&_e.length&&de.setAttribute("style",_e.join(";"))}if(de.children.length)for(dr=0;dr<de.children.length;dr++)je(de.children[dr]);ue.indexOf(de.constructor)>=0&&de.remove()},Me=function(de){if(1==_.options.filterPaste){if(de.clipboardData||de.originalEvent.clipboardData)var De=(de.originalEvent||de).clipboardData.getData("text/html"),_e=(de.originalEvent||de).clipboardData.getData("text/plain"),Le=(de.originalEvent||de).clipboardData.files;else window.clipboardData&&(De=window.clipboardData.getData("Html"),_e=window.clipboardData.getData("Text"),Le=window.clipboardData.files);if(Le.length)_.addFile(Le);else if(De){var Ze=function(de){de&&(de=de.replace(new RegExp("\x3c!--(.*?)--\x3e","gsi"),""));var De=document.createElement("span");return De.innerHTML=de,je(De),De}(De);xe(Ze)}else De=_e.split("\r\n"),de.target.innerText?(De=De.map(function(et){return"<div>"+et+"</div>"}),document.execCommand("insertHtml",!1,De.join(""))):De.map(function(et){var Dt=document.createElement("div");Dt.innerText=et,oe.appendChild(Dt)});de.preventDefault()}},Se=function(de){Q&&Q.e&&de.preventDefault()},Fe=function(de){Q||0==_.options.dropZone||(S.classList.add("jeditor-dragging"),de.preventDefault())},$e=function(de){Q||0==_.options.dropZone||(ee&&clearTimeout(ee),ee=setTimeout(function(){S.classList.remove("jeditor-dragging")},100),de.preventDefault())},Te=function(de){if(!Q&&0!=_.options.dropZone){var De=null;document.caretRangeFromPoint?De=document.caretRangeFromPoint(de.clientX,de.clientY):de.rangeParent&&(De=document.createRange()).setStart(de.rangeParent,de.rangeOffset);var _e=window.getSelection();_e.removeAllRanges(),_e.addRange(De),_e.anchorNode.parentNode.focus();var Le=(de.originalEvent||de).dataTransfer.getData("text/html"),Ze=(de.originalEvent||de).dataTransfer.getData("text/plain"),et=(de.originalEvent||de).dataTransfer.files;et.length?_.addFile(et):Ze&&function(de){var De=document.createElement("div");De.innerHTML=de;var _e=De.querySelectorAll("img");if(_e.length)for(var Le=0;Le<_e.length;Le++)_.addImage(_e[Le].src)}(Le),S.classList.remove("jeditor-dragging"),de.preventDefault()}},Ne=function(de){"function"==typeof _.options.onblur&&_.options.onblur(S,_,de),ce(de)},Pe=function(de){"function"==typeof _.options.onfocus&&_.options.onfocus(S,_,de)};return oe.addEventListener("mouseup",re),oe.addEventListener("mousedown",ie),oe.addEventListener("mousemove",he),oe.addEventListener("keyup",K),oe.addEventListener("keydown",ae),oe.addEventListener("dragstart",Se),oe.addEventListener("dragenter",Fe),oe.addEventListener("dragover",$e),oe.addEventListener("drop",Te),oe.addEventListener("paste",Me),oe.addEventListener("focus",Pe),oe.addEventListener("blur",Ne),"function"==typeof _.options.onload&&_.options.onload(S,_,oe),oe.innerHTML=me,S.appendChild(oe),_.options.snippet&&ze(_.options.snippet),null==_.options.toolbar&&(_.options.toolbar=T.editor.getDefaultToolbar()),_.options.toolbar&&(S.appendChild(se),T.toolbar(se,{container:!0,responsive:!0,items:_.options.toolbar})),_.options.focus&&T.editor.setCursor(oe,"initial"==_.options.focus),S.change=_.setData,S.val=function(de){if(void 0===de){var De="true"!==S.getAttribute("data-html");return _.getData(De)}_.setData(de)},S.editor=_,_},T.editor.setCursor=function(S,V){S.focus(),document.execCommand("selectAll");var _=window.getSelection(),z=_.getRangeAt(0);if(1==V)var W=z.startContainer,te=0;else te=(W=z.endContainer).length;z.setStart(W,te),z.setEnd(W,te),_.removeAllRanges(),_.addRange(z)},T.editor.getDomain=function(S){return S.replace("http://","").replace("https://","").replace("www.","").split(/[/?#]/)[0].split(/:/g)[0]},T.editor.detectUrl=function(S){var _=S.match(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi);return _&&"www"==_[0].substr(0,3)&&(_[0]="http://"+_[0]),_},T.editor.youtubeParser=function(S){var _=S.match(/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/);return!(!_||11!=_[7].length)&&_[7]},T.editor.getDefaultToolbar=function(){return[{content:"undo",onclick:function(){document.execCommand("undo")}},{content:"redo",onclick:function(){document.execCommand("redo")}},{type:"divisor"},{content:"format_bold",onclick:function(S,V,_){document.execCommand("bold"),document.queryCommandState("bold")?_.classList.add("selected"):_.classList.remove("selected")}},{content:"format_italic",onclick:function(S,V,_){document.execCommand("italic"),document.queryCommandState("italic")?_.classList.add("selected"):_.classList.remove("selected")}},{content:"format_underline",onclick:function(S,V,_){document.execCommand("underline"),document.queryCommandState("underline")?_.classList.add("selected"):_.classList.remove("selected")}},{type:"divisor"},{content:"format_list_bulleted",onclick:function(S,V,_){document.execCommand("insertUnorderedList"),document.queryCommandState("insertUnorderedList")?_.classList.add("selected"):_.classList.remove("selected")}},{content:"format_list_numbered",onclick:function(S,V,_){document.execCommand("insertOrderedList"),document.queryCommandState("insertOrderedList")?_.classList.add("selected"):_.classList.remove("selected")}},{content:"format_indent_increase",onclick:function(S,V,_){document.execCommand("indent",!0,null),document.queryCommandState("indent")?_.classList.add("selected"):_.classList.remove("selected")}},{content:"format_indent_decrease",onclick:function(){document.execCommand("outdent"),document.queryCommandState("outdent")?this.classList.add("selected"):this.classList.remove("selected")}}]},T.form=function(S,V){var _={options:{}},z={url:null,message:"Are you sure? There are unsaved information in your form",ignore:!1,currentHash:null,submitButton:null,validations:null,onbeforeload:null,onload:null,onbeforesave:null,onsave:null,onbeforeremove:null,onremove:null,onerror:function(Q,Z){T.alert(Z)}};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];return _.options.validations||(_.options.validations={}),_.options.submitButton||(_.options.submitButton=S.querySelector("input[type=submit]")),_.options.submitButton&&_.options.url&&(_.options.submitButton.onclick=function(){_.save()}),_.options.validations.email||(_.options.validations.email=T.validations.email),_.options.validations.length||(_.options.validations.length=T.validations.length),_.options.validations.required||(_.options.validations.required=T.validations.required),_.setUrl=function(Q){_.options.url=Q},_.load=function(){T.ajax({url:_.options.url,method:"GET",dataType:"json",queue:!0,success:function(Q){if("function"==typeof _.options.onbeforeload){var Z=_.options.onbeforeload(S,Q);Z&&(Q=Z)}T.form.setElements(S,Q),"function"==typeof _.options.onload&&_.options.onload(S,Q)}})},_.save=function(){var Q=_.validate();if(Q)_.options.onerror(S,Q);else{var Z=T.form.getElements(S,!0);if("function"==typeof _.options.onbeforesave&&!1===(Z=_.options.onbeforesave(S,Z)))return;T.ajax({url:_.options.url,method:"POST",dataType:"json",data:Z,success:function(X){"function"==typeof _.options.onsave&&_.options.onsave(S,Z,X)}})}},_.remove=function(){if("function"==typeof _.options.onbeforeremove&&!1===_.options.onbeforeremove(S,_))return!1;T.ajax({url:_.options.url,method:"DELETE",dataType:"json",success:function(Z){"function"==typeof _.options.onremove&&_.options.onremove(S,_,Z),_.reset()}})},_.validateElement=function(Q){var Z=!1,X=T.form.getValue(Q),se=Q.getAttribute("data-validation");return"function"!=typeof _.options.validations[se]||_.options.validations[se](X,Q)?Q.classList.contains("error")&&function(Q){var Z=!1;Q.classList.remove("error"),Q.removeAttribute("title");for(var X=S.querySelectorAll("input, select, textarea, div[name]"),se=0;se<X.length;se++)X[se].getAttribute("data-validation")&&X[se].classList.contains("error")&&(Z=!0);_.options.submitButton&&(Z?_.options.submitButton.setAttribute("disabled",!0):_.options.submitButton.removeAttribute("disabled"))}(Q):Z=function(Q){Q.classList.add("error"),_.options.submitButton&&_.options.submitButton.setAttribute("disabled",!0);var Z=Q.getAttribute("data-error")||"There is an error in the form";return Q.setAttribute("title",Z),Z}(Q),Z},_.reset=function(){for(var Z=S.querySelectorAll("input, select, textarea, div[name]"),X=0;X<Z.length;X++)Z[X].getAttribute("name")&&("checkbox"==Z[X].type||"radio"==Z[X].type?Z[X].checked=!1:"function"==typeof Z[X].val?Z[X].val(""):Z[X].value="")},_.validate=function(){for(var Q=[],Z=S.querySelectorAll("input, select, textarea, div[name]"),X=0;X<Z.length;X++)if(Z[X].getAttribute("data-validation")){var se=_.validateElement(Z[X]);se&&Q.push(se)}return Q.length>0&&Q.join("<br>")},_.getError=function(){return!!_.validation()},_.setHash=function(){return _.getHash(T.form.getElements(S))},_.getHash=function(Q){var X,Z=0;if(0===Q.length)return Z;for(X=0;X<Q.length;X++)Z=(Z<<5)-Z+Q.charCodeAt(X),Z|=0;return Z},_.isChanged=function(){var Q=_.setHash();return _.options.currentHash!=Q},_.resetTracker=function(){_.options.currentHash=_.setHash(),_.options.ignore=!1},_.setIgnore=function(Q){_.options.ignore=!!Q},setTimeout(function(){_.options.currentHash=_.setHash()},1e3),S.addEventListener("keyup",function(Q){Q.target.getAttribute("data-validation")&&_.validateElement(Q.target)}),T.form.hasEvents||(window.addEventListener("beforeunload",function(Q){if(_.isChanged()&&0==_.options.ignore){var Z=_.options.message?_.options.message:"o/";return Z?(void 0===Q&&(Q=window.event),Q&&(Q.returnValue=Z),Z):void 0}}),T.form.hasEvents=!0),S.form=_,_},T.form.getValue=function(S){var V=null;if("checkbox"==S.type)1==S.checked&&(V=S.value||!0);else if("radio"==S.type)1==S.checked&&(V=S.value);else if("select"==S.tagName&&1==S.multiple){V=[];for(var _=S.querySelectorAll("options[selected]"),z=0;z<_.length;z++)V.push(_[z].value)}else V="function"==typeof S.val?S.val():S.value||"";return V},T.form.getElements=function(S,V){for(var _={},z=null,W=S.querySelectorAll("input, select, textarea, div[name]"),te=0;te<W.length;te++)(z=W[te].getAttribute("name"))&&(_[z]=T.form.getValue(W[te])||"");return 1==V?_:JSON.stringify(_)},T.form.setElements=function(S,V){for(var _=null,z=null,W=S.querySelectorAll("input, select, textarea, div[name]"),te=0;te<W.length;te++){var ee=W[te].getAttribute("type");if(_=W[te].getAttribute("name")){if(z=null,(_=_.replace(new RegExp(/\[(.*?)\]/gi),".$1")).match(/\./)){var Q=T.path.call(V,_)||"";void 0!==Q&&(z=Q)}else void 0!==V[_]&&(z=V[_]);null!==z&&("checkbox"==ee||"radio"==ee?W[te].checked=!!z:"function"==typeof W[te].val?W[te].val(z):W[te].value=z)}}},T.tracker=T.form,T.focus=function(S){if(S.innerText.length){var V=document.createRange(),_=window.getSelection(),z=S.childNodes[S.childNodes.length-1];V.setStart(z,z.length),V.collapse(!0),_.removeAllRanges(),_.addRange(V),S.scrollLeft=S.scrollWidth}},T.isNumeric=function(S){return!isNaN(S)&&null!==S&&""!==S},T.guid=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(S){var V=16*Math.random()|0;return("x"==S?V:3&V|8).toString(16)})},T.getNode=function(){var S=document.getSelection().anchorNode;return S?3==S.nodeType?S.parentNode:S:null},T.hash=function(S){var _,z,V=0;if(0===S.length)return V;for(_=0;_<S.length;_++)(z=S.charCodeAt(_))>32&&(V=(V<<5)-V+z,V|=0);return V},T.randomColor=function(S){var _=String("#"+Math.random().toString(16).slice(2,8).toUpperCase()).replace(/[^0-9a-f]/gi,"");_.length<6&&(_=_[0]+_[0]+_[1]+_[1]+_[2]+_[2]);var W,te,z=[];for(te=0;te<3;te++)W=parseInt(_.substr(2*te,2),16),W=Math.round(Math.min(Math.max(0,W+-.25*W),255)).toString(16),z.push(("00"+W).substr(W.length));return 1==S?"#"+T.two(z[0].toString(16))+T.two(z[1].toString(16))+T.two(z[2].toString(16)):z},T.getWindowWidth=function(){var S=window,V=document,_=V.documentElement,z=V.getElementsByTagName("body")[0];return S.innerWidth||_.clientWidth||z.clientWidth},T.getWindowHeight=function(){var S=window,V=document,_=V.documentElement,z=V.getElementsByTagName("body")[0];return S.innerHeight||_.clientHeight||z.clientHeight},T.getPosition=function(S){if(S.changedTouches&&S.changedTouches[0])var V=S.changedTouches[0].pageX,_=S.changedTouches[0].pageY;else V=window.Event?S.pageX:S.clientX+(document.documentElement.scrollLeft?document.documentElement.scrollLeft:document.body.scrollLeft),_=window.Event?S.pageY:S.clientY+(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop);return[V,_]},T.click=function(S){if(S.click)S.click();else{var V=new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window});S.dispatchEvent(V)}},T.findElement=function(S,V){var _=!1;return function z(W){W&&!_&&("function"==typeof V?_=V(W):"string"==typeof V&&W.classList&&W.classList.contains(V)&&(_=W)),W.parentNode&&!_&&z(W.parentNode)}(S),_},T.two=function(S){return 1==(S=""+S).length&&(S="0"+S),S},T.sha512=function(S){function V(Te,Ne){this.highOrder=Te,this.lowOrder=Ne}var te,ee,Q,Z,X,se,oe,me,xe,Ee,_=[new V(1779033703,4089235720),new V(3144134277,2227873595),new V(1013904242,4271175723),new V(2773480762,1595750129),new V(1359893119,2917565137),new V(2600822924,725511199),new V(528734635,4215389547),new V(1541459225,327033209)],z=[new V(1116352408,3609767458),new V(1899447441,602891725),new V(3049323471,3964484399),new V(3921009573,2173295548),new V(961987163,4081628472),new V(1508970993,3053834265),new V(2453635748,2937671579),new V(2870763221,3664609560),new V(3624381080,2734883394),new V(310598401,1164996542),new V(607225278,1323610764),new V(1426881987,3590304994),new V(1925078388,4068182383),new V(2162078206,991336113),new V(2614888103,633803317),new V(3248222580,3479774868),new V(3835390401,2666613458),new V(4022224774,944711139),new V(264347078,2341262773),new V(604807628,2007800933),new V(770255983,1495990901),new V(1249150122,1856431235),new V(1555081692,3175218132),new V(1996064986,2198950837),new V(2554220882,3999719339),new V(2821834349,766784016),new V(2952996808,2566594879),new V(3210313671,3203337956),new V(3336571891,1034457026),new V(3584528711,2466948901),new V(113926993,3758326383),new V(338241895,168717936),new V(666307205,1188179964),new V(773529912,1546045734),new V(1294757372,1522805485),new V(1396182291,2643833823),new V(1695183700,2343527390),new V(1986661051,1014477480),new V(2177026350,1206759142),new V(2456956037,344077627),new V(2730485921,1290863460),new V(2820302411,3158454273),new V(3259730800,3505952657),new V(3345764771,106217008),new V(3516065817,3606008344),new V(3600352804,1432725776),new V(4094571909,1467031594),new V(275423344,851169720),new V(430227734,3100823752),new V(506948616,1363258195),new V(659060556,3750685593),new V(883997877,3785050280),new V(958139571,3318307427),new V(1322822218,3812723403),new V(1537002063,2003034995),new V(1747873779,3602036899),new V(1955562222,1575990012),new V(2024104815,1125592928),new V(2227730452,2716904306),new V(2361852424,442776044),new V(2428436474,593698344),new V(2756734187,3733110249),new V(3204031479,2999351573),new V(3329325298,3815920427),new V(3391569614,3928383900),new V(3515267271,566280711),new V(3940187606,3454069534),new V(4118630271,4000239992),new V(116418474,1914138554),new V(174292421,2731055270),new V(289380356,3203993006),new V(460393269,320620315),new V(685471733,587496836),new V(852142971,1086792851),new V(1017036298,365543100),new V(1126000580,2618297676),new V(1288033470,3409855158),new V(1501505948,4234509866),new V(1607167915,987167468),new V(1816402316,1246189591)],W=new Array(64);function re(Te,Ne){var Pe,de,De;return De=(65535&(de=(Te.lowOrder>>>16)+(Ne.lowOrder>>>16)+((Pe=(65535&Te.lowOrder)+(65535&Ne.lowOrder))>>>16)))<<16|65535&Pe,new V((65535&(de=(Te.highOrder>>>16)+(Ne.highOrder>>>16)+((Pe=(65535&Te.highOrder)+(65535&Ne.highOrder)+(de>>>16))>>>16)))<<16|65535&Pe,De)}function ie(Te,Ne,Pe,de){var De,_e,Le;return Le=(65535&(_e=(Te.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Pe.lowOrder>>>16)+(de.lowOrder>>>16)+((De=(65535&Te.lowOrder)+(65535&Ne.lowOrder)+(65535&Pe.lowOrder)+(65535&de.lowOrder))>>>16)))<<16|65535&De,new V((65535&(_e=(Te.highOrder>>>16)+(Ne.highOrder>>>16)+(Pe.highOrder>>>16)+(de.highOrder>>>16)+((De=(65535&Te.highOrder)+(65535&Ne.highOrder)+(65535&Pe.highOrder)+(65535&de.highOrder)+(_e>>>16))>>>16)))<<16|65535&De,Le)}function he(Te,Ne,Pe,de,De){var _e,Le,Ze;return Ze=(65535&(Le=(Te.lowOrder>>>16)+(Ne.lowOrder>>>16)+(Pe.lowOrder>>>16)+(de.lowOrder>>>16)+(De.lowOrder>>>16)+((_e=(65535&Te.lowOrder)+(65535&Ne.lowOrder)+(65535&Pe.lowOrder)+(65535&de.lowOrder)+(65535&De.lowOrder))>>>16)))<<16|65535&_e,new V((65535&(Le=(Te.highOrder>>>16)+(Ne.highOrder>>>16)+(Pe.highOrder>>>16)+(de.highOrder>>>16)+(De.highOrder>>>16)+((_e=(65535&Te.highOrder)+(65535&Ne.highOrder)+(65535&Pe.highOrder)+(65535&de.highOrder)+(65535&De.highOrder)+(Le>>>16))>>>16)))<<16|65535&_e,Ze)}function K(Te,Ne,Pe){return new V(Te.highOrder&Ne.highOrder^Te.highOrder&Pe.highOrder^Ne.highOrder&Pe.highOrder,Te.lowOrder&Ne.lowOrder^Te.lowOrder&Pe.lowOrder^Ne.lowOrder&Pe.lowOrder)}function ae(Te,Ne,Pe){return new V(Te.highOrder&Ne.highOrder^~Te.highOrder&Pe.highOrder,Te.lowOrder&Ne.lowOrder^~Te.lowOrder&Pe.lowOrder)}function ue(Te,Ne){return Ne<=32?new V(Te.highOrder>>>Ne|Te.lowOrder<<32-Ne,Te.lowOrder>>>Ne|Te.highOrder<<32-Ne):new V(Te.lowOrder>>>Ne|Te.highOrder<<32-Ne,Te.highOrder>>>Ne|Te.lowOrder<<32-Ne)}function Ce(Te){var Ne=ue(Te,28),Pe=ue(Te,34),de=ue(Te,39);return new V(Ne.highOrder^Pe.highOrder^de.highOrder,Ne.lowOrder^Pe.lowOrder^de.lowOrder)}function je(Te){var Ne=ue(Te,14),Pe=ue(Te,18),de=ue(Te,41);return new V(Ne.highOrder^Pe.highOrder^de.highOrder,Ne.lowOrder^Pe.lowOrder^de.lowOrder)}function pe(Te){var Ne=ue(Te,1),Pe=ue(Te,8),de=Se(Te,7);return new V(Ne.highOrder^Pe.highOrder^de.highOrder,Ne.lowOrder^Pe.lowOrder^de.lowOrder)}function Se(Te,Ne){return Ne<=32?new V(Te.highOrder>>>Ne,Te.lowOrder>>>Ne|Te.highOrder<<32-Ne):new V(0,Te.highOrder<<32-Ne)}var Te,Ne,Pe,de,Fe=8*(S=unescape(encodeURIComponent(S))).length;(S=function(Te){for(var Ne=[],de=8*Te.length,De=0;De<de;De+=8)Ne[De>>5]|=(255&Te.charCodeAt(De/8))<<24-De%32;return Ne}(S))[Fe>>5]|=128<<24-Fe%32,S[31+(Fe+128>>10<<5)]=Fe;for(var ce=0;ce<S.length;ce+=32){te=_[0],ee=_[1],Q=_[2],Z=_[3],X=_[4],se=_[5],oe=_[6],me=_[7];for(var ge=0;ge<80;ge++)W[ge]=ge<16?new V(S[2*ge+ce],S[2*ge+ce+1]):ie((Ne=void 0,Pe=void 0,de=void 0,Ne=ue(Te=W[ge-2],19),Pe=ue(Te,61),de=Se(Te,6),new V(Ne.highOrder^Pe.highOrder^de.highOrder,Ne.lowOrder^Pe.lowOrder^de.lowOrder)),W[ge-7],pe(W[ge-15]),W[ge-16]),xe=he(me,je(X),ae(X,se,oe),z[ge],W[ge]),Ee=re(Ce(te),K(te,ee,Q)),me=oe,oe=se,se=X,X=re(Z,xe),Z=Q,Q=ee,ee=te,te=re(xe,Ee);_[0]=re(te,_[0]),_[1]=re(ee,_[1]),_[2]=re(Q,_[2]),_[3]=re(Z,_[3]),_[4]=re(X,_[4]),_[5]=re(se,_[5]),_[6]=re(oe,_[6]),_[7]=re(me,_[7])}var $e=[];for(ce=0;ce<_.length;ce++)$e.push(_[ce].highOrder),$e.push(_[ce].lowOrder);return function(Te){for(var De,Ne="0123456789abcdef",Pe="",de=4*Te.length,_e=0;_e<de;_e+=1)Pe+=Ne.charAt((De=Te[_e>>2]>>8*(3-_e%4))>>4&15)+Ne.charAt(15&De);return Pe}($e)},T.login||(T.login={},T.login.sha512=T.sha512),T.image=T.upload=function(S,V){var _={options:{}},z={type:"image",extension:"*",input:!1,minWidth:!1,maxWidth:null,maxHeight:null,maxJpegSizeBytes:null,onchange:null,multiple:!1,remoteParser:null,text:{extensionNotAllowed:"The extension is not allowed"}};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];1==_.options.multiple&&S.setAttribute("data-multiple",!0),S.content=[],S.classList.add("jupload"),1==_.options.input&&S.classList.add("input"),_.add=function(X){if(0==_.options.multiple&&(S.content=[],S.innerText=""),"image"==_.options.type){var se=document.createElement("img");se.setAttribute("src",X.file),se.setAttribute("tabindex",-1),S.getAttribute("name")||(se.className="jfile",se.content=X),S.appendChild(se)}else{if(X.name)var oe=X.name;else oe=X.file;var me=document.createElement("div");me.innerText=oe||_.options.type,me.classList.add("jupload-item"),me.setAttribute("tabindex",-1),S.appendChild(me)}X.content&&(X.file=T.guid()),S.content.push(X),"function"==typeof _.options.onchange&&_.options.onchange(S,X)},_.addFromFile=function(X){if(X.type.split("/")[0]==_.options.type){var oe=new FileReader;oe.addEventListener("load",function(me){var ce={file:me.srcElement.result,extension:X.name.substr(X.name.lastIndexOf(".")+1),name:X.name,size:X.size,lastmodified:X.lastModified,content:me.srcElement.result};_.add(ce)}),oe.readAsDataURL(X)}else alert(_.options.text.extensionNotAllowed)},_.addFromUrl=function(X){if("data"==X.substr(0,4)||_.options.remoteParser)if("data"==X.substr(0,4))(se=(se=X.split(";"))[0].split("/"))[0].replace("data:","")==_.options.type?_.add({file:X,name:"",extension:se[1],content:X}):alert(_.options.text.extensionNotAllowed);else{var se=X.substr(X.lastIndexOf(".")+1);T.ajax({url:X=_.options.remoteParser+X,type:"GET",dataType:"blob",success:function(ge){}})}else console.error("remoteParser not defined in your initialization")};var ee=_.options.type+"/"+_.options.extension,Q=document.createElement("input");Q.type="file",Q.setAttribute("accept",ee),Q.onchange=function(){for(var X=0;X<this.files.length;X++)_.addFromFile(this.files[X])},1==_.options.multiple&&Q.setAttribute("multiple",!0);var Z=null;return S.addEventListener("click",function(X){Z=null,S.children.length&&X.target!==S?X.target.parentNode==S&&(Z=X.target):T.click(Q)}),S.addEventListener("dblclick",function(X){T.click(Q)}),S.addEventListener("dragenter",function(X){S.style.border="1px dashed #000"}),S.addEventListener("dragleave",function(X){S.style.border="1px solid #eee"}),S.addEventListener("dragstop",function(X){S.style.border="1px solid #eee"}),S.addEventListener("dragover",function(X){X.preventDefault()}),S.addEventListener("keydown",function(X){if(Z&&46==X.which){var se=Array.prototype.indexOf.call(S.children,Z);se>=0&&(S.content.splice(se,1),Z.remove(),Z=null)}}),S.addEventListener("drop",function(X){X.preventDefault(),X.stopPropagation();var se=(X.originalEvent||X).dataTransfer.getData("text/html");if((X.originalEvent||X).dataTransfer.files.length)for(var me=0;me<X.dataTransfer.files.length;me++)_.addFromFile(X.dataTransfer.files[me]);else if(se){0==_.options.multiple&&(S.innerText="");var ce=document.createElement("div");ce.innerHTML=se;var ge=ce.querySelectorAll("img");if(ge.length)for(me=0;me<ge.length;me++)_.addFromUrl(ge[me].src)}return S.style.border="1px solid #eee",!1}),S.val=function(X){if(void 0===X)return S.content&&S.content.length?S.content:null;if(S.innerText="",S.content=[],X)if(Array.isArray(X))for(var se=0;se<X.length;se++)_.add("string"==typeof X[se]?{file:X[se]}:X[se]);else"string"==typeof X&&_.add({file:X})},S.upload=S.image=_,_},T.image.create=function(S){var V=document.createElement("img");return V.setAttribute("src",S.file),V.className="jfile",V.setAttribute("tabindex",-1),V.content=S,V},T.lazyLoading=function(S,V){(!V.loadUp||"function"!=typeof V.loadUp)&&(V.loadUp=function(){return!1}),(!V.loadDown||"function"!=typeof V.loadDown)&&(V.loadDown=function(){return!1}),V.timer||(V.timer=100);var z=null,W=function(te){if(null==z){var ee=!1,Q=S.scrollTop;S.scrollTop+2*S.clientHeight>=S.scrollHeight?V.loadDown()&&(Q==S.scrollTop&&(S.scrollTop=S.scrollTop-S.clientHeight),ee=!0):S.scrollTop<=S.clientHeight&&V.loadUp()&&(Q==S.scrollTop&&(S.scrollTop=S.scrollTop+S.clientHeight),ee=!0),z=setTimeout(function(){z=null},V.timer),ee&&"function"==typeof V.onupdate&&V.onupdate()}};return S.onscroll=function(te){W()},S.onwheel=function(te){W()},{}},T.loading=function(){var S={},V=null;return S.show=function(){V||((V=document.createElement("div")).className="jloading"),document.body.appendChild(V)},S.hide=function(){V&&V.parentNode&&document.body.removeChild(V)},S}(),T.mask=function(){var S={currency:["#(.{1})##0?(.{1}0+)?( ?;(.*)?)?","#"],percentage:["0{1}(.{1}0+)?%"],numeric:["0{1}(.{1}0+)?"],datetime:["YYYY","YYY","YY","MMMMM","MMMM","MMM","MM","DDDDD","DDDD","DDD","DD","DY","DAY","WD","D","Q","HH24","HH12","HH","\\[H\\]","H","AM/PM","PM","AM","MI","SS","MS","MONTH","MON","Y","M"],general:["A","0","[0-9a-zA-Z$]+","."]},V=function(){if(-1!==this.mask.toLowerCase().indexOf("[h]")){var K=0;this.date[4]&&(K=parseFloat(this.date[4]/60));var ae=parseInt(this.date[3])+K;ae/=24}else this.date[0]&&this.date[1]&&this.date[2]||!this.date[3]&&!this.date[4]?(this.date[0]&&this.date[1]&&!this.date[2]&&(this.date[2]=1),ae=T.two(this.date[0])+"-"+T.two(this.date[1])+"-"+T.two(this.date[2]),(this.date[3]||this.date[4]||this.date[5])&&(ae+=" "+T.two(this.date[3])+":"+T.two(this.date[4])+":"+T.two(this.date[5]))):ae=T.two(this.date[3])+":"+T.two(this.date[4])+":"+T.two(this.date[5]);return ae},_=function(K){return null===K||""===K||void 0===K},W=function(K){return"currency"===K||"percentage"===K||"numeric"===K},te=function(K){if(K&&Number(K)==K)return".";if(this.options.decimal)return this.options.decimal;if(this.locale){var ae=Intl.NumberFormat(this.locale).format(1.1);return this.options.decimal=ae[1]}if(K||(K=this.mask),(ae=(ue=new RegExp("0{1}(.{1})0+","ig")).exec(K))&&ae[1]&&1==ae[1].length)return this.options.decimal=ae[1],ae[1];var ue=new RegExp("#,##","ig");return this.options.decimal=K.match(ue)||"."=="1.1".toLocaleString().substring(1,2)?".":",",this.options.decimal?this.options.decimal:null},ee=function(K,ae){return""==K?"":(ae||(ae=te.call(this)),(K=(""+K).split(ae))[0]=K[0].match(/[\-0-9]+/g,""),K[0]&&(K[0]=K[0].join("")),K[0]?(void 0!==K[1]&&(K[1]=K[1].match(/[0-9]+/g,""),K[1]=K[1]?K[1].join(""):""),K):"")},Q=function(K){if(""==K)return"";var ae=te.call(this),ue=Object.create(this.options||{});if(ue.minimumFractionDigits||(ue.minimumFractionDigits=1),""==(K=ee.call(this,K)))return"";if(K[0]){var Ce=parseFloat(K.join("."));"percent"==ue.style&&(Ce/=100)}else Ce=null;var je=new Intl.NumberFormat(this.locale,ue).format(Ce),pe=(je=je.split(ae))[1].replace(/[0-9]*/g,"");return pe&&(je[2]=pe),je[1]=void 0!==K[1]?ae+K[1]:"",je.join("")},Z=function(K){var ae=oe.call(K);if(ae){te.call(this);var Ce=Q.call(this,ae),je=Ce.length-ae.length,pe=se.call(K)+je;oe.call(K,Ce,pe,!0)}},X=function(K){var ae=ee.call(this,K);return ae?parseFloat(ae.join(".")):null},se=function(K,ae){if(void 0===K){if("DIV"==this.tagName){var ue=0;return(Ce=window.getSelection())&&0!==Ce.rangeCount&&((pe=(je=Ce.getRangeAt(0)).cloneRange()).selectNodeContents(this),pe.setEnd(je.endContainer,je.endOffset),ue=pe.toString().length),ue}return this.selectionStart}var Me=oe.call(this);if(ae){for(var pe=null,Se=0;Se<Me.length;Se++)(Me[Se].match(/[\-0-9]/g)||"."==Me[Se]||","==Me[Se])&&(pe=Se);null===pe&&(pe=Me.indexOf(" ")),K>=pe&&(K=pe+1)}if(K>Me.length&&(K=Me.length),K)if("DIV"==this.tagName){var je,Ce=window.getSelection();(je=document.createRange()).setStart(this.childNodes[0],K),Ce.removeAllRanges(),Ce.addRange(je)}else this.selectionStart=K,this.selectionEnd=K},oe=function(K,ae,ue){if("DIV"==this.tagName){if(void 0===K)return this.innerText;this.innerText!==K&&(this.innerText=K,ae&&se.call(this,ae,ue))}else{if(void 0===K)return this.value;this.value!==K&&(this.value=K,ae&&se.call(this,ae,ue))}},me=T.calendar.weekdays,ce=T.calendar.weekdaysShort,ge=T.calendar.months,xe=T.calendar.monthsShort,Ee={YEAR:function(K,ae){var ue=""+(new Date).getFullYear();void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(K)>=0&&parseInt(K)<=10&&this.values[this.index].length<ae&&(this.values[this.index]+=K),this.values[this.index].length==ae&&(2==ae?ue=ue.substr(0,2)+this.values[this.index]:3==ae?ue=ue.substr(0,1)+this.values[this.index]:4==ae&&(ue=this.values[this.index]),this.date[0]=ue,this.index++)},YYYY:function(K){Ee.YEAR.call(this,K,4)},YYY:function(K){Ee.YEAR.call(this,K,3)},YY:function(K){Ee.YEAR.call(this,K,2)},FIND:function(K,ae){_(this.values[this.index])&&(this.values[this.index]="");for(var ue=0,Ce=0,je=(this.values[this.index]+K).toLowerCase(),pe=0;pe<ae.length;pe++)0==ae[pe].toLowerCase().indexOf(je)&&(ue=pe,Ce++);if(Ce>1)this.values[this.index]+=K;else if(1==Ce)return this.values[this.index]=ae[ue],this.index++,ue},MMM:function(K){var ae=Ee.FIND.call(this,K,xe);void 0!==ae&&(this.date[1]=ae+1)},MMMM:function(K){var ae=Ee.FIND.call(this,K,ge);void 0!==ae&&(this.date[1]=ae+1)},MMMMM:function(K){_(this.values[this.index])&&(this.values[this.index]="");for(var Ce=(this.values[this.index]+K).toLowerCase(),je=0;je<ge.length;je++)if(0==ge[je][0].toLowerCase().indexOf(Ce)){this.values[this.index]=ge[je][0],this.date[1]=je+1,this.index++;break}},MM:function(K){_(this.values[this.index])?parseInt(K)>1&&parseInt(K)<10?(this.date[1]=this.values[this.index]="0"+K,this.index++):parseInt(K)<2&&(this.values[this.index]=K):(1==this.values[this.index]&&parseInt(K)<3||0==this.values[this.index]&&parseInt(K)>0&&parseInt(K)<10)&&(this.date[1]=this.values[this.index]+=K,this.index++)},M:function(K){var ae=!1;if(parseInt(K)>=0&&parseInt(K)<10?_(this.values[this.index])?(this.values[this.index]=K,K>1&&(this.date[1]=this.values[this.index],this.index++)):1==this.values[this.index]&&parseInt(K)<3||0==this.values[this.index]&&parseInt(K)>0?(this.date[1]=this.values[this.index]+=K,this.index++):ae=!0:ae=!0,1==ae){var ue=parseInt(this.values[this.index]);ue>0&&ue<12&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},D:function(K){var ae=!1;if(parseInt(K)>=0&&parseInt(K)<10?_(this.values[this.index])?(this.values[this.index]=K,parseInt(K)>3&&(this.date[2]=this.values[this.index],this.index++)):3==this.values[this.index]&&parseInt(K)<2||1==this.values[this.index]||2==this.values[this.index]||0==this.values[this.index]&&parseInt(K)>0?(this.date[2]=this.values[this.index]+=K,this.index++):ae=!0:ae=!0,1==ae){var ue=parseInt(this.values[this.index]);ue>0&&ue<32&&(this.date[2]=this.values[this.index],this.index++,this.position--)}},DD:function(K){_(this.values[this.index])?parseInt(K)>3&&parseInt(K)<10?(this.date[2]=this.values[this.index]="0"+K,this.index++):parseInt(K)<10&&(this.values[this.index]=K):(3==this.values[this.index]&&parseInt(K)<2||(1==this.values[this.index]||2==this.values[this.index])&&parseInt(K)<10||0==this.values[this.index]&&parseInt(K)>0&&parseInt(K)<10)&&(this.date[2]=this.values[this.index]+=K,this.index++)},DDD:function(K){Ee.FIND.call(this,K,ce)},DDDD:function(K){Ee.FIND.call(this,K,me)},HH12:function(K,ae){_(this.values[this.index])?parseInt(K)>1&&parseInt(K)<10?(ae&&(K=0+K),this.date[3]=this.values[this.index]=K,this.index++):parseInt(K)<10&&(this.values[this.index]=K):(1==this.values[this.index]&&parseInt(K)<3||this.values[this.index]<1&&parseInt(K)<10)&&(this.date[3]=this.values[this.index]+=K,this.index++)},HH24:function(K,ae){parseInt(K)>=0&&parseInt(K)<10&&(null==this.values[this.index]||""==this.values[this.index]?parseInt(K)>2&&parseInt(K)<10?(ae&&(K=0+K),this.date[3]=this.values[this.index]=K,this.index++):parseInt(K)<10&&(this.values[this.index]=K):(2==this.values[this.index]&&parseInt(K)<4||this.values[this.index]<2&&parseInt(K)<10)&&(this.date[3]=this.values[this.index]+=K,this.index++))},HH:function(K){Ee.HH24.call(this,K,1)},H:function(K){Ee.HH24.call(this,K,0)},"\\[H\\]":function(K){null==this.values[this.index]&&(this.values[this.index]=""),K.match(/[0-9]/g)?this.date[3]=this.values[this.index]+=K:this.values[this.index].match(/[0-9]/g)&&(this.date[3]=this.values[this.index],this.index++,this.position--)},N60:function(K,ae){null==this.values[this.index]||""==this.values[this.index]?parseInt(K)>5&&parseInt(K)<10?(this.date[ae]=this.values[this.index]="0"+K,this.index++):parseInt(K)<10&&(this.values[this.index]=K):parseInt(K)<10&&(this.date[ae]=this.values[this.index]+=K,this.index++)},MI:function(K){Ee.N60.call(this,K,4)},SS:function(K){Ee.N60.call(this,K,5)},"AM/PM":function(K){this.values[this.index]="",K&&(this.values[this.index]=this.date[3]>12?"PM":"AM"),this.index++},WD:function(K){void 0===this.values[this.index]&&(this.values[this.index]=""),parseInt(K)>=0&&parseInt(K)<7&&(this.values[this.index]=K),1==this.value[this.index].length&&this.index++},"0{1}(.{1}0+)?":function(K){var ae=te.call(this),ue=!1;_(this.values[this.index])?this.values[this.index]="":"-"==this.values[this.index]&&(ue=!0);var Ce=ee.call(this,this.values[this.index],ae);Ce&&(this.values[this.index]=Ce.join(ae)),parseInt(K)>=0&&parseInt(K)<10?("0"!=this.values[this.index]||K==ae)&&(this.values[this.index]+=K):this.values[this.index]&&K==ae?ae&&-1==this.values[this.index].indexOf(ae)&&(this.values[this.index]+=K):"-"==K&&(ue=!0),!0===ue&&"-"!==this.values[this.index][0]&&(this.values[this.index]="-"+this.values[this.index])},"0{1}(.{1}0+)?%":function(K){Ee["0{1}(.{1}0+)?"].call(this,K),this.values[this.index].match(/[\-0-9]/g)?this.values[this.index]&&-1==this.values[this.index].indexOf("%")&&(this.values[this.index]+="%"):this.values[this.index]=""},"#(.{1})##0?(.{1}0+)?( ?;(.*)?)?":function(K){Ee["0{1}(.{1}0+)?"].call(this,K);var ae=te.call(this),ue=this.tokens[this.index].substr(1,1),Ce="-"===this.values[this.index][0],je=ee.call(this,this.values[this.index],ae);if(""!==je){var pe=je[0].match(/[0-9]/g);if(pe){for(var Me=[],Se=0,Fe=(pe=pe.join("")).length-1;Fe>=0;Fe--)Me.push(pe[Fe]),++Se%3||Me.push(ue);Me=Me.reverse(),je[0]=Me.join(""),je[0].substr(0,1)==ue&&(je[0]=je[0].substr(1))}else je[0]="";this.values[this.index]=je.join(ae),Ce&&(this.values[this.index]="-"+this.values[this.index])}},0:function(K){K.match(/[0-9]/g)&&(this.values[this.index]=K,this.index++)},"[0-9a-zA-Z$]+":function(K){_(this.values[this.index])&&(this.values[this.index]="");var ae=this.tokens[this.index];ae[this.values[this.index].length]==K?(this.values[this.index]+=K,this.values[this.index]==ae&&this.index++):(this.values[this.index]=ae,this.index++,K.match(/[\-0-9]/g)&&this.position--)},A:function(K){K.match(/[a-zA-Z]/gi)&&(this.values[this.index]=K,this.index++)},".":function(K){Ee["[0-9a-zA-Z$]+"].call(this,K)}},Ve=function(K){if("general"==this.type)var ae=[].concat(S.general);else ae=[].concat(S.currency,S.datetime,S.percentage,S.numeric,S.general);var ue=new RegExp(ae.join("|"),"gi");return K.match(ue)},ze=function(K){if(this.type)if("general"==this.type)var ae=["general"];else ae="datetime"==this.type?["numeric","datetime","general"]:["currency","percentage","numeric","general"];else ae=Object.keys(S);for(var ue=0;ue<ae.length;ue++)for(var Ce=ae[ue],je=0;je<S[Ce].length;je++){var pe=new RegExp(S[Ce][je],"gi");if(K.match(pe))return{type:Ce,method:S[Ce][je]}}},Re=function(K){for(var ae=[],ue=0;ue<K.length;ue++){var Ce=ze.call(this,K[ue]);ae.push(Ce?Ce.method:null)}for(ue=0;ue<ae.length;ue++)"MM"==ae[ue]&&(ae[ue-1]&&ae[ue-1].indexOf("H")>=0||ae[ue-2]&&ae[ue-2].indexOf("H")>=0||ae[ue+1]&&ae[ue+1].indexOf("S")>=0||ae[ue+2]&&ae[ue+2].indexOf("S")>=0)&&(ae[ue]="MI");return ae},be=function(K){var ae=ze.call(this,K);if(ae)var ue=ae.type;if(ue){for(var Ce=0,je=Ve.call(this,K),pe=0;pe<je.length;pe++)(ae=ze.call(this,je[pe]))&&W(ae.type)&&Ce++;Ce>1&&(ue="general")}return ue},re=function(){"function"==typeof Ee[this.methods[this.index]]?(Ee[this.methods[this.index]].call(this,this.value[this.position]),this.position++):(this.values[this.index]=this.tokens[this.index],this.index++)},he=function(K,ae,ue){var je=null,pe={input:null,value:null,options:{},values:[],index:0,position:0,date:[0,0,0,0,0,0],number:0};if("object"==typeof K){if(pe.input=K.target,pe.value=oe.call(K.target),pe.caret=se.call(K.target),(je=K.target.getAttribute("data-mask"))&&(pe.mask=je),(je=K.target.getAttribute("data-type"))&&(pe.type=je),K.target.mask?(K.target.mask.options&&(pe.options=K.target.mask.options),K.target.mask.locale&&(pe.locale=K.target.mask.locale)):(je=K.target.getAttribute("data-locale"))&&(pe.locale=je,pe.mask&&(pe.options.style=pe.mask)),K.target.attributes&&K.target.attributes.length)for(var Me=0;Me<K.target.attributes.length;Me++){var Fe=K.target.attributes[Me].value;"data"==(Se=K.target.attributes[Me].name).substr(0,4)&&(pe.options[Se.substr(5)]=Fe)}}else{if("string"==typeof ae)pe.mask=ae;else{var Se=Object.keys(ae);for(Me=0;Me<Se.length;Me++)pe[Se[Me]]=ae[Se[Me]]}"number"==typeof K&&(te.call(pe,pe.mask),K=(""+K).replace(".",pe.options.decimal)),pe.value=K,pe.input&&(oe.call(pe.input,K),T.focus(pe.input),pe.caret=se.call(pe.input))}if(!function(K){return"="==(""+K)[0]}(pe.value)&&(pe.mask||pe.locale)){if(pe.mask){if(pe.mask=pe.mask.replace("[-]",""),pe.mask.indexOf("##")){var $e=pe.mask.split(";");$e[0]&&($e[0]=$e[0].replace("*",""),$e[0]=$e[0].replace(/_/g,""),$e[0]=$e[0].replace(/-/g,""),$e[0]=$e[0].replace("(",""),$e[0]=$e[0].replace(")","")),pe.mask=$e[0]}pe.type||(pe.type=be.call(pe,pe.mask)),pe.tokens=Ve.call(pe,pe.mask)}if("object"!=typeof K||!K.inputType||"insertText"==K.inputType||"insertFromPaste"==K.inputType)if(pe.locale)if(pe.input)Z.call(pe,pe.input);else var Te=Q.call(pe,pe.value);else{for(pe.methods=Re.call(pe,pe.tokens);pe.position<pe.value.length&&void 0!==pe.tokens[pe.index];)re.call(pe);if(W(pe.type)){for(;void 0!==pe.tokens[pe.index];)(je=ze.call(pe,pe.tokens[pe.index]))&&"general"==je.type&&(pe.values[pe.index]=pe.tokens[pe.index]),pe.index++;var Ne=!0}else Ne=!1;if(Te=pe.values.join(""),pe.input){if((je=Te.length-pe.value.length)>0)var Pe=pe.caret+je;else Pe=pe.caret;oe.call(pe.input,Te,Pe,Ne)}}if(pe.input){var de=null;W(pe.type)?(pe.number=X.call(pe,oe.call(pe.input)),de="percentage"==pe.type?pe.number/100:pe.number):"datetime"==pe.type&&(de=V.call(pe),pe.date[0]&&pe.date[1]&&pe.date[2]&&pe.input.setAttribute("data-completed",!0)),de&&pe.input.setAttribute("data-value",de)}if(void 0!==Te)return ue?pe:Te}};return he.prepare=function(K,ae){return ae||(ae={}),Ve.call(ae,K)},he.apply=function(K){var ae=oe.call(K.target);1==K.key.length&&(ae+=K.key),oe.call(K.target,he(ae,K.target.getAttribute("data-mask")))},he.run=function(K,ae,ue){return he(K,{mask:ae,decimal:ue})},he.extract=function(K,ae,ue){if(_(K))return K;if("object"!=typeof ae)return Me;ae.options||(ae.options={}),!ae.mask&&ae.format&&(ae.mask=ae.format),te.call(ae,ae.mask);var Ce=null;if("percent"==ae.type||"percent"==ae.options.style?Ce="percentage":ae.mask&&(Ce=be.call(ae,ae.mask)),"datetime"===Ce){if(K instanceof Date)var je=T.calendar.getDateString(Me,ae.mask);var pe=he(K,ae,!0),Me=V.call(pe);pe.date[0]&&pe.date[1]&&pe.date[2]&&!(pe.date[3]||pe.date[4]||pe.date[5])&&(je=T.calendar.now(pe.date),Me=T.calendar.dateToNum(je))}else Me=X.call(ae,K),"percentage"==Ce&&(Me/=100),pe=ae;return pe.value=Me,ue?pe:Me},he.render=function(K,ae,ue){if(_(K)||"object"!=typeof ae)return K;ae.options||(ae.options={}),!ae.mask&&ae.format&&(ae.mask=ae.format);var Ce=null;"percent"==ae.type||"percent"==ae.options.style?Ce="percentage":ae.mask?Ce=be.call(ae,ae.mask):K instanceof Date&&(Ce="datetime");var je=!1;if("datetime"==Ce||"calendar"==ae.type)(pe=T.calendar.getDateString(K,ae.mask))&&(K=pe),ae.mask&&ue&&(je=!0);else if("percentage"==Ce&&(K*=100),"number"==typeof K){var pe=null;if(ae.mask&&ue){var Me=new RegExp("0{1}(.{1})0+","ig");pe=(Se=ae.mask.match(Me))&&Se[0]?K.toFixed(Se=Se[0].length-2):""+K}else if(ae.locale&&ue){var Se;(Se=(""+K).split("."))[1]?1==Se[1].length&&(Se[1]+="0"):Se[1]="00",pe=Se.join(".")}else pe=function(K){return(""+ +K).replace(/(-?)(\d*)\.?(\d*)e([+-]\d+)/,function(ae,ue,Ce,je,pe){return pe<0?ue+"0."+Array(1-pe-Ce.length).join(0)+Ce+je:ue+Ce+je+Array(pe-je.length+1).join(0)})}(K);null!==pe&&(K=pe,te.call(ae,ae.mask),ae.options.decimal&&(K=K.replace(".",ae.options.decimal)))}else ae.mask&&ue&&(je=!0);if(je){var Fe=ae.mask.length-K.length;if(Fe>0)for(var $e=0;$e<Fe;$e++)K+=" "}return he(K,ae)},he.set=function(K,ae){if(ae){K.setAttribute("data-mask",ae);var ue=new Event("input",{bubbles:!0,cancelable:!0});K.dispatchEvent(ue)}},"undefined"!=typeof document&&document.addEventListener("input",function(K){(K.target.getAttribute("data-mask")||K.target.mask)&&he(K)}),he}(),T.modal=function(S,V){var _={options:{}},z={url:null,onopen:null,onclose:null,closed:!1,width:null,height:null,title:null,padding:null};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];!_.options.title&&S.getAttribute("title")&&(_.options.title=S.getAttribute("title"));for(var te=document.createElement("div");S.children[0];)te.appendChild(S.children[0]);for(_.content=document.createElement("div"),_.content.className="jmodal_content",_.content.innerHTML=S.innerHTML;te.children[0];)_.content.appendChild(te.children[0]);_.container=document.createElement("div"),_.container.className="jmodal",_.container.appendChild(_.content),_.options.padding&&(_.content.style.padding=_.options.padding),_.options.width&&(_.container.style.width=_.options.width),_.options.height&&(_.container.style.height=_.options.height),_.options.title?_.container.setAttribute("title",_.options.title):_.container.classList.add("no-title"),S.innerHTML="",S.style.display="none",S.appendChild(_.container);var ee=document.createElement("div");return ee.className="jmodal_backdrop",ee.onclick=function(){_.close()},S.appendChild(ee),_.open=function(){S.style.display="block";var Q=_.container.getBoundingClientRect();T.getWindowWidth()<Q.width?(_.container.style.top="",_.container.style.left="",_.container.classList.add("jmodal_fullscreen"),T.animation.slideBottom(_.container,1)):ee.style.display="block",T.modal.current=_,"function"==typeof _.options.onopen&&_.options.onopen(S,_)},_.resetPosition=function(){_.container.style.top="",_.container.style.left=""},_.isOpen=function(){return"none"!=S.style.display},_.close=function(){S.style.display="none",ee.style.display="",T.modal.current=null,_.container.classList.remove("jmodal_fullscreen"),"function"==typeof _.options.onclose&&_.options.onclose(S,_)},T.modal.hasEvents||(T.modal.current=_,"ontouchstart"in document.documentElement?document.addEventListener("touchstart",T.modal.mouseDownControls):(document.addEventListener("mousedown",T.modal.mouseDownControls),document.addEventListener("mousemove",T.modal.mouseMoveControls),document.addEventListener("mouseup",T.modal.mouseUpControls)),document.addEventListener("keydown",T.modal.keyDownControls),T.modal.hasEvents=!0),_.options.url?T.ajax({url:_.options.url,method:"GET",dataType:"text/html",success:function(Q){_.content.innerHTML=Q,_.options.closed||_.open()}}):_.options.closed||_.open(),S.modal=_,_},T.modal.current=null,T.modal.position=null,T.modal.keyDownControls=function(S){27==S.which&&T.modal.current&&T.modal.current.close()},T.modal.mouseUpControls=function(S){T.modal.current&&(T.modal.current.container.style.cursor="auto"),T.modal.position=null},T.modal.mouseMoveControls=function(S){if(T.modal.current&&T.modal.position)if(1==S.which||3==S.which){var V=T.modal.position;T.modal.current.container.style.top=V[1]+(S.clientY-V[3])+V[5]/2+"px",T.modal.current.container.style.left=V[0]+(S.clientX-V[2])+V[4]/2+"px",T.modal.current.container.style.cursor="move"}else T.modal.current.container.style.cursor="auto"},T.modal.mouseDownControls=function(S){T.modal.position=[],S.target.classList.contains("jmodal")&&setTimeout(function(){var V=S.target.getBoundingClientRect();if(S.changedTouches&&S.changedTouches[0])var _=S.changedTouches[0].clientX,z=S.changedTouches[0].clientY;else _=S.clientX,z=S.clientY;V.width-(_-V.left)<50&&z-V.top<50?setTimeout(function(){T.modal.current.close()},100):S.target.getAttribute("title")&&z-V.top<50&&(document.selection?document.selection.empty():window.getSelection&&window.getSelection().removeAllRanges(),T.modal.position=[V.left,V.top,S.clientX,S.clientY,V.width,V.height])},100)},T.notification=function(S){var V={options:{}},_={icon:null,name:"Notification",date:null,error:null,title:null,message:null,timeout:4e3,autoHide:!0,closeable:!0};for(var z in _)V.options[z]=S&&S.hasOwnProperty(z)?S[z]:_[z];var W=document.createElement("div");W.className="jnotification",V.options.error&&W.classList.add("jnotification-error");var te=document.createElement("div");te.className="jnotification-container",W.appendChild(te);var ee=document.createElement("div");ee.className="jnotification-header",te.appendChild(ee);var Q=document.createElement("div");if(Q.className="jnotification-image",ee.appendChild(Q),V.options.icon){var Z=document.createElement("img");Z.src=V.options.icon,Q.appendChild(Z)}var X=document.createElement("div");if(X.className="jnotification-name",X.innerHTML=V.options.name,ee.appendChild(X),1==V.options.closeable){var se=document.createElement("div");se.className="jnotification-close",se.onclick=function(){V.hide()},ee.appendChild(se)}var oe=document.createElement("div");oe.className="jnotification-date",ee.appendChild(oe);var me=document.createElement("div");if(me.className="jnotification-content",te.appendChild(me),V.options.title){var ce=document.createElement("div");ce.className="jnotification-title",ce.innerHTML=V.options.title,me.appendChild(ce)}var ge=document.createElement("div");if(ge.className="jnotification-message",ge.innerHTML=V.options.message,me.appendChild(ge),V.show=function(){document.body.appendChild(W),T.getWindowWidth()>800?T.animation.fadeIn(W):T.animation.slideTop(W,1)},V.hide=function(){T.getWindowWidth()>800?T.animation.fadeOut(W,function(){W.parentNode&&(W.parentNode.removeChild(W),xe&&clearTimeout(xe))}):T.animation.slideTop(W,0,function(){W.parentNode&&(W.parentNode.removeChild(W),xe&&clearTimeout(xe))})},V.show(),1==V.options.autoHide)var xe=setTimeout(function(){V.hide()},V.options.timeout);return T.getWindowWidth()<800&&W.addEventListener("swipeup",function(Ee){V.hide(),Ee.preventDefault(),Ee.stopPropagation()}),V},T.notification.isVisible=function(){var S=document.querySelector(".jnotification");return!(!S||!S.parentNode)},T.palette=function(S){var V={material:[["#ffebee","#fce4ec","#f3e5f5","#e8eaf6","#e3f2fd","#e0f7fa","#e0f2f1","#e8f5e9","#f1f8e9","#f9fbe7","#fffde7","#fff8e1","#fff3e0","#fbe9e7","#efebe9","#fafafa","#eceff1"],["#ffcdd2","#f8bbd0","#e1bee7","#c5cae9","#bbdefb","#b2ebf2","#b2dfdb","#c8e6c9","#dcedc8","#f0f4c3","#fff9c4","#ffecb3","#ffe0b2","#ffccbc","#d7ccc8","#f5f5f5","#cfd8dc"],["#ef9a9a","#f48fb1","#ce93d8","#9fa8da","#90caf9","#80deea","#80cbc4","#a5d6a7","#c5e1a5","#e6ee9c","#fff59d","#ffe082","#ffcc80","#ffab91","#bcaaa4","#eeeeee","#b0bec5"],["#e57373","#f06292","#ba68c8","#7986cb","#64b5f6","#4dd0e1","#4db6ac","#81c784","#aed581","#dce775","#fff176","#ffd54f","#ffb74d","#ff8a65","#a1887f","#e0e0e0","#90a4ae"],["#ef5350","#ec407a","#ab47bc","#5c6bc0","#42a5f5","#26c6da","#26a69a","#66bb6a","#9ccc65","#d4e157","#ffee58","#ffca28","#ffa726","#ff7043","#8d6e63","#bdbdbd","#78909c"],["#f44336","#e91e63","#9c27b0","#3f51b5","#2196f3","#00bcd4","#009688","#4caf50","#8bc34a","#cddc39","#ffeb3b","#ffc107","#ff9800","#ff5722","#795548","#9e9e9e","#607d8b"],["#e53935","#d81b60","#8e24aa","#3949ab","#1e88e5","#00acc1","#00897b","#43a047","#7cb342","#c0ca33","#fdd835","#ffb300","#fb8c00","#f4511e","#6d4c41","#757575","#546e7a"],["#d32f2f","#c2185b","#7b1fa2","#303f9f","#1976d2","#0097a7","#00796b","#388e3c","#689f38","#afb42b","#fbc02d","#ffa000","#f57c00","#e64a19","#5d4037","#616161","#455a64"],["#c62828","#ad1457","#6a1b9a","#283593","#1565c0","#00838f","#00695c","#2e7d32","#558b2f","#9e9d24","#f9a825","#ff8f00","#ef6c00","#d84315","#4e342e","#424242","#37474f"],["#b71c1c","#880e4f","#4a148c","#1a237e","#0d47a1","#006064","#004d40","#1b5e20","#33691e","#827717","#f57f17","#ff6f00","#e65100","#bf360c","#3e2723","#212121","#263238"]],fire:[["0b1a6d","840f38","b60718","de030b","ff0c0c","fd491c","fc7521","faa331","fbb535","ffc73a"],["071147","5f0b28","930513","be0309","ef0000","fa3403","fb670b","f9991b","faad1e","ffc123"],["03071e","370617","6a040f","9d0208","d00000","dc2f02","e85d04","f48c06","faa307","ffba08"],["020619","320615","61040d","8c0207","bc0000","c82a02","d05203","db7f06","e19405","efab00"],["020515","2d0513","58040c","7f0206","aa0000","b62602","b94903","c57205","ca8504","d89b00"]],baby:[["eddcd2","fff1e6","fde2e4","fad2e1","c5dedd","dbe7e4","f0efeb","d6e2e9","bcd4e6","99c1de"],["e1c4b3","ffd5b5","fab6ba","f5a8c4","aacecd","bfd5cf","dbd9d0","baceda","9dc0db","7eb1d5"],["daa990","ffb787","f88e95","f282a9","8fc4c3","a3c8be","cec9b3","9dbcce","82acd2","649dcb"],["d69070","ff9c5e","f66770","f05f8f","74bbb9","87bfae","c5b993","83aac3","699bca","4d89c2"],["c97d5d","f58443","eb4d57","e54a7b","66a9a7","78ae9c","b5a67e","7599b1","5c88b7","4978aa"]]};return V[S]?V[S]:V.material},T.picker=function(S,V){if(S.picker)return S.picker.setOptions(V,!0);var _={type:"picker",options:{}},z=null,W=null;return _.setOptions=function(Q,Z){var X={value:0,data:null,render:null,onchange:null,onselect:null,onopen:null,onclose:null,onload:null,width:null,header:!0,right:!1,content:!1,columns:null,height:null};for(var se in Q&&Q.options&&(Q.data=Q.options),X)Q&&Q.hasOwnProperty(se)?_.options[se]=Q[se]:(void 0===_.options[se]||!0===Z)&&(_.options[se]=X[se]);return z.style.display=!1===_.options.header?"none":"",z.style.width=_.options.width?parseInt(_.options.width)+"px":"",_.options.height?(W.style.maxHeight=_.options.height+"px",W.style.overflow="scroll"):W.style.overflow="",_.options.columns>0&&(W.classList.add("jpicker-columns"),W.style.width=_.options.width?_.options.width:36*_.options.columns+"px"),isNaN(_.options.value)&&(_.options.value="0"),function(){W.innerHTML="";for(var Q=Object.keys(_.options.data),Z=0;Z<Q.length;Z++){var X=document.createElement("div");X.classList.add("jpicker-item"),X.k=Q[Z],X.v=_.options.data[Q[Z]],X.innerHTML=_.getLabel(Q[Z]),W.appendChild(X)}}(),_.setValue(_.options.value),_},_.getValue=function(){return _.options.value},_.setValue=function(Q){_.setLabel(Q),_.options.value=String(Q),S.value!=_.options.value&&(S.value=_.options.value,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value})),"generic"!==W.children[Q].getAttribute("type")&&_.close()},_.getLabel=function(Q){var Z=_.options.data[Q]||null;return"function"==typeof _.options.render&&(Z=_.options.render(Z)),Z},_.setLabel=function(Q){if(_.options.content)var Z='<i class="material-icons">'+_.options.content+"</i>";else Z=_.getLabel(Q);z.innerHTML=Z},_.open=function(){if(!S.classList.contains("jpicker-focus")){T.tracking(_,!0),S.classList.add("jpicker-focus"),S.focus();var Q=z.getBoundingClientRect(),Z=W.getBoundingClientRect();W.style.marginTop=window.innerHeight<Q.bottom+Z.height?-1*(Z.height+4)+"px":Q.height+2+"px",!0===_.options.right&&(W.style.marginLeft=-1*Z.width+24+"px"),"function"==typeof _.options.onopen&&_.options.onopen(S,_)}},_.close=function(){S.classList.contains("jpicker-focus")&&(S.classList.remove("jpicker-focus"),T.tracking(_,!1),"function"==typeof _.options.onclose&&_.options.onclose(S,_))},S.classList.add("jpicker"),S.setAttribute("tabindex","900"),S.onmousedown=function(Q){S.classList.contains("jpicker-focus")||_.open()},(z=document.createElement("div")).classList.add("jpicker-header"),(W=document.createElement("div")).classList.add("jpicker-content"),W.onclick=function(Q){var Z=T.findElement(Q.target,"jpicker-item");Z&&Z.parentNode===W&&(_.setValue(Z.k),"function"==typeof _.options.onchange&&_.options.onchange.call(_,S,_,Z.v,Z.v,Z.k))},S.appendChild(z),S.appendChild(W),S.value=V.value||0,_.setOptions(V),"function"==typeof _.options.onload&&_.options.onload(S,_),S.change=_.setValue,S.val=function(Q){if(void 0===Q)return _.getValue();_.setValue(Q)},S.picker=_,_},T.progressbar=function(S,V){var _={options:{}},z={value:0,onchange:null,width:null};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];S.classList.add("jprogressbar"),S.setAttribute("tabindex",1),S.setAttribute("data-value",_.options.value);var te=document.createElement("div");te.style.width=_.options.value+"%",te.style.color="#fff",S.appendChild(te),_.options.width&&(S.style.width=_.options.width),_.setValue=function(Q){Q=parseInt(Q),_.options.value=Q,te.style.width=Q+"%",S.setAttribute("data-value",Q+"%"),S.style.color=Q<6?"#000":"#fff",_.options.value=Q,"function"==typeof _.options.onchange&&_.options.onchange(S,Q),S.value!=_.options.value&&(S.value=_.options.value,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value}))},_.getValue=function(){return _.options.value};var ee=function(Q){if(Q.which){var Z=S.getBoundingClientRect();if(Q.changedTouches&&Q.changedTouches[0])var X=Q.changedTouches[0].clientX;else X=Q.clientX;_.setValue(Math.round((X-Z.left)/Z.width*100))}};return"touchstart"in document.documentElement?(S.addEventListener("touchstart",ee),S.addEventListener("touchend",ee)):(S.addEventListener("mousedown",ee),S.addEventListener("mousemove",ee)),S.change=_.setValue,S.val=function(Q){if(void 0===Q)return _.getValue();_.setValue(Q)},S.progressbar=_,_},T.rating=function(S,V){if(S.rating)return S.rating.setOptions(V,!0);var _={options:{},setOptions:function(W,te){var ee={number:5,value:0,tooltip:["Very bad","Bad","Average","Good","Very good"],onchange:null};for(var Q in ee)W&&W.hasOwnProperty(Q)?_.options[Q]=W[Q]:(void 0===_.options[Q]||!0===te)&&(_.options[Q]=ee[Q]);S.innerHTML="";for(var Z=0;Z<_.options.number;Z++){var X=document.createElement("div");X.setAttribute("data-index",Z+1),X.setAttribute("title",_.options.tooltip[Z]),S.appendChild(X)}if(_.options.value)for(Z=0;Z<_.options.number;Z++)Z<_.options.value&&S.children[Z].classList.add("jrating-selected");return _},setValue:function(W){for(var te=0;te<_.options.number;te++)te<W?S.children[te].classList.add("jrating-selected"):(S.children[te].classList.remove("jrating-over"),S.children[te].classList.remove("jrating-selected"));_.options.value=W,"function"==typeof _.options.onchange&&_.options.onchange(S,W),S.value!=_.options.value&&(S.value=_.options.value,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value}))},getValue:function(){return _.options.value}};return _.setOptions(V),S.classList.add("jrating"),S.addEventListener("click",function(W){var te=W.target.getAttribute("data-index");null!=te&&_.setValue(te==_.options.value?0:te)}),S.addEventListener("mouseover",function(W){for(var te=W.target.getAttribute("data-index"),ee=0;ee<_.options.number;ee++)ee<te?S.children[ee].classList.add("jrating-over"):S.children[ee].classList.remove("jrating-over")}),S.addEventListener("mouseout",function(W){for(var te=0;te<_.options.number;te++)S.children[te].classList.remove("jrating-over")}),S.change=_.setValue,S.val=function(W){if(void 0===W)return _.getValue();_.setValue(W)},S.rating=_,_},T.search=function(S,V){if(S.search)return S.search;var _=null,W=function(X){if(Z.innerHTML="",X.length){S.style.display="block";for(var se=X.length<11?X.length:10,oe=0;oe<se;oe++){var me=X[oe].text;!me&&X[oe].name&&(me=X[oe].name);var ce=X[oe].value;!ce&&X[oe].id&&(ce=X[oe].id);var ge=document.createElement("div");ge.setAttribute("data-value",ce),ge.setAttribute("data-text",me),ge.className="jsearch_item",X[oe].id&&ge.setAttribute("id",X[oe].id),0==oe&&ge.classList.add("selected");var xe=document.createElement("img");X[oe].image?xe.src=X[oe].image:xe.style.display="none",ge.appendChild(xe);var Ee=document.createElement("div");Ee.innerHTML=me,ge.appendChild(Ee),Z.appendChild(ge)}}else S.style.display=""},ee=null,Q=function(X){ee&&clearTimeout(ee),ee=setTimeout(function(){!function(X){if(X!=Q.terms)if(Q.terms=X,_=0,Array.isArray(Q.options.data)){var oe=Q.options.data.filter(function(me){return function(me){for(var ce in me)if((""+me[ce]).toLowerCase().search(X)>=0)return!0;return!1}(me)});W(oe)}else T.ajax({url:Q.options.data+X,method:"GET",dataType:"json",success:function(me){W(me)}})}(X)},500)};Q.options={data:V.data||null,input:V.input||null,onselect:V.onselect||null},Q.selectIndex=function(X){var se=X.getAttribute("id"),oe=X.getAttribute("data-text"),me=X.getAttribute("data-value");"function"==typeof Q.options.onselect&&Q.options.onselect(Q,oe,me,se),Q.close()},Q.open=function(){S.style.display="block"},Q.close=function(){ee&&clearTimeout(ee),Q.terms="",Z.innerHTML="",S.style.display=""},Q.isOpened=function(){return!!S.style.display},Q.keydown=function(X){Q.isOpened()&&("Enter"==X.key?Z.children[_]&&(Q.selectIndex(Z.children[_]),X.preventDefault()):"ArrowUp"===X.key?(Z.children[0]&&(Z.children[_].classList.remove("selected"),_>0&&_--,Z.children[_].classList.add("selected")),X.preventDefault()):"ArrowDown"===X.key&&(Z.children[_].classList.remove("selected"),_<9&&Z.children[_+1]&&_++,Z.children[_].classList.add("selected"),X.preventDefault()))},Q.keyup=function(X){if(Q.options.input)Q(Q.options.input.value);else{var se=T.getNode();se&&Q(se.innerText)}};var Z=document.createElement("div");return Z.classList.add("jsearch_container"),Z.onmousedown=function(X){if(X.target.classList.contains("jsearch_item"))var se=X.target;else se=X.target.parentNode;Q.selectIndex(se),X.preventDefault()},S.appendChild(Z),S.classList.add("jsearch"),S.search=Q,Q},T.slider=function(S,V){var _={options:{},currentImage:null};if(V&&(_.options=V),S.setAttribute("tabindex","900"),_.options.items=[],!S.classList.contains("jslider")){if(S.classList.add("jslider"),S.classList.add("unselectable"),_.options.height&&(S.style.minHeight=_.options.height),_.options.width&&(S.style.width=_.options.width),_.options.grid){S.classList.add("jslider-grid");var z=S.children.length;z>4&&S.setAttribute("data-total",z-4),S.setAttribute("data-number",z>4?4:z)}var W=document.createElement("div");if(W.classList.add("jslider-counter"),S.children.length>0)for(var te=0;te<S.children.length;te++){_.options.items.push(S.children[te]);var ee=document.createElement("div");ee.onclick=function(){var oe=Array.prototype.slice.call(W.children).indexOf(this);_.show(_.currentImage=_.options.items[oe])},W.appendChild(ee)}var Q=document.createElement("div");Q.className="jslider-caption";var Z=document.createElement("div"),X=document.createElement("div");X.className="jslider-close",X.innerHTML="",X.onclick=function(){_.close()},Z.appendChild(Q),Z.appendChild(X)}_.updateCounter=function(oe){for(var me=0;me<W.children.length;me++)if(W.children[me].classList.contains("jslider-counter-focus")){W.children[me].classList.remove("jslider-counter-focus");break}W.children[oe].classList.add("jslider-counter-focus")},_.show=function(oe){oe||(oe=S.children[0]),S.classList.add("jslider-focus"),S.classList.remove("jslider-grid"),S.appendChild(Z),S.appendChild(W);var me=_.options.items.indexOf(oe);_.updateCounter(me);for(var ce=0;ce<S.children.length;ce++)S.children[ce].style.display="";oe.style.display="block",oe.previousElementSibling?S.classList.add("jslider-left"):S.classList.remove("jslider-left"),oe.nextElementSibling&&"IMG"==oe.nextElementSibling.tagName?S.classList.add("jslider-right"):S.classList.remove("jslider-right"),_.currentImage=oe,_.currentImage.offsetHeight>_.currentImage.offsetWidth&&_.currentImage.classList.add("jslider-vertical"),Z.children[0].innerText=_.currentImage.getAttribute("title")},_.open=function(){_.show(),"function"==typeof _.options.onopen&&_.options.onopen(S)},_.close=function(){S.classList.remove("jslider-focus"),S.classList.remove("jslider-left"),S.classList.remove("jslider-right"),_.options.grid&&S.classList.add("jslider-grid");for(var oe=0;oe<S.children.length;oe++)S.children[oe].style.display="";W.remove(),Z.remove(),_.currentImage=null,"function"==typeof _.options.onclose&&_.options.onclose(S)},_.reset=function(){S.innerHTML=""},_.next=function(){var oe=_.currentImage.nextElementSibling;oe&&"IMG"===oe.tagName&&_.show(_.currentImage.nextElementSibling)},_.prev=function(){_.currentImage.previousElementSibling&&_.show(_.currentImage.previousElementSibling)};var se=function(oe){if("IMG"==oe.target.tagName)_.show(oe.target);else if(!oe.target.classList.contains("jslider-close")&&!oe.target.parentNode.classList.contains("jslider-counter")&&!oe.target.classList.contains("jslider-counter")){var me=oe.offsetX||oe.changedTouches[0].clientX;oe.target.clientWidth-me<40?_.next():me<40&&_.prev()}};return"ontouchend"in document.documentElement?S.addEventListener("touchend",se):S.addEventListener("mouseup",se),S.addEventListener("swipeleft",function(oe){_.next(),oe.preventDefault(),oe.stopPropagation()}),S.addEventListener("swiperight",function(oe){_.prev(),oe.preventDefault(),oe.stopPropagation()}),S.addEventListener("keydown",function(oe){27==oe.which&&_.close()}),S.slider=_,_},T.sorting=function(S,V){var _={options:{}},z={pointer:null,direction:null,ondragstart:null,ondragend:null,ondrop:null},W=null;for(var te in z)_.options[te]=V&&V.hasOwnProperty(te)?V[te]:z[te];S.classList.add("jsorting"),S.addEventListener("dragstart",function(Z){var X=Array.prototype.indexOf.call(Z.target.parentNode.children,Z.target);W={element:Z.target,o:X,d:X},Z.target.style.opacity="0.25","function"==typeof _.options.ondragstart&&_.options.ondragstart(S,Z.target,Z)}),S.addEventListener("dragover",function(Z){if(Z.preventDefault(),ee(Z.target)&&W&&"true"==Z.target.getAttribute("draggable")&&W.element!=Z.target){if(_.options.direction)var X=Z.target.clientWidth/2>Z.offsetX;else X=Z.target.clientHeight/2>Z.offsetY;Z.target.parentNode.insertBefore(W.element,X?Z.target:Z.target.nextSibling),W.d=Array.prototype.indexOf.call(Z.target.parentNode.children,W.element)}}),S.addEventListener("dragleave",function(Z){Z.preventDefault()}),S.addEventListener("dragend",function(Z){Z.preventDefault(),W&&("function"==typeof _.options.ondragend&&_.options.ondragend(S,W.element,Z),Z.target.parentNode.insertBefore(W.element,W.o<W.d?Z.target.parentNode.children[W.o]:Z.target.parentNode.children[W.o].nextSibling),W.element.style.opacity="",W=null)}),S.addEventListener("drop",function(Z){Z.preventDefault(),W&&W.o!=W.d&&"function"==typeof _.options.ondrop&&_.options.ondrop(S,W.o,W.d,W.element,Z.target,Z),W.element.style.opacity="",W=null});for(var ee=function(Z){var X=!1;return function se(oe){oe.className&&oe.classList.contains("jsorting")&&(X=!0),X||se(oe.parentNode)}(Z),X},Q=0;Q<S.children.length;Q++)S.children[Q].hasAttribute("draggable")||S.children[Q].setAttribute("draggable","true");return S.val=function(){for(var Z=null,X=[],se=0;se<S.children.length;se++)(Z=S.children[se].getAttribute("data-id"))&&X.push(Z);return X},S},T.tabs=function(S,V){var _={options:{}},z={data:[],position:null,allowCreate:!1,allowChangePosition:!1,onclick:null,onload:null,onchange:null,oncreate:null,ondelete:null,onbeforecreate:null,onchangeposition:null,animation:!1,hideHeaders:!1,padding:null,palette:null};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];S.classList.add("jtabs");var te=null,ee=null,Q=null,Z=function(ce){if(_.options.animation){var ge=_.headers.children[ce].getBoundingClientRect();"modern"==_.options.palette?(Q.style.width=ge.width-4+"px",Q.style.left=_.headers.children[ce].offsetLeft+2+"px"):(Q.style.width=ge.width+"px",Q.style.left=_.headers.children[ce].offsetLeft+"px"),"bottom"==_.options.position?Q.style.top="0px":Q.style.bottom="0px"}},X=function(ce){"function"==typeof _.headers.scrollTo?_.headers.scrollTo({left:ce,behavior:"smooth"}):_.headers.scrollLeft=ce,ce<=1?te.classList.add("disabled"):te.classList.remove("disabled"),ce>=_.headers.scrollWidth-_.headers.offsetWidth?ee.classList.add("disabled"):ee.classList.remove("disabled"),_.headers.scrollWidth<=_.headers.offsetWidth?(te.style.display="none",ee.style.display="none"):(te.style.display="",ee.style.display="")};if(_.setBorder=Z,_.open=function(ce){for(var ge=null,xe=0;xe<_.headers.children.length;xe++)_.headers.children[xe].classList.contains("jtabs-selected")&&(ge=xe),_.headers.children[xe].classList.remove("jtabs-selected"),_.content.children[xe]&&_.content.children[xe].classList.remove("jtabs-selected");if(_.headers.children[ce].classList.add("jtabs-selected"),_.content.children[ce]&&_.content.children[ce].classList.add("jtabs-selected"),ge!=ce&&"function"==typeof _.options.onchange&&_.content.children[ce]&&_.options.onchange(S,_,ce,_.headers.children[ce],_.content.children[ce]),1==_.options.hideHeaders&&_.headers.children.length<3&&0==_.options.allowCreate)_.headers.parentNode.style.display="none";else{Z(ce),_.headers.parentNode.style.display="";var Ee=_.headers.children[ce].offsetLeft,ze=_.headers.scrollLeft;ze<=Ee&&ze+_.headers.offsetWidth>=Ee+_.headers.children[ce].offsetWidth||X(Ee-1)}},_.selectIndex=function(ce){var ge=Array.prototype.indexOf.call(_.headers.children,ce);return ge>=0&&_.open(ge),ge},_.rename=function(ce,ge){ge||(ge=prompt("New title",_.headers.children[ce].innerText)),_.headers.children[ce].innerText=ge,_.open(ce)},_.create=function(ce,ge){if("function"==typeof _.options.onbeforecreate){var xe=_.options.onbeforecreate(S);if(!1===xe)return!1;ce=xe}var Ee=_.appendElement(ce);return"function"==typeof _.options.oncreate&&_.options.oncreate(S,Ee),Ee},_.remove=function(ce){return _.deleteElement(ce)},_.nextNumber=function(){for(var ce=0,ge=0;ge<_.headers.children.length;ge++){var xe=_.headers.children[ge].innerText.match(/[0-9].*/);xe>ce&&(ce=parseInt(xe))}return ce?ce++:ce=1,ce},_.deleteElement=function(ce){if(!_.headers.children[ce])return!1;_.headers.removeChild(_.headers.children[ce]),_.content.removeChild(_.content.children[ce]),_.open(0),"function"==typeof _.options.ondelete&&_.options.ondelete(S,ce)},_.appendElement=function(ce,ge){if(ce||(ce=prompt("Title?","")),ce){var xe=document.createElement("div");_.content.appendChild(xe);var Ee=document.createElement("div");return Ee.innerHTML=ce,Ee.content=xe,_.headers.insertBefore(Ee,_.headers.lastChild),_.options.allowChangePosition&&Ee.setAttribute("draggable","true"),_.selectIndex(Ee),"function"==typeof ge&&ge(xe,Ee),xe}},_.getActive=function(){for(var ce=0;ce<_.headers.children.length;ce++)if(_.headers.children[ce].classList.contains("jtabs-selected"))return ce;return 0},_.updateContent=function(ce,ge){"string"!=typeof ge||(document.createElement("div").innerHTML=ge),_.content.children[ce].classList.contains("jtabs-selected")&&ge.classList.add("jtabs-selected"),_.content.replaceChild(ge,_.content.children[ce])},_.updatePosition=function(ce,ge){_.content.insertBefore(_.content.children[ce],ce>ge?_.content.children[ge]:_.content.children[ge].nextSibling),_.open(ge),"function"==typeof _.options.onchangeposition&&_.options.onchangeposition(_.headers,ce,ge)},_.move=function(ce,ge){_.headers.insertBefore(_.headers.children[ce],ce>ge?_.headers.children[ge]:_.headers.children[ge].nextSibling),_.updatePosition(ce,ge)},_.setBorder=Z,_.init=function(){S.innerHTML="",_.headers=document.createElement("div"),_.content=document.createElement("div"),_.headers.classList.add("jtabs-headers"),_.content.classList.add("jtabs-content"),_.options.palette?S.classList.add("jtabs-modern"):S.classList.remove("jtabs-modern"),_.options.padding&&(_.content.style.padding=parseInt(_.options.padding)+"px");var ce=document.createElement("div");ce.className="jtabs-headers-container",ce.appendChild(_.headers);var ge=document.createElement("div");if(ge.className="jtabs-controls",ge.setAttribute("draggable","false"),ce.appendChild(ge),"bottom"==_.options.position?(S.appendChild(_.content),S.appendChild(ce)):(S.appendChild(ce),S.appendChild(_.content)),1==_.options.allowCreate){var xe=document.createElement("div");xe.className="jtabs-add",xe.onclick=function(){_.create()},ge.appendChild(xe)}(te=document.createElement("div")).className="jtabs-prev",te.onclick=function(){X(_.headers.scrollLeft-_.headers.offsetWidth)},ge.appendChild(te),(ee=document.createElement("div")).className="jtabs-next",ee.onclick=function(){X(_.headers.scrollLeft+_.headers.offsetWidth)},ge.appendChild(ee);for(var Ee=0;Ee<_.options.data.length;Ee++){if(_.options.data[Ee].titleElement)var Ve=_.options.data[Ee].titleElement;else Ve=document.createElement("div");if(_.options.data[Ee].icon){var ze=document.createElement("div"),Re=document.createElement("i");Re.classList.add("material-icons"),Re.innerHTML=_.options.data[Ee].icon,ze.appendChild(Re),Ve.appendChild(ze)}if(_.options.data[Ee].title){var be=document.createTextNode(_.options.data[Ee].title);Ve.appendChild(be)}if(_.options.data[Ee].width&&(Ve.style.width=_.options.data[Ee].width),_.options.data[Ee].contentElement)var re=_.options.data[Ee].contentElement;else(re=document.createElement("div")).innerHTML=_.options.data[Ee].content;_.headers.appendChild(Ve),_.content.appendChild(re)}(Q=document.createElement("div")).className="jtabs-border",_.headers.appendChild(Q),_.options.animation&&S.classList.add("jtabs-animation"),_.headers.addEventListener("click",function(ie){if(ie.target.parentNode.classList.contains("jtabs-headers"))var he=ie.target;else he="I"==ie.target.tagName?ie.target.parentNode.parentNode:ie.target.parentNode;var K=_.selectIndex(he);"function"==typeof _.options.onclick&&_.options.onclick(S,_,K,_.headers.children[K],_.content.children[K])}),_.headers.addEventListener("contextmenu",function(ie){_.selectIndex(ie.target)}),_.headers.children.length&&_.open(0),X(0),1==_.options.allowChangePosition&&T.sorting(_.headers,{direction:1,ondrop:function(ie,he,K){_.updatePosition(he,K)}}),"function"==typeof _.options.onload&&_.options.onload(S,_)},S.children[0]&&S.children[0].children.length)for(var se=0;se<S.children[0].children.length;se++){var oe=_.options.data&&_.options.data[se]?_.options.data[se]:{};S.children[1]&&S.children[1].children[se]?(oe.titleElement=S.children[0].children[se],oe.contentElement=S.children[1].children[se]):oe.contentElement=S.children[0].children[se],_.options.data[se]=oe}var me=!1;if(_.options.data)for(se=0;se<_.options.data.length;se++)_.options.data[se].url&&(T.ajax({url:_.options.data[se].url,type:"GET",dataType:"text/html",index:se,success:function(ge){_.options.data[this.index].content=ge},complete:function(){_.init()}}),me=!0);return me||_.init(),S.tabs=_,_},T.tags=function(S,V){if(S.tags)return S.tags.setOptions(V,!0);var _={type:"tags",options:{}},z=function(){return!!(_.options.limit&&S.children.length>=_.options.limit)},W=null,te=null;_.setOptions=function(be,re){var ie={value:"",limit:null,limitMessage:null,search:null,placeholder:null,validation:null,onbeforechange:null,onlimit:null,onchange:null,onfocus:null,onblur:null,onload:null,colors:null};for(var he in ie)be&&be.hasOwnProperty(he)?_.options[he]=be[he]:(void 0===_.options[he]||!0===re)&&(_.options[he]=ie[he]);return _.options.placeholder?S.setAttribute("data-placeholder",_.options.placeholder):S.removeAttribute("data-placeholder"),S.placeholder=_.options.placeholder,_.setValue(_.options.value),X(),_.options.search?te||(te=document.createElement("div"),S.parentNode.insertBefore(te,S.nextSibling),W=T.search(te,{data:_.options.search,onselect:function(K,ae,ue){_.selectIndex(ae,ue)}})):te&&(W=null,te.remove(),te=null),_},_.add=function(be,re){if("function"==typeof _.options.onbeforechange){var ie=_.options.onbeforechange(S,_,_.options.value,be);if(!1===ie)return!1;null!=ie&&(be=ie)}if(W&&W.close(),z())"function"==typeof _.options.onlimit?_.options.onlimit(_,_.options.limit):_.options.limitMessage&&alert(_.options.limitMessage+" "+_.options.limit);else{var he=T.getNode();if(!(he&&he.parentNode&&he.parentNode.classList.contains("jtags")&&he.nextSibling)||he.nextSibling.innerText&&he.nextSibling.innerText.trim()){if(S.lastChild&&(S.lastChild.innerText.trim()||S.removeChild(S.lastChild)),be&&"string"!=typeof be){for(var ae=0;ae<=be.length;ae++)if(!z()){if(be[ae]&&"string"!=typeof be[ae])ue=be[ae].text,Ce=be[ae].value;else var ue=be[ae]||"",Ce=null;K=Q(ue,Ce)}}else var K=Q(be,be,he);Z()}else K=he.nextSibling;re&&ee(K)}},_.setLimit=function(be){for(_.options.limit=be;S.children.length>be;)S.removeChild(S.lastChild)},_.remove=function(be){be.parentNode.removeChild(be),S.children.length?Z():_.add("",!0)},_.getData=function(){for(var be=[],re=0;re<S.children.length;re++){var ie=S.children[re].innerText.replace("\n",""),he=S.children[re].getAttribute("data-value");he||(he=ie),(ie||he)&&be.push({text:ie,value:he})}return be},_.getValue=function(be){var re=null;if(null!=be)(re=S.children[be].getAttribute("data-value"))||(re=S.children[be].innerText.replace("\n",""));else{for(var ie=[],he=0;he<S.children.length;he++)(re=S.children[he].innerText.replace("\n",""))&&ie.push(_.getValue(he));re=ie.join(",")}return re},_.setValue=function(be){if(be){if(S.value!=be)if(Array.isArray(be))_.add(be);else{var re=(""+be).trim(),ie=oe(re);S.innerHTML="",_.add(ie)}}else _.reset()},_.reset=function(){S.classList.add("jtags-empty"),S.innerHTML="<div></div>",Z()},_.isValid=function(){for(var be=0,re=0;re<S.children.length;re++)S.children[re].classList.contains("jtags_error")&&be++;return 0==be},_.selectIndex=function(be,re){var ie=T.getNode();ie&&(ie.innerText=be,re&&ie.setAttribute("data-value",re),ie.classList.remove("jtags_error"),z()||_.add("",!0))},_.search=function(be){},_.destroy=function(){S.removeEventListener("mouseup",Ee),S.removeEventListener("keydown",ce),S.removeEventListener("keyup",ge),S.removeEventListener("paste",xe),S.removeEventListener("focus",Ve),S.removeEventListener("blur",ze),S.parentNode.removeChild(S)};var ee=function(be){if(S.children.length>1){var re=document.createRange(),ie=window.getSelection();be||(be=S.childNodes[S.childNodes.length-1]),re.setStart(be,be.length),re.collapse(!0),ie.removeAllRanges(),ie.addRange(re),S.scrollLeft=S.scrollWidth}},Q=function(be,re,ie){var he=document.createElement("div");return he.innerHTML=be||"",re&&he.setAttribute("data-value",re),ie&&ie.parentNode.classList.contains("jtags")?S.insertBefore(he,ie.nextSibling):S.appendChild(he),he},Z=function(){var be=_.getValue();be!=_.options.value&&(_.options.value=be,"function"==typeof _.options.onchange&&_.options.onchange(S,_,_.options.value),S.value!=_.options.value&&(S.value=_.options.value,"function"==typeof S.onchange&&S.onchange({type:"change",target:S,value:S.value}))),X()},X=function(){for(var be=0;be<S.children.length;be++)_.getValue(be)?(S.children[be].classList.add("jtags_label"),"function"==typeof _.options.validation&&_.getValue(be)?_.options.validation(S.children[be],S.children[be].innerText,S.children[be].getAttribute("data-value"))?S.children[be].classList.remove("jtags_error"):S.children[be].classList.add("jtags_error"):S.children[be].classList.remove("jtags_error")):S.children[be].classList.remove("jtags_label");se()},se=function(){S.innerText.trim()?S.classList.remove("jtags-empty"):(S.innerHTML="<div></div>",S.classList.add("jtags-empty"))},oe=function(be){var re=[],ie="";if(be=be.trim()){for(var he=0;he<be.length;he++)","==be[he]||";"==be[he]||"\n"==be[he]?ie&&(re.push(ie.trim()),ie=""):ie+=be[he];ie&&re.push(ie)}return re},me=0,ce=function(be){me=window.getSelection().anchorOffset,se(),"Tab"===be.key||";"===be.key||","===be.key?(window.getSelection().anchorOffset>1&&(z()?"function"==typeof _.options.onlimit&&_.options.onlimit(_,_.options.limit):_.add("",!0)),be.preventDefault()):"Enter"==be.key?W&&W.isOpened()||(window.getSelection().anchorOffset>1&&(z()||_.add("",!0)),be.preventDefault()):"Backspace"==be.key&&1==S.children.length&&window.getSelection().anchorOffset<1&&be.preventDefault(),W&&W.keydown(be)},ge=function(be){if(39==be.which){var re=window.getSelection().anchorOffset;re>1&&re==me&&_.add("",!0)}else 13==be.which||38==be.which||40==be.which?be.preventDefault():W&&W.keyup(be);X()},xe=function(be){if(be.clipboardData||be.originalEvent.clipboardData)var re=(be.originalEvent||be).clipboardData.getData("text/plain");else window.clipboardData&&(re=window.clipboardData.getData("Text"));var ie=oe(re);ie.length>1&&(_.add(ie,!0),be.preventDefault())},Ee=function(be){if(be.target.parentNode&&be.target.parentNode.classList.contains("jtags")&&(be.target.classList.contains("jtags_label")||be.target.classList.contains("jtags_error"))){var re=be.target.getBoundingClientRect();re.width-(be.clientX-re.left)<16&&_.remove(be.target)}be.target==S&&ee()},Ve=function(){S.classList.contains("jtags-focus")||((!S.children.length||_.getValue(S.children.length-1))&&(z()||Q("")),"function"==typeof _.options.onfocus&&_.options.onfocus(S,_,_.getValue()),S.classList.add("jtags-focus"))},ze=function(){if(S.classList.contains("jtags-focus")){W&&W.close();for(var be=0;be<S.children.length-1;be++)_.getValue(be)||S.removeChild(S.children[be]);Z(),S.classList.remove("jtags-focus"),"function"==typeof _.options.onblur&&_.options.onblur(S,_,_.getValue())}};return"touchend"in document.documentElement?S.addEventListener("touchend",Ee):S.addEventListener("mouseup",Ee),S.addEventListener("keydown",ce),S.addEventListener("keyup",ge),S.addEventListener("paste",xe),S.addEventListener("focus",Ve),S.addEventListener("blur",ze),S.setAttribute("contenteditable",!0),S.classList.add("jtags"),_.setOptions(V),"function"==typeof _.options.onload&&_.options.onload(S,_),S.change=_.setValue,S.val=function(be){if(void 0===be)return _.getValue();_.setValue(be)},S.tags=_,_},T.toolbar=function(S,V){var _={options:{}},z={app:null,container:!1,badge:!1,title:!1,responsive:!1,items:[]};for(var W in z)_.options[W]=V&&V.hasOwnProperty(W)?V[W]:z[W];!S&&V.app&&V.app.el&&(S=document.createElement("div"),V.app.el.appendChild(S));var te=document.createElement("div");te.classList.add("jtoolbar-item"),te.classList.add("jtoolbar-arrow");var ee=document.createElement("div");ee.classList.add("jtoolbar-floating"),te.appendChild(ee),_.selectItem=function(Z){for(var X=Q.children,se=0;se<X.length;se++)Z!=X[se]&&X[se].classList.remove("jtoolbar-selected");Z.classList.add("jtoolbar-selected")},_.hide=function(){T.animation.slideBottom(S,0,function(){S.style.display="none"})},_.show=function(){S.style.display="",T.animation.slideBottom(S,1)},_.get=function(){return S},_.setBadge=function(Z,X){Q.children[Z].children[1].firstChild.innerHTML=X},_.destroy=function(){toolbar.remove(),S.innerHTML=""},_.update=function(Z,X){for(var se=0;se<Q.children.length;se++){var oe=Q.children[se];"function"==typeof oe.updateState&&oe.updateState(S,_,oe,Z,X)}},_.create=function(Z){Q.innerHTML="";for(var X=0;X<Z.length;X++){var se=document.createElement("div");if(se.classList.add("jtoolbar-item"),Z[X].width&&(se.style.width=parseInt(Z[X].width)+"px"),Z[X].k&&(se.k=Z[X].k),Z[X].tooltip&&se.setAttribute("title",Z[X].tooltip),Z[X].id&&se.setAttribute("id",Z[X].id),Z[X].updateState&&(se.updateState=Z[X].updateState),Z[X].active&&se.classList.add("jtoolbar-active"),"select"==Z[X].type||"dropdown"==Z[X].type)T.picker(se,Z[X]);else if("divisor"==Z[X].type)se.classList.add("jtoolbar-divisor");else if("label"==Z[X].type)se.classList.add("jtoolbar-label"),se.innerHTML=Z[X].content;else{var oe=document.createElement("i");if(void 0===Z[X].class)oe.classList.add("material-icons");else for(var me=Z[X].class.split(" "),ce=0;ce<me.length;ce++)oe.classList.add(me[ce]);if(oe.innerHTML=Z[X].content?Z[X].content:"",se.appendChild(oe),1==_.options.badge){var ge=document.createElement("div");ge.classList.add("jbadge");var xe=document.createElement("div");xe.innerHTML=Z[X].badge?Z[X].badge:"",ge.appendChild(xe),se.appendChild(ge)}if(Z[X].title)if(1==_.options.title){var Ee=document.createElement("span");Ee.innerHTML=Z[X].title,se.appendChild(Ee)}else se.setAttribute("title",Z[X].title);_.options.app&&Z[X].route&&(se.route=Z[X].route,se.onclick=function(){_.options.app.pages(this.route)},_.options.app.pages(Z[X].route,{toolbarItem:se,closed:!0}))}Z[X].onclick&&(se.onclick=Z[X].onclick.bind(Z[X],S,_,se)),Q.appendChild(se)}_.refresh()},_.open=function(){te.classList.add("jtoolbar-arrow-selected"),ee.getBoundingClientRect().bottom>window.innerHeight?ee.style.bottom="0":ee.style.removeProperty("bottom"),ee.style.right="0",te.children[0].focus(),T.tracking(_,!0)},_.close=function(){te.classList.remove("jtoolbar-arrow-selected"),T.tracking(_,!1)},_.refresh=function(){if(1==_.options.responsive){for(te.remove();ee.firstChild;)Q.appendChild(ee.firstChild);var X=S.parentNode.getBoundingClientRect().width;if(X<Q.offsetWidth)for(X-=50;Q.lastChild&&X<Q.offsetWidth;)ee.insertBefore(Q.lastChild,ee.firstChild);ee.children.length>0&&Q.appendChild(te)}},S.onclick=function(Z){var X=T.findElement(Z.target,"jtoolbar-item");X&&_.selectItem(X),Z.target.classList.contains("jtoolbar-arrow")&&_.open()},window.addEventListener("resize",function(){_.refresh()}),S.classList.add("jtoolbar"),S.innerHTML="",1==_.options.container&&S.classList.add("jtoolbar-container");var Q=document.createElement("div");return S.appendChild(Q),_.options.app&&S.classList.add("jtoolbar-mobile"),_.create(_.options.items),S.toolbar=_,_},T.validations=function(S,V){return"function"==typeof T.validations[V.type]?T.validations[V.type](S,V):null},T.validations.email=function(S){var V=new RegExp(/^[^\s@]+@[^\s@]+\.[^\s@]+$/);return!(!S||!V.test(S))},T.validations.required=function(S){return!!S.trim()},T.validations.number=function(S){return T.isNumber(S)},T.validations.login=function(S){var V=new RegExp(/^[a-zA-Z0-9\_\-\.\s+]+$/);return!(!S||!V.test(S))};var O=function(S,V){return"="===V.constraint?S===V.reference:"<"===V.constraint?S<V.reference:"<="===V.constraint?S<=V.reference:">"===V.constraint?S>V.reference:">="===V.constraint?S>=V.reference:"between"===V.constraint?S>=V.reference[0]&&S<=V.reference[1]:"not between"===V.constraint?S<V.reference[0]||S>V.reference[1]:null};return T.validations.number=function(S,V){return!!T.isNumeric(S)&&(void 0===V||void 0===V.constraint||O(S,V))},T.validations.date=function(S,V){return"Invalid Date"!=new Date(S)&&(void 0===V||void 0===V.constraint||("object"==typeof V?(S=new Date(S).getTime(),V.reference=Array.isArray(V.reference)?V.reference.map(function(_){return new Date(_).getTime()}):new Date(V.reference).getTime(),O(S,V)):null))},T.validations.itemList=function(S,V){return V.reference.some(function(_){return _==S})},T.validations.text=function(S,V){return"string"==typeof S&&(void 0===V||void 0===V.constraint||("="===V.constraint?S===V.reference:"contains"===V.constraint?S.includes(V.reference):"not contain"===V.constraint?!S.includes(V.reference):"email"===V.constraint?T.validations.email(S):"url"===V.constraint?!!new RegExp(/(((https?:\/\/)|(www\.))[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|]+)/gi).test(S):null))},T.validations.constraints=function(){},T},"object"==typeof L&&void 0!==M?M.exports=O():"function"==typeof define&&define.amd?define(O):this.jSuites=O()},{}],3:[function(require,module,exports){if(!formula&&"function"==typeof require)var formula=require("@jspreadsheet/formula");if(!jSuites&&"function"==typeof require)var jSuites=require("jsuites");var j,M;j=this,M=function(){"use strict";var Version=(j={title:"Jspreadsheet",version:"4.9.5",type:"CE",host:"https://bossanova.uk/jspreadsheet",license:"MIT",print:function(){return[this.title+" "+this.type+" "+this.version,this.host,this.license].join("\r\n")}},function(){return j}),isFormula=function(j){var M=(""+j)[0];return"="==M||"#"==M},getMask=function(j){if(j.format||j.mask||j.locale){var M={};return j.mask?M.mask=j.mask:j.format?M.mask=j.format:(M.locale=j.locale,M.options=j.options),j.decimal&&(M.options||(M.options={}),M.options={decimal:j.decimal}),M}return null},jexcel=function(el,options){var obj={options:{}};if(!(el instanceof Element||el instanceof HTMLDocument))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;if("TABLE"==el.tagName){if(!(options=jexcel.createFromTable(el,options)))return console.error("Jspreadsheet: el is not a valid DOM element"),!1;var div=document.createElement("div");el.parentNode.insertBefore(div,el),el.remove(),el=div}var defaults={url:null,method:"GET",requestVariables:null,data:null,sorting:null,copyCompatibility:!1,root:null,rows:[],columns:[],colHeaders:[],colWidths:[],colAlignments:[],nestedHeaders:null,defaultColWidth:50,defaultColAlign:"center",defaultRowHeight:null,minSpareRows:0,minSpareCols:0,minDimensions:[0,0],allowExport:!0,includeHeadersOnDownload:!1,includeHeadersOnCopy:!1,columnSorting:!0,columnDrag:!1,columnResize:!0,rowResize:!1,rowDrag:!0,editable:!0,allowInsertRow:!0,allowManualInsertRow:!0,allowInsertColumn:!0,allowManualInsertColumn:!0,allowDeleteRow:!0,allowDeletingAllRows:!1,allowDeleteColumn:!0,allowRenameColumn:!0,allowComments:!1,wordWrap:!1,imageOptions:null,csv:null,csvFileName:"jspreadsheet",csvHeaders:!0,csvDelimiter:",",parseTableFirstRowAsHeader:!1,parseTableAutoCellType:!1,selectionCopy:!0,mergeCells:{},toolbar:null,search:!1,pagination:!1,paginationOptions:null,fullscreen:!1,lazyLoading:!1,loadingSpin:!1,tableOverflow:!1,tableHeight:"300px",tableWidth:null,textOverflow:!1,meta:null,style:null,classes:null,parseFormulas:!0,autoIncrement:!0,autoCasting:!0,secureFormulas:!0,stripHTML:!0,stripHTMLOnCopy:!1,filters:!1,footers:null,onundo:null,onredo:null,onload:null,onchange:null,oncomments:null,onbeforechange:null,onafterchanges:null,onbeforeinsertrow:null,oninsertrow:null,onbeforeinsertcolumn:null,oninsertcolumn:null,onbeforedeleterow:null,ondeleterow:null,onbeforedeletecolumn:null,ondeletecolumn:null,onmoverow:null,onmovecolumn:null,onresizerow:null,onresizecolumn:null,onsort:null,onselection:null,oncopy:null,onpaste:null,onbeforepaste:null,onmerge:null,onfocus:null,onblur:null,onchangeheader:null,oncreateeditor:null,oneditionstart:null,oneditionend:null,onchangestyle:null,onchangemeta:null,onchangepage:null,onbeforesave:null,onsave:null,onevent:null,persistance:!1,updateTable:null,detachForUpdates:!1,freezeColumns:null,text:{noRecordsFound:"No records found",showingPage:"Showing page {0} of {1} entries",show:"Show ",search:"Search",entries:" entries",columnName:"Column name",insertANewColumnBefore:"Insert a new column before",insertANewColumnAfter:"Insert a new column after",deleteSelectedColumns:"Delete selected columns",renameThisColumn:"Rename this column",orderAscending:"Order ascending",orderDescending:"Order descending",insertANewRowBefore:"Insert a new row before",insertANewRowAfter:"Insert a new row after",deleteSelectedRows:"Delete selected rows",editComments:"Edit comments",addComments:"Add comments",comments:"Comments",clearComments:"Clear comments",copy:"Copy...",paste:"Paste...",saveAs:"Save as...",about:"About",areYouSureToDeleteTheSelectedRows:"Are you sure to delete the selected rows?",areYouSureToDeleteTheSelectedColumns:"Are you sure to delete the selected columns?",thisActionWillDestroyAnyExistingMergedCellsAreYouSure:"This action will destroy any existing merged cells. Are you sure?",thisActionWillClearYourSearchResultsAreYouSure:"This action will clear your search results. Are you sure?",thereIsAConflictWithAnotherMergedCell:"There is a conflict with another merged cell",invalidMergeProperties:"Invalid merged properties",cellAlreadyMerged:"Cell already merged",noCellsSelected:"No cells selected"},about:!0};for(var property in defaults)if(options&&options.hasOwnProperty(property))if("text"===property)for(var textKey in obj.options[property]=defaults[property],options[property])options[property].hasOwnProperty(textKey)&&(obj.options[property][textKey]=options[property][textKey]);else obj.options[property]=options[property];else obj.options[property]=defaults[property];obj.el=el,obj.corner=null,obj.contextMenu=null,obj.textarea=null,obj.ads=null,obj.content=null,obj.table=null,obj.thead=null,obj.tbody=null,obj.rows=[],obj.results=null,obj.searchInput=null,obj.toolbar=null,obj.pagination=null,obj.pageNumber=null,obj.headerContainer=null,obj.colgroupContainer=null,obj.headers=[],obj.records=[],obj.history=[],obj.formula=[],obj.colgroup=[],obj.selection=[],obj.highlighted=[],obj.selectedCell=null,obj.selectedContainer=null,obj.style=[],obj.data=null,obj.filter=null,obj.filters=[],obj.cursor=null,obj.historyIndex=-1,obj.ignoreEvents=!1,obj.ignoreHistory=!1,obj.edition=null,obj.hashString=null,obj.resizing=null,obj.dragging=null,1==obj.options.lazyLoading&&0==obj.options.tableOverflow&&0==obj.options.fullscreen&&(console.error("Jspreadsheet: The lazyloading only works when tableOverflow = yes or fullscreen = yes"),obj.options.lazyLoading=!1),obj.fullscreen=function(j){null==j&&(j=!obj.options.fullscreen),obj.options.fullscreen!=j&&(obj.options.fullscreen=j,1==j?el.classList.add("fullscreen"):el.classList.remove("fullscreen"))},obj.dispatch=function(j){if(!obj.ignoreEvents){if("function"==typeof obj.options.onevent)var M=obj.options.onevent.apply(this,arguments);"function"==typeof obj.options[j]&&(M=obj.options[j].apply(this,Array.prototype.slice.call(arguments,1)))}if("onafterchanges"==j&&obj.options.persistance){var L=1==obj.options.persistance?obj.options.url:obj.options.persistance,T=obj.prepareJson(arguments[2]);obj.save(L,T)}return M},obj.prepareTable=function(){var M=obj.options.columns.length;if(obj.options.data&&void 0!==obj.options.data[0]){var L=Object.keys(obj.options.data[0]);L.length>M&&(M=L.length)}obj.options.minDimensions[0]>M&&(M=obj.options.minDimensions[0]);for(var T=[],O=0;O<M;O++)obj.options.colHeaders[O]||(obj.options.colHeaders[O]=""),obj.options.colWidths[O]||(obj.options.colWidths[O]=obj.options.defaultColWidth),obj.options.colAlignments[O]||(obj.options.colAlignments[O]=obj.options.defaultColAlign),obj.options.columns[O]?obj.options.columns[O].type||(obj.options.columns[O].type="text"):obj.options.columns[O]={type:"text"},obj.options.columns[O].name||(obj.options.columns[O].name=L&&L[O]?L[O]:O),obj.options.columns[O].source||(obj.options.columns[O].source=[]),obj.options.columns[O].options||(obj.options.columns[O].options=[]),obj.options.columns[O].editor||(obj.options.columns[O].editor=null),obj.options.columns[O].allowEmpty||(obj.options.columns[O].allowEmpty=!1),obj.options.columns[O].title||(obj.options.columns[O].title=obj.options.colHeaders[O]?obj.options.colHeaders[O]:""),obj.options.columns[O].width||(obj.options.columns[O].width=obj.options.colWidths[O]?obj.options.colWidths[O]:obj.options.defaultColWidth),obj.options.columns[O].align||(obj.options.columns[O].align=obj.options.colAlignments[O]?obj.options.colAlignments[O]:"center"),"autocomplete"==obj.options.columns[O].type||"dropdown"==obj.options.columns[O].type?obj.options.columns[O].url&&T.push({url:obj.options.columns[O].url,index:O,method:"GET",dataType:"json",success:function(S){for(var _=0;_<S.length;_++)obj.options.columns[this.index].source.push(S[_])}}):"calendar"==obj.options.columns[O].type&&(obj.options.columns[O].options.format||(obj.options.columns[O].options.format="DD/MM/YYYY"));T.length?jSuites.ajax(T,function(){obj.createTable()}):obj.createTable()},obj.createTable=function(){obj.table=document.createElement("table"),obj.thead=document.createElement("thead"),obj.tbody=document.createElement("tbody"),obj.headers=[],obj.colgroup=[],obj.content=document.createElement("div"),obj.content.classList.add("jexcel_content"),obj.content.onscroll=function(me){obj.scrollControls(me)},obj.content.onwheel=function(me){obj.wheelControls(me)},obj.toolbar=document.createElement("div"),obj.toolbar.classList.add("jexcel_toolbar");var j=document.createElement("div"),M=document.createTextNode(obj.options.text.search+": ");obj.searchInput=document.createElement("input"),obj.searchInput.classList.add("jexcel_search"),j.appendChild(M),j.appendChild(obj.searchInput),obj.searchInput.onfocus=function(){obj.resetSelection()};var L=document.createElement("div");if(obj.options.pagination>0&&obj.options.paginationOptions&&obj.options.paginationOptions.length>0){obj.paginationDropdown=document.createElement("select"),obj.paginationDropdown.classList.add("jexcel_pagination_dropdown"),obj.paginationDropdown.onchange=function(){obj.options.pagination=parseInt(this.value),obj.page(0)};for(var T=0;T<obj.options.paginationOptions.length;T++){var O=document.createElement("option");O.value=obj.options.paginationOptions[T],O.innerHTML=obj.options.paginationOptions[T],obj.paginationDropdown.appendChild(O)}obj.paginationDropdown.value=obj.options.pagination,L.appendChild(document.createTextNode(obj.options.text.show)),L.appendChild(obj.paginationDropdown),L.appendChild(document.createTextNode(obj.options.text.entries))}var V,S=document.createElement("div");if(S.classList.add("jexcel_filter"),S.appendChild(L),S.appendChild(j),obj.colgroupContainer=document.createElement("colgroup"),(V=document.createElement("col")).setAttribute("width","50"),obj.colgroupContainer.appendChild(V),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var _=0;_<obj.options.nestedHeaders.length;_++)obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders[_]));else obj.thead.appendChild(obj.createNestedHeader(obj.options.nestedHeaders));for(obj.headerContainer=document.createElement("tr"),(V=document.createElement("td")).classList.add("jexcel_selectall"),obj.headerContainer.appendChild(V),T=0;T<obj.options.columns.length;T++)obj.createCellHeader(T),obj.headerContainer.appendChild(obj.headers[T]),obj.colgroupContainer.appendChild(obj.colgroup[T]);if(obj.thead.appendChild(obj.headerContainer),1==obj.options.filters){obj.filter=document.createElement("tr");var z=document.createElement("td");for(obj.filter.appendChild(z),T=0;T<obj.options.columns.length;T++)(z=document.createElement("td")).innerHTML="&nbsp;",z.setAttribute("data-x",T),z.className="jexcel_column_filter","hidden"==obj.options.columns[T].type&&(z.style.display="none"),obj.filter.appendChild(z);obj.thead.appendChild(obj.filter)}obj.table=document.createElement("table"),obj.table.classList.add("jexcel"),obj.table.setAttribute("cellpadding","0"),obj.table.setAttribute("cellspacing","0"),obj.table.setAttribute("unselectable","yes"),obj.table.appendChild(obj.colgroupContainer),obj.table.appendChild(obj.thead),obj.table.appendChild(obj.tbody),obj.options.textOverflow||obj.table.classList.add("jexcel_overflow"),obj.corner=document.createElement("div"),obj.corner.className="jexcel_corner",obj.corner.setAttribute("unselectable","on"),obj.corner.setAttribute("onselectstart","return false"),0==obj.options.selectionCopy&&(obj.corner.style.display="none"),obj.textarea=document.createElement("textarea"),obj.textarea.className="jexcel_textarea",obj.textarea.id="jexcel_textarea",obj.textarea.tabIndex="-1",obj.contextMenu=document.createElement("div"),obj.contextMenu.className="jexcel_contextmenu",jSuites.contextmenu(obj.contextMenu,{onclick:function(){obj.contextMenu.contextmenu.close(!1)}});var W=document.createElement("a");W.setAttribute("href","https://bossanova.uk/jspreadsheet/"),obj.ads=document.createElement("div"),obj.ads.className="jexcel_about";try{if("undefined"!=typeof sessionStorage&&!sessionStorage.getItem("jexcel")){sessionStorage.setItem("jexcel",!0);var te=document.createElement("img");te.src="//bossanova.uk/jspreadsheet/logo.png",W.appendChild(te)}}catch(me){}var ee=document.createElement("span");ee.innerHTML="Jspreadsheet CE",W.appendChild(ee),obj.ads.appendChild(W),document.createElement("div").classList.add("jexcel_table"),obj.pagination=document.createElement("div"),obj.pagination.classList.add("jexcel_pagination");var Z=document.createElement("div"),X=document.createElement("div");if(obj.pagination.appendChild(Z),obj.pagination.appendChild(X),obj.options.pagination||(obj.pagination.style.display="none"),1==obj.options.search&&el.appendChild(S),obj.content.appendChild(obj.table),obj.content.appendChild(obj.corner),obj.content.appendChild(obj.textarea),el.appendChild(obj.toolbar),el.appendChild(obj.content),el.appendChild(obj.pagination),el.appendChild(obj.contextMenu),el.appendChild(obj.ads),el.classList.add("jexcel_container"),obj.options.toolbar&&obj.options.toolbar.length&&obj.createToolbar(),1==obj.options.fullscreen?el.classList.add("fullscreen"):1==obj.options.tableOverflow&&(obj.options.tableHeight&&(obj.content.style["overflow-y"]="auto",obj.content.style["box-shadow"]="rgb(221 221 221) 2px 2px 5px 0.1px",obj.content.style.maxHeight=obj.options.tableHeight),obj.options.tableWidth&&(obj.content.style["overflow-x"]="auto",obj.content.style.width=obj.options.tableWidth)),1!=obj.options.tableOverflow&&obj.options.toolbar&&el.classList.add("with-toolbar"),1==obj.options.columnDrag&&obj.thead.classList.add("draggable"),1==obj.options.columnResize&&obj.thead.classList.add("resizable"),1==obj.options.rowDrag&&obj.tbody.classList.add("draggable"),1==obj.options.rowResize&&obj.tbody.classList.add("resizable"),obj.setData(),obj.options.style&&obj.setStyle(obj.options.style,null,null,1,1),obj.options.classes){var se=Object.keys(obj.options.classes);for(T=0;T<se.length;T++){var oe=jexcel.getIdFromColumnName(se[T],!0);obj.records[oe[1]][oe[0]].classList.add(obj.options.classes[se[T]])}}},obj.refresh=function(){obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(j){obj.options.data=j.data?j.data:j,obj.setData(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.setData()},obj.setData=function(j){if(j&&("string"==typeof j&&(j=JSON.parse(j)),obj.options.data=j),obj.options.data||(obj.options.data=[]),obj.options.data&&obj.options.data[0]&&!Array.isArray(obj.options.data[0])){j=[];for(var L=0;L<obj.options.data.length;L++){for(var M=[],T=0;T<obj.options.columns.length;T++)M[T]=obj.options.data[L][obj.options.columns[T].name];j.push(M)}obj.options.data=j}L=0,T=0;var O=obj.options.columns.length,S=obj.options.data.length,V=obj.options.minDimensions[0],_=obj.options.minDimensions[1],z=V>O?V:O,W=_>S?_:S;for(L=0;L<W;L++)for(T=0;T<z;T++)null==obj.options.data[L]&&(obj.options.data[L]=[]),null==obj.options.data[L][T]&&(obj.options.data[L][T]="");if(obj.rows=[],obj.results=null,obj.records=[],obj.history=[],obj.historyIndex=-1,obj.tbody.innerHTML="",1==obj.options.lazyLoading){var te=0,ee=obj.options.data.length<100?obj.options.data.length:100;obj.options.pagination&&(obj.options.pagination=!1,console.error("Jspreadsheet: Pagination will be disable due the lazyLoading"))}else obj.options.pagination?(obj.pageNumber||(obj.pageNumber=0),te=obj.options.pagination*obj.pageNumber,obj.options.data.length<(ee=obj.options.pagination*obj.pageNumber+obj.options.pagination)&&(ee=obj.options.data.length)):(te=0,ee=obj.options.data.length);for(L=0;L<obj.options.data.length;L++){var Z=obj.createRow(L,obj.options.data[L]);L>=te&&L<ee&&obj.tbody.appendChild(Z)}if(1==obj.options.lazyLoading||obj.options.pagination&&obj.updatePagination(),obj.options.mergeCells){var X=Object.keys(obj.options.mergeCells);for(T=0;T<X.length;T++){var se=obj.options.mergeCells[X[T]];obj.setMerge(X[T],se[0],se[1],1)}}obj.updateTable(),obj.dispatch("onload",el,obj)},obj.getData=function(j,M){for(var L=[],T=0,O=0,S=1==M||0==obj.options.copyCompatibility,V=obj.options.columns.length,_=obj.options.data.length,z=0;z<_;z++){T=0;for(var W=0;W<V;W++)(!j||obj.records[z][W].classList.contains("highlight"))&&(L[O]||(L[O]=[]),L[O][T]=S?obj.options.data[z][W]:obj.records[z][W].innerHTML,T++);T>0&&O++}return L},obj.getJsonRow=function(j){for(var M=obj.options.data[j],L=obj.options.columns.length,T={},O=0;O<L;O++)obj.options.columns[O].name||(obj.options.columns[O].name=O),T[obj.options.columns[O].name]=M[O];return T},obj.getJson=function(j){for(var M=[],L=obj.options.columns.length,T=obj.options.data.length,O=0;O<T;O++){for(var S=null,V=0;V<L;V++)(!j||obj.records[O][V].classList.contains("highlight"))&&(null==S&&(S={}),obj.options.columns[V].name||(obj.options.columns[V].name=V),S[obj.options.columns[V].name]=obj.options.data[O][V]);null!=S&&M.push(S)}return M},obj.prepareJson=function(j){for(var M=[],L=0;L<j.length;L++){var T=j[L].x,O=j[L].y,S=obj.options.columns[T].name?obj.options.columns[T].name:T;M[O]||(M[O]={row:O,data:{}}),M[O].data[S]=j[L].newValue}return M.filter(function(V){return null!=V})},obj.save=function(j,M){var L=obj.dispatch("onbeforesave",el,obj,M);if(L)M=L;else if(!1===L)return!1;jSuites.ajax({url:j,method:"POST",dataType:"json",data:{data:JSON.stringify(M)},success:function(T){obj.dispatch("onsave",el,obj,M)}})},obj.getRowData=function(j){return obj.options.data[j]},obj.setRowData=function(j,M){for(var L=0;L<obj.headers.length;L++){var T=jexcel.getColumnNameFromId([L,j]);null!=M[L]&&obj.setValue(T,M[L])}},obj.getColumnData=function(j){for(var M=[],L=0;L<obj.options.data.length;L++)M.push(obj.options.data[L][j]);return M},obj.setColumnData=function(j,M){for(var L=0;L<obj.rows.length;L++){var T=jexcel.getColumnNameFromId([j,L]);null!=M[L]&&obj.setValue(T,M[L])}},obj.createRow=function(j,M){obj.records[j]||(obj.records[j]=[]),M||(M=obj.options.data[j]),obj.rows[j]=document.createElement("tr"),obj.rows[j].setAttribute("data-y",j);var L=null;obj.options.defaultRowHeight&&(obj.rows[j].style.height=obj.options.defaultRowHeight+"px"),obj.options.rows[j]&&(obj.options.rows[j].height&&(obj.rows[j].style.height=obj.options.rows[j].height),obj.options.rows[j].title&&(L=obj.options.rows[j].title)),L||(L=parseInt(j+1));var T=document.createElement("td");T.innerHTML=L,T.setAttribute("data-y",j),T.className="jexcel_row",obj.rows[j].appendChild(T);for(var O=0;O<obj.options.columns.length;O++)obj.records[j][O]=obj.createCell(O,j,M[O]),obj.rows[j].appendChild(obj.records[j][O]);return obj.rows[j]},obj.parseValue=function(j,M,L,T){"="==(""+L).substr(0,1)&&1==obj.options.parseFormulas&&(L=obj.executeFormula(L,j,M));var O=obj.options.columns[j];if(O&&!isFormula(L)){var S=null;if(S=getMask(O)){L&&L==Number(L)&&(L=Number(L));var V=jSuites.mask.render(L,S,!0);if(T&&S.mask){var _=S.mask.split(";");_[1]&&(_[1].match(new RegExp("\\[Red\\]","gi"))&&(L<0?T.classList.add("red"):T.classList.remove("red")),_[1].match(new RegExp("\\(","gi"))&&L<0&&(V="("+V+")"))}V&&(L=V)}}return L},obj.createCell=function(j,M,L){var T=document.createElement("td");if(T.setAttribute("data-x",j),T.setAttribute("data-y",M),"="==(""+L).substr(0,1)&&1==obj.options.secureFormulas){var O=secureFormula(L);O!=L&&(L=O)}if(obj.options.columns[j].editor)!1===obj.options.stripHTML||!1===obj.options.columns[j].stripHTML?T.innerHTML=L:T.innerText=L,"function"==typeof obj.options.columns[j].editor.createCell&&(T=obj.options.columns[j].editor.createCell(T));else if("hidden"==obj.options.columns[j].type)T.style.display="none",T.innerText=L;else if("checkbox"==obj.options.columns[j].type||"radio"==obj.options.columns[j].type){var S=document.createElement("input");S.type=obj.options.columns[j].type,S.name="c"+j,S.checked=1==L||1==L||"true"==L,S.onclick=function(){obj.setValue(T,this.checked)},(1==obj.options.columns[j].readOnly||0==obj.options.editable)&&S.setAttribute("disabled","disabled"),T.appendChild(S),obj.options.data[M][j]=S.checked}else if("calendar"==obj.options.columns[j].type){var V=jSuites.calendar.extractDateFromString(L,obj.options.columns[j].options.format);T.innerText=jSuites.calendar.getDateString(V||L,obj.options.columns[j].options.format)}else if("dropdown"==obj.options.columns[j].type||"autocomplete"==obj.options.columns[j].type)T.classList.add("jexcel_dropdown"),T.innerText=obj.getDropDownValue(j,L);else if("color"==obj.options.columns[j].type)if("square"==obj.options.columns[j].render){var _=document.createElement("div");_.className="color",_.style.backgroundColor=L,T.appendChild(_)}else T.style.color=L,T.innerText=L;else if("image"==obj.options.columns[j].type){if(L&&"data:image"==L.substr(0,10)){var z=document.createElement("img");z.src=L,T.appendChild(z)}}else"html"==obj.options.columns[j].type||!1===obj.options.stripHTML||!1===obj.options.columns[j].stripHTML?T.innerHTML=stripScript(obj.parseValue(j,M,L,T)):T.innerText=obj.parseValue(j,M,L,T);return 1==obj.options.columns[j].readOnly&&(T.className="readonly"),T.style.textAlign=obj.options.columns[j].align?obj.options.columns[j].align:"center",0!=obj.options.columns[j].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[j].wordWrap||T.innerHTML.length>200)&&(T.style.whiteSpace="pre-wrap"),j>0&&1==this.options.textOverflow&&(L||T.innerHTML?obj.records[M][j-1].style.overflow="hidden":j==obj.options.columns.length-1&&(T.style.overflow="hidden")),T},obj.createCellHeader=function(j){var M=obj.options.columns[j].width?obj.options.columns[j].width:obj.options.defaultColWidth,L=obj.options.columns[j].align?obj.options.columns[j].align:obj.options.defaultColAlign;obj.headers[j]=document.createElement("td"),obj.options.stripHTML?obj.headers[j].innerText=obj.options.columns[j].title?obj.options.columns[j].title:jexcel.getColumnName(j):obj.headers[j].innerHTML=obj.options.columns[j].title?obj.options.columns[j].title:jexcel.getColumnName(j),obj.headers[j].setAttribute("data-x",j),obj.headers[j].style.textAlign=L,obj.options.columns[j].title&&obj.headers[j].setAttribute("title",obj.options.columns[j].title),obj.options.columns[j].id&&obj.headers[j].setAttribute("id",obj.options.columns[j].id),obj.colgroup[j]=document.createElement("col"),obj.colgroup[j].setAttribute("width",M),"hidden"==obj.options.columns[j].type&&(obj.headers[j].style.display="none",obj.colgroup[j].style.display="none")},obj.updateNestedHeader=function(j,M,L){obj.options.nestedHeaders[M][j].title&&(obj.options.nestedHeaders[M][j].title=L,obj.options.nestedHeaders[M].element.children[j+1].innerText=L)},obj.createNestedHeader=function(j){var M=document.createElement("tr");M.classList.add("jexcel_nested");var L=document.createElement("td");M.appendChild(L),j.element=M;for(var T=0,O=0;O<j.length;O++){j[O].colspan||(j[O].colspan=1),j[O].align||(j[O].align="center"),j[O].title||(j[O].title="");for(var S=j[O].colspan,V=[],_=0;_<S;_++)obj.options.columns[T]&&"hidden"==obj.options.columns[T].type&&S++,V.push(T),T++;(L=document.createElement("td")).setAttribute("data-column",V.join(",")),L.setAttribute("colspan",j[O].colspan),L.setAttribute("align",j[O].align),L.innerText=j[O].title,M.appendChild(L)}return M},obj.createToolbar=function(j){j?obj.options.toolbar=j:j=obj.options.toolbar;for(var M=0;M<j.length;M++)if("i"==j[M].type)(L=document.createElement("i")).classList.add("jexcel_toolbar_item"),L.classList.add("material-icons"),L.setAttribute("data-k",j[M].k),L.setAttribute("data-v",j[M].v),L.setAttribute("id",j[M].id),j[M].tooltip&&L.setAttribute("title",j[M].tooltip),L.onclick=j[M].onclick?function(S){var V=S;return function(){j[V].onclick(el,obj,this)}}(M):function(){var S=this.getAttribute("data-k"),V=this.getAttribute("data-v");obj.setStyle(obj.highlighted,S,V)},L.innerText=j[M].content,obj.toolbar.appendChild(L);else if("select"==j[M].type){(L=document.createElement("select")).classList.add("jexcel_toolbar_item"),L.setAttribute("data-k",j[M].k),j[M].tooltip&&L.setAttribute("title",j[M].tooltip),L.onchange=j[M].onchange?j[M].onchange:function(){var V=this.getAttribute("data-k");obj.setStyle(obj.highlighted,V,this.value)};for(var T=0;T<j[M].v.length;T++){var O=document.createElement("option");O.value=j[M].v[T],O.innerText=j[M].v[T],L.appendChild(O)}obj.toolbar.appendChild(L)}else if("color"==j[M].type){var L;(L=document.createElement("i")).classList.add("jexcel_toolbar_item"),L.classList.add("material-icons"),L.setAttribute("data-k",j[M].k),L.setAttribute("data-v",""),j[M].tooltip&&L.setAttribute("title",j[M].tooltip),obj.toolbar.appendChild(L),L.innerText=j[M].content,jSuites.color(L,{onchange:function(V,_){var z=V.getAttribute("data-k");obj.setStyle(obj.highlighted,z,_)}})}},obj.setMerge=function(j,M,L,T){var O=!1;if(!j){if(!obj.highlighted.length)return alert(obj.options.text.noCellsSelected),null;var S=parseInt(obj.highlighted[0].getAttribute("data-x")),V=parseInt(obj.highlighted[0].getAttribute("data-y")),_=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-x")),z=parseInt(obj.highlighted[obj.highlighted.length-1].getAttribute("data-y"));j=jexcel.getColumnNameFromId([S,V]),M=_-S+1,L=z-V+1}var W=jexcel.getIdFromColumnName(j,!0);if(obj.options.mergeCells[j])obj.records[W[1]][W[0]].getAttribute("data-merged")&&(O=obj.options.text.cellAlreadyMerged);else if((!M||M<2)&&(!L||L<2))O=obj.options.text.invalidMergeProperties;else for(var ee=W[1];ee<W[1]+L;ee++)for(var Q=W[0];Q<W[0]+M;Q++)jexcel.getColumnNameFromId([Q,ee]),obj.records[ee][Q].getAttribute("data-merged")&&(O=obj.options.text.thereIsAConflictWithAnotherMergedCell);if(O)alert(O);else{M>1?obj.records[W[1]][W[0]].setAttribute("colspan",M):M=1,L>1?obj.records[W[1]][W[0]].setAttribute("rowspan",L):L=1,obj.options.mergeCells[j]=[M,L,[]],obj.records[W[1]][W[0]].setAttribute("data-merged","true"),obj.records[W[1]][W[0]].style.overflow="hidden";for(var X=[],se=W[1];se<W[1]+L;se++)for(var oe=W[0];oe<W[0]+M;oe++)W[0]==oe&&W[1]==se||(X.push(obj.options.data[se][oe]),obj.updateCell(oe,se,"",!0),obj.options.mergeCells[j][2].push(obj.records[se][oe]),obj.records[se][oe].style.display="none",obj.records[se][oe]=obj.records[W[1]][W[0]]);obj.updateSelection(obj.records[W[1]][W[0]]),T||(obj.setHistory({action:"setMerge",column:j,colspan:M,rowspan:L,data:X}),obj.dispatch("onmerge",el,j,M,L))}},obj.getMerge=function(j){var M={};if(j)M=obj.options.mergeCells[j]?[obj.options.mergeCells[j][0],obj.options.mergeCells[j][1]]:null;else if(obj.options.mergeCells)for(var T=Object.keys(obj.options.mergeCells),O=0;O<T.length;O++)M[T[O]]=[obj.options.mergeCells[T[O]][0],obj.options.mergeCells[T[O]][1]];return M},obj.removeMerge=function(j,M,L){if(obj.options.mergeCells[j]){var T=jexcel.getIdFromColumnName(j,!0);obj.records[T[1]][T[0]].removeAttribute("colspan"),obj.records[T[1]][T[0]].removeAttribute("rowspan"),obj.records[T[1]][T[0]].removeAttribute("data-merged");for(var O=obj.options.mergeCells[j],S=0,V=0;V<O[1];V++)for(var _=0;_<O[0];_++)(V>0||_>0)&&(obj.records[T[1]+V][T[0]+_]=O[2][S],obj.records[T[1]+V][T[0]+_].style.display="",M&&M[S]&&obj.updateCell(T[0]+_,T[1]+V,M[S]),S++);obj.updateSelection(obj.records[T[1]][T[0]],obj.records[T[1]+V-1][T[0]+_-1]),L||delete obj.options.mergeCells[j]}},obj.destroyMerged=function(j){if(obj.options.mergeCells)for(var L=Object.keys(obj.options.mergeCells),T=0;T<L.length;T++)obj.removeMerge(L[T],null,j)},obj.isColMerged=function(j,M){var L=[];if(obj.options.mergeCells)for(var T=Object.keys(obj.options.mergeCells),O=0;O<T.length;O++){var S=jexcel.getIdFromColumnName(T[O],!0),V=obj.options.mergeCells[T[O]][0],_=S[0],z=S[0]+(V>1?V-1:0);null==M?_<=j&&z>=j&&L.push(T[O]):M?_<j&&z>=j&&L.push(T[O]):_<=j&&z>j&&L.push(T[O])}return L},obj.isRowMerged=function(j,M){var L=[];if(obj.options.mergeCells)for(var T=Object.keys(obj.options.mergeCells),O=0;O<T.length;O++){var S=jexcel.getIdFromColumnName(T[O],!0),V=obj.options.mergeCells[T[O]][1],_=S[1],z=S[1]+(V>1?V-1:0);null==M?_<=j&&z>=j&&L.push(T[O]):M?_<j&&z>=j&&L.push(T[O]):_<=j&&z>j&&L.push(T[O])}return L},obj.openFilter=function(j){if(obj.options.filters){j=parseInt(j),obj.resetSelection();var M=[];if("checkbox"==obj.options.columns[j].type)M.push({id:"true",name:"True"}),M.push({id:"false",name:"False"});else{for(var L=[],T=!1,O=0;O<obj.options.data.length;O++){var S=obj.options.data[O][j],V=obj.records[O][j].innerHTML;S&&V?L[S]=V:T=!0}var _=Object.keys(L);for(M=[],O=0;O<_.length;O++)M.push({id:_[O],name:L[_[O]]});T&&M.push({value:"",id:"",name:"(Blanks)"})}var z=document.createElement("div");obj.filter.children[j+1].innerHTML="",obj.filter.children[j+1].appendChild(z),obj.filter.children[j+1].style.paddingLeft="0px",obj.filter.children[j+1].style.paddingRight="0px",obj.filter.children[j+1].style.overflow="initial",jSuites.dropdown(z,{data:M,multiple:!0,autocomplete:!0,opened:!0,value:void 0!==obj.filters[j]?obj.filters[j]:null,width:"100%",position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(te){obj.resetFilters(),obj.filters[j]=te.dropdown.getValue(!0),obj.filter.children[j+1].innerHTML=te.dropdown.getText(),obj.filter.children[j+1].style.paddingLeft="",obj.filter.children[j+1].style.paddingRight="",obj.filter.children[j+1].style.overflow="",obj.closeFilter(j),obj.refreshSelection()}})}else console.log("Jspreadsheet: filters not enabled.")},obj.resetFilters=function(){if(obj.options.filters)for(var j=0;j<obj.filter.children.length;j++)obj.filter.children[j].innerHTML="&nbsp;",obj.filters[j]=null},obj.closeFilter=function(j){if(!j)for(var M=0;M<obj.filter.children.length;M++)obj.filters[M]&&(j=M);var L=function(S,V,_){for(var z=0;z<S.length;z++)if(""==S[z]&&(!1===obj.options.data[_][V]||""+obj.options.data[_][V]=="")||""!=S[z]&&((""+obj.options.data[_][V]).search(S[z])>=0||(""+obj.records[_][V].innerHTML).search(S[z])>=0))return!0;return!1},T=obj.filters[j];obj.results=[];for(var O=0;O<obj.options.data.length;O++)L(T,j,O)&&obj.results.push(O);obj.results.length||(obj.results=null),obj.updateResult()},obj.openEditor=function(j,M,L){var T=j.getAttribute("data-y"),O=j.getAttribute("data-x");obj.dispatch("oneditionstart",el,j,O,T),O>0&&(obj.records[T][O-1].style.overflow="hidden");var S=function(ce){var ge=j.getBoundingClientRect(),xe=document.createElement(ce);return xe.style.width=ge.width+"px",xe.style.height=ge.height-2+"px",xe.style.minHeight=ge.height-2+"px",j.classList.add("editor"),j.innerHTML="",j.appendChild(xe),obj.dispatch("oncreateeditor",el,j,O,T,xe),xe};if(1!=j.classList.contains("readonly"))if(obj.edition=[obj.records[T][O],obj.records[T][O].innerHTML,O,T],obj.options.columns[O].editor)obj.options.columns[O].editor.openEditor(j,el,M,L);else if("hidden"!=obj.options.columns[O].type)if("checkbox"==obj.options.columns[O].type||"radio"==obj.options.columns[O].type)obj.setValue(j,V=!j.children[0].checked),obj.edition=null;else if("dropdown"==obj.options.columns[O].type||"autocomplete"==obj.options.columns[O].type){var V=obj.options.data[T][O];if(obj.options.columns[O].multiple&&!Array.isArray(V)&&(V=V.split(";")),"function"==typeof obj.options.columns[O].filter)var _=obj.options.columns[O].filter(el,j,O,T,obj.options.columns[O].source);else _=obj.options.columns[O].source;for(var z=[],W=0;W<_.length;W++)z.push(_[W]);var te=S("div"),ee={data:z,multiple:!!obj.options.columns[O].multiple,autocomplete:!(!obj.options.columns[O].autocomplete&&"autocomplete"!=obj.options.columns[O].type),opened:!0,value:V,width:"100%",height:te.style.minHeight,position:1==obj.options.tableOverflow||1==obj.options.fullscreen,onclose:function(){obj.closeEditor(j,!0)}};obj.options.columns[O].options&&obj.options.columns[O].options.type&&(ee.type=obj.options.columns[O].options.type),jSuites.dropdown(te,ee)}else if("calendar"==obj.options.columns[O].type||"color"==obj.options.columns[O].type)V=obj.options.data[T][O],(te=S("input")).value=V,(1==obj.options.tableOverflow||1==obj.options.fullscreen)&&(obj.options.columns[O].options.position=!0),obj.options.columns[O].options.value=obj.options.data[T][O],obj.options.columns[O].options.opened=!0,obj.options.columns[O].options.onclose=function(xe,Ee){obj.closeEditor(j,!0)},"color"==obj.options.columns[O].type?jSuites.color(te,obj.options.columns[O].options):jSuites.calendar(te,obj.options.columns[O].options),te.focus();else if("html"==obj.options.columns[O].type){V=obj.options.data[T][O],(te=S("div")).style.position="relative",(Q=document.createElement("div")).classList.add("jexcel_richtext"),te.appendChild(Q),jSuites.editor(Q,{focus:!0,value:V});var Z=j.getBoundingClientRect(),X=Q.getBoundingClientRect();Q.style.top=window.innerHeight<Z.bottom+X.height?Z.top-(X.height+2)+"px":Z.top+"px"}else if("image"==obj.options.columns[O].type){var Q,se=j.children[0];(te=S("div")).style.position="relative",(Q=document.createElement("div")).classList.add("jclose"),se&&se.src&&Q.appendChild(se),te.appendChild(Q),jSuites.image(Q,obj.options.imageOptions),Z=j.getBoundingClientRect(),X=Q.getBoundingClientRect(),Q.style.top=window.innerHeight<Z.bottom+X.height?Z.top-(X.height+2)+"px":Z.top+"px"}else{if(V=1==M?"":obj.options.data[T][O],0==obj.options.columns[O].wordWrap||1!=obj.options.wordWrap&&1!=obj.options.columns[O].wordWrap)te=S("input");else te=S("textarea");te.focus(),te.value=V,ee=obj.options.columns[O];var oe=null;if(!isFormula(V)&&(oe=getMask(ee))){if(!ee.disabledMaskOnEdition)if(ee.mask){var me=ee.mask.split(";");te.setAttribute("data-mask",me[0])}else ee.locale&&te.setAttribute("data-locale",ee.locale);oe.input=te,te.mask=oe,jSuites.mask.render(V,oe,!1)}te.onblur=function(){obj.closeEditor(j,!0)},te.scrollLeft=te.scrollWidth}},obj.closeEditor=function(j,M){var L=parseInt(j.getAttribute("data-x")),T=parseInt(j.getAttribute("data-y"));if(1==M){if(obj.options.columns[L].editor)var O=obj.options.columns[L].editor.closeEditor(j,M);else if("checkbox"!=obj.options.columns[L].type&&"radio"!=obj.options.columns[L].type&&"hidden"!=obj.options.columns[L].type)if("dropdown"==obj.options.columns[L].type||"autocomplete"==obj.options.columns[L].type)O=j.children[0].dropdown.close(!0);else if("calendar"==obj.options.columns[L].type)O=j.children[0].calendar.close(!0);else if("color"==obj.options.columns[L].type)O=j.children[0].color.close(!0);else if("html"==obj.options.columns[L].type)O=j.children[0].children[0].editor.getData();else if("image"==obj.options.columns[L].type){var S=j.children[0].children[0].children[0];O=S&&"IMG"==S.tagName?S.src:""}else if("numeric"==obj.options.columns[L].type)"="!=(""+(O=j.children[0].value)).substr(0,1)&&""==O&&(O=obj.options.columns[L].allowEmpty?"":0),j.children[0].onblur=null;else{var _;if(O=j.children[0].value,j.children[0].onblur=null,(_=getMask(obj.options.columns[L]))&&""!==O&&!isFormula(O)&&"number"!=typeof O){var z=jSuites.mask.extract(O,_,!0);z&&""!==z.value&&(O=z.value)}}obj.options.data[T][L]==O?j.innerHTML=obj.edition[1]:obj.setValue(j,O)}else obj.options.columns[L].editor?obj.options.columns[L].editor.closeEditor(j,M):"dropdown"==obj.options.columns[L].type||"autocomplete"==obj.options.columns[L].type?j.children[0].dropdown.close(!0):"calendar"==obj.options.columns[L].type?j.children[0].calendar.close(!0):"color"==obj.options.columns[L].type?j.children[0].color.close(!0):j.children[0].onblur=null,j.innerHTML=obj.edition&&obj.edition[1]?obj.edition[1]:"";obj.dispatch("oneditionend",el,j,L,T,O,M),j.classList.remove("editor"),obj.edition=null},obj.getCell=function(j){return j=jexcel.getIdFromColumnName(j,!0),obj.records[j[1]][j[0]]},obj.getCellFromCoords=function(j,M){return obj.records[M][j]},obj.getLabel=function(j){return j=jexcel.getIdFromColumnName(j,!0),obj.records[j[1]][j[0]].innerHTML},obj.getLabelFromCoords=function(j,M){return obj.records[M][j].innerHTML},obj.getValue=function(j,M){if("object"==typeof j)var L=j.getAttribute("data-x"),T=j.getAttribute("data-y");else L=(j=jexcel.getIdFromColumnName(j,!0))[0],T=j[1];var O=null;return null!=L&&null!=T&&(obj.records[T]&&obj.records[T][L]&&(M||1==obj.options.copyCompatibility)?O=obj.records[T][L].innerHTML:obj.options.data[T]&&"undefined"!=obj.options.data[T][L]&&(O=obj.options.data[T][L])),O},obj.getValueFromCoords=function(j,M,L){var T=null;return null!=j&&null!=M&&(obj.records[M]&&obj.records[M][j]&&L||1==obj.options.copyCompatibility?T=obj.records[M][j].innerHTML:obj.options.data[M]&&"undefined"!=obj.options.data[M][j]&&(T=obj.options.data[M][j])),T},obj.setValue=function(j,M,L){var T=[];if("string"==typeof j){var O=jexcel.getIdFromColumnName(j,!0);T.push(obj.updateCell(S=O[0],V=O[1],M,L)),obj.updateFormulaChain(S,V,T)}else{var S=null,V=null;if(j&&j.getAttribute&&(S=j.getAttribute("data-x"),V=j.getAttribute("data-y")),null!=S&&null!=V)T.push(obj.updateCell(S,V,M,L)),obj.updateFormulaChain(S,V,T);else{var _=Object.keys(j);if(_.length>0)for(var z=0;z<_.length;z++)"string"==typeof j[z]?(S=(O=jexcel.getIdFromColumnName(j[z],!0))[0],V=O[1]):null!=j[z].x&&null!=j[z].y?(S=j[z].x,V=j[z].y,null!=j[z].newValue?M=j[z].newValue:null!=j[z].value&&(M=j[z].value)):(S=j[z].getAttribute("data-x"),V=j[z].getAttribute("data-y")),null!=S&&null!=V&&(T.push(obj.updateCell(S,V,M,L)),obj.updateFormulaChain(S,V,T))}}obj.setHistory({action:"setValue",records:T,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,T)},obj.setValueFromCoords=function(j,M,L,T){var O=[];O.push(obj.updateCell(j,M,L,T)),obj.updateFormulaChain(j,M,O),obj.setHistory({action:"setValue",records:O,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,O)},obj.setCheckRadioValue=function(){for(var j=[],M=Object.keys(obj.highlighted),L=0;L<M.length;L++){var T=obj.highlighted[L].getAttribute("data-x"),O=obj.highlighted[L].getAttribute("data-y");("checkbox"==obj.options.columns[T].type||"radio"==obj.options.columns[T].type)&&j.push(obj.updateCell(T,O,!obj.options.data[O][T]))}j.length&&(obj.setHistory({action:"setValue",records:j,selection:obj.selectedCell}),obj.onafterchanges(el,j))};var stripScript=function(j){var M=new Option;M.innerHTML=j;var L=null;for(j=M.getElementsByTagName("script");L=j[0];)L.parentNode.removeChild(L);return M.innerHTML};obj.updateCell=function(j,M,L,T){if(1!=obj.records[M][j].classList.contains("readonly")||T){var S;if("="==(""+L).substr(0,1)&&1==obj.options.secureFormulas&&(S=secureFormula(L))!=L&&(L=S),null!=(S=obj.dispatch("onbeforechange",el,obj.records[M][j],j,M,L))&&(L=S),obj.options.columns[j].editor&&"function"==typeof obj.options.columns[j].editor.updateCell&&(L=obj.options.columns[j].editor.updateCell(obj.records[M][j],L,T)),O={x:j,y:M,col:j,row:M,newValue:L,oldValue:obj.options.data[M][j]},obj.options.columns[j].editor)obj.options.data[M][j]=L;else if("checkbox"==obj.options.columns[j].type||"radio"==obj.options.columns[j].type){if("radio"==obj.options.columns[j].type)for(var V=0;V<obj.options.data.length;V++)obj.options.data[V][j]=!1;obj.records[M][j].children[0].checked=1==L||1==L||"true"==L||"TRUE"==L,obj.options.data[M][j]=obj.records[M][j].children[0].checked}else if("dropdown"==obj.options.columns[j].type||"autocomplete"==obj.options.columns[j].type)obj.options.data[M][j]=L,obj.records[M][j].innerText=obj.getDropDownValue(j,L);else if("calendar"==obj.options.columns[j].type){var _=jSuites.calendar.extractDateFromString(L,obj.options.columns[j].options.format);obj.options.data[M][j]=L,obj.records[M][j].innerText=jSuites.calendar.getDateString(_||L,obj.options.columns[j].options.format)}else if("color"==obj.options.columns[j].type)if(obj.options.data[M][j]=L,"square"==obj.options.columns[j].render){var z=document.createElement("div");z.className="color",z.style.backgroundColor=L,obj.records[M][j].innerText="",obj.records[M][j].appendChild(z)}else obj.records[M][j].style.color=L,obj.records[M][j].innerText=L;else if("image"==obj.options.columns[j].type){if(obj.options.data[M][j]=L=""+L,obj.records[M][j].innerHTML="",L&&"data:image"==L.substr(0,10)){var W=document.createElement("img");W.src=L,obj.records[M][j].appendChild(W)}}else obj.options.data[M][j]=L,"html"==obj.options.columns[j].type?obj.records[M][j].innerHTML=stripScript(obj.parseValue(j,M,L)):!1===obj.options.stripHTML||!1===obj.options.columns[j].stripHTML?obj.records[M][j].innerHTML=stripScript(obj.parseValue(j,M,L,obj.records[M][j])):obj.records[M][j].innerText=obj.parseValue(j,M,L,obj.records[M][j]),obj.records[M][j].style.whiteSpace=0!=obj.options.columns[j].wordWrap&&(1==obj.options.wordWrap||1==obj.options.columns[j].wordWrap||obj.records[M][j].innerHTML.length>200)?"pre-wrap":"";j>0&&(obj.records[M][j-1].style.overflow=L?"hidden":""),obj.dispatch("onchange",el,obj.records[M]&&obj.records[M][j]?obj.records[M][j]:null,j,M,L,O.oldValue)}else var O={x:j,y:M,col:j,row:M};return O},obj.copyData=function(j,M){var L=obj.getData(!0,!0),T=obj.selectedContainer,O=parseInt(j.getAttribute("data-x")),S=parseInt(j.getAttribute("data-y")),V=parseInt(M.getAttribute("data-x")),_=parseInt(M.getAttribute("data-y")),z=[],W=!1;if(T[0]==O){if(S<T[1])var te=S-T[1];else te=1;var ee=0}else ee=O<T[0]?O-T[0]:1,te=0;for(var Q=0,Z=0,X=S;X<=_;X++)if(!obj.rows[X]||"none"!=obj.rows[X].style.display){null==L[Z]&&(Z=0),Q=0,T[0]!=O&&(ee=O<T[0]?O-T[0]:1);for(var se=O;se<=V;se++){if(obj.records[X][se]&&!obj.records[X][se].classList.contains("readonly")&&"none"!=obj.records[X][se].style.display&&0==W){if(!obj.selection.length&&""!=obj.options.data[X][se]){W=!0;continue}(null==L[Z]||null==L[Z][Q])&&(Q=0);var oe=L[Z][Q];if(oe&&!L[1]&&1==obj.options.autoIncrement)if("text"==obj.options.columns[se].type||"number"==obj.options.columns[se].type)if("="==(""+oe).substr(0,1)){var me=oe.match(/([A-Z]+[0-9]+)/g);if(me){for(var ce=[],ge=0;ge<me.length;ge++){var xe=jexcel.getIdFromColumnName(me[ge],1);xe[0]+=ee,xe[1]+=te,xe[1]<0&&(xe[1]=0);var Ee=jexcel.getColumnNameFromId([xe[0],xe[1]]);Ee!=me[ge]&&(ce[me[ge]]=Ee)}ce&&(oe=obj.updateFormula(oe,ce))}}else oe==Number(oe)&&(oe=Number(oe)+te);else if("calendar"==obj.options.columns[se].type){var Ve=new Date(oe);Ve.setDate(Ve.getDate()+te),oe=Ve.getFullYear()+"-"+jexcel.doubleDigitFormat(parseInt(Ve.getMonth()+1))+"-"+jexcel.doubleDigitFormat(Ve.getDate())+" 00:00:00"}z.push(obj.updateCell(se,X,oe)),obj.updateFormulaChain(se,X,z)}Q++,T[0]!=O&&ee++}Z++,te++}obj.setHistory({action:"setValue",records:z,selection:obj.selectedCell}),obj.updateTable(),obj.onafterchanges(el,z)},obj.refreshSelection=function(){obj.selectedCell&&obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.conditionalSelectionUpdate=function(j,M,L){if(1==j){if(obj.selectedCell&&(M>=obj.selectedCell[1]&&M<=obj.selectedCell[3]||L>=obj.selectedCell[1]&&L<=obj.selectedCell[3]))return void obj.resetSelection()}else if(obj.selectedCell&&(M>=obj.selectedCell[0]&&M<=obj.selectedCell[2]||L>=obj.selectedCell[0]&&L<=obj.selectedCell[2]))return void obj.resetSelection()},obj.resetSelection=function(j){if(obj.highlighted.length)for(var M=1,L=0;L<obj.highlighted.length;L++){obj.highlighted[L].classList.remove("highlight"),obj.highlighted[L].classList.remove("highlight-left"),obj.highlighted[L].classList.remove("highlight-right"),obj.highlighted[L].classList.remove("highlight-top"),obj.highlighted[L].classList.remove("highlight-bottom"),obj.highlighted[L].classList.remove("highlight-selected");var T=parseInt(obj.highlighted[L].getAttribute("data-x")),O=parseInt(obj.highlighted[L].getAttribute("data-y"));if(obj.highlighted[L].getAttribute("data-merged"))var S=parseInt(obj.highlighted[L].getAttribute("colspan")),V=parseInt(obj.highlighted[L].getAttribute("rowspan")),_=S>0?T+(S-1):T,z=V>0?O+(V-1):O;else _=T,z=O;for(var W=T;W<=_;W++)obj.headers[W]&&obj.headers[W].classList.remove("selected");for(W=O;W<=z;W++)obj.rows[W]&&obj.rows[W].classList.remove("selected")}else M=0;return obj.highlighted=[],obj.selectedCell=null,obj.corner.style.top="-2000px",obj.corner.style.left="-2000px",1==j&&1==M&&obj.dispatch("onblur",el),M},obj.updateSelection=function(j,M,L){var T=j.getAttribute("data-x"),O=j.getAttribute("data-y");if(M)var S=M.getAttribute("data-x"),V=M.getAttribute("data-y");else S=T,V=O;obj.updateSelectionFromCoords(T,O,S,V,L)},obj.updateSelectionFromCoords=function(j,M,L,T,O){var V=obj.resetSelection();if(null==M&&(M=0,T=obj.rows.length-1),null==L&&(L=j),null==T&&(T=M),j>=obj.headers.length&&(j=obj.headers.length-1),M>=obj.rows.length&&(M=obj.rows.length-1),L>=obj.headers.length&&(L=obj.headers.length-1),T>=obj.rows.length&&(T=obj.rows.length-1),obj.selectedCell=[j,M,L,T],null!=j){if(obj.records[M][j]&&obj.records[M][j].classList.add("highlight-selected"),parseInt(j)<parseInt(L))var _=parseInt(j),z=parseInt(L);else _=parseInt(L),z=parseInt(j);if(parseInt(M)<parseInt(T))var W=parseInt(M),te=parseInt(T);else W=parseInt(T),te=parseInt(M);for(var ee=_;ee<=z;ee++)for(var Q=W;Q<=te;Q++)if(obj.records[Q][ee]&&obj.records[Q][ee].getAttribute("data-merged")){var Z=parseInt(obj.records[Q][ee].getAttribute("data-x")),X=parseInt(obj.records[Q][ee].getAttribute("data-y")),se=parseInt(obj.records[Q][ee].getAttribute("colspan")),oe=parseInt(obj.records[Q][ee].getAttribute("rowspan"));se>1&&(Z<_&&(_=Z),Z+se>z&&(z=Z+se-1)),oe&&(X<W&&(W=X),X+oe>te&&(te=X+oe-1))}var me=null,ce=null,ge=null,xe=null;for(Q=W;Q<=te;Q++)"none"!=obj.rows[Q].style.display&&(null==ge&&(ge=Q),xe=Q);for(ee=_;ee<=z;ee++){for(Q=W;Q<=te;Q++)"none"!=obj.rows[Q].style.display&&"none"!=obj.records[Q][ee].style.display&&(obj.records[Q][ee].classList.add("highlight"),obj.highlighted.push(obj.records[Q][ee]));"hidden"!=obj.options.columns[ee].type&&(null==me&&(me=ee),ce=ee)}for(me||(me=0),ce||(ce=0),ee=me;ee<=ce;ee++)"hidden"!=obj.options.columns[ee].type&&(obj.records[ge]&&obj.records[ge][ee]&&obj.records[ge][ee].classList.add("highlight-top"),obj.records[xe]&&obj.records[xe][ee]&&obj.records[xe][ee].classList.add("highlight-bottom"),obj.headers[ee].classList.add("selected"));for(Q=ge;Q<=xe;Q++)obj.rows[Q]&&"none"!=obj.rows[Q].style.display&&(obj.records[Q][me].classList.add("highlight-left"),obj.records[Q][ce].classList.add("highlight-right"),obj.rows[Q].classList.add("selected"));obj.selectedContainer=[me,ge,ce,xe]}0==V&&(obj.dispatch("onfocus",el),obj.removeCopyingSelection()),obj.dispatch("onselection",el,me,ge,ce,xe,O),obj.updateCornerPosition()},obj.removeCopySelection=function(){for(var j=0;j<obj.selection.length;j++)obj.selection[j].classList.remove("selection"),obj.selection[j].classList.remove("selection-left"),obj.selection[j].classList.remove("selection-right"),obj.selection[j].classList.remove("selection-top"),obj.selection[j].classList.remove("selection-bottom");obj.selection=[]},obj.updateCopySelection=function(j,M){obj.removeCopySelection();var L=obj.selectedContainer[0],T=obj.selectedContainer[1],O=obj.selectedContainer[2],S=obj.selectedContainer[3];if(null!=j&&null!=M){if(j-O>0)var V=parseInt(O)+1,_=parseInt(j);else V=parseInt(j),_=parseInt(L)-1;if(M-S>0)var z=parseInt(S)+1,W=parseInt(M);else z=parseInt(M),W=parseInt(T)-1;_-V<=W-z?(V=parseInt(L),_=parseInt(O)):(z=parseInt(T),W=parseInt(S));for(var te=z;te<=W;te++)for(var ee=V;ee<=_;ee++)obj.records[te][ee]&&"none"!=obj.rows[te].style.display&&"none"!=obj.records[te][ee].style.display&&(obj.records[te][ee].classList.add("selection"),obj.records[z][ee].classList.add("selection-top"),obj.records[W][ee].classList.add("selection-bottom"),obj.records[te][V].classList.add("selection-left"),obj.records[te][_].classList.add("selection-right"),obj.selection.push(obj.records[te][ee]))}},obj.updateCornerPosition=function(){if(obj.highlighted.length){var j=obj.highlighted[obj.highlighted.length-1],M=obj.content.getBoundingClientRect(),L=M.left,T=M.top,O=j.getBoundingClientRect(),S=O.left,_=O.width,W=S-L+obj.content.scrollLeft+_-4;obj.corner.style.top=O.top-T+obj.content.scrollTop+O.height-4+"px",obj.corner.style.left=W+"px",obj.options.freezeColumns&&S-L+_<obj.getFreezeWidth()?obj.corner.style.display="none":1==obj.options.selectionCopy&&(obj.corner.style.display="")}else obj.corner.style.top="-2000px",obj.corner.style.left="-2000px"},obj.updateScroll=function(j){var M=obj.content.getBoundingClientRect(),L=M.left,T=M.top,O=M.width,S=M.height,_=obj.records[obj.selectedCell[3]][obj.selectedCell[2]].getBoundingClientRect(),z=_.left,W=_.top,ee=_.height;if(0==j||1==j)var Q=z-L+obj.content.scrollLeft,Z=W-T+obj.content.scrollTop-2;else Q=z-L+obj.content.scrollLeft+_.width,Z=W-T+obj.content.scrollTop+ee;Z>obj.content.scrollTop+30&&Z<obj.content.scrollTop+S||(obj.content.scrollTop=Z<obj.content.scrollTop+30?Z-ee:Z-(S-2));var X=obj.getFreezeWidth();Q>obj.content.scrollLeft+X&&Q<obj.content.scrollLeft+O||(Q<obj.content.scrollLeft+30?(obj.content.scrollLeft=Q,obj.content.scrollLeft<50&&(obj.content.scrollLeft=0)):obj.content.scrollLeft=Q<obj.content.scrollLeft+X?Q-X-1:Q-(O-20))},obj.getWidth=function(j){if(j)"object"==typeof j&&(j=$(j).getAttribute("data-x")),M=obj.colgroup[j].getAttribute("width");else for(var M=[],L=0;L<obj.headers.length;L++)M.push(obj.options.columns[L].width);return M},obj.setWidth=function(j,M,L){if(M){if(Array.isArray(j)){L||(L=[]);for(var T=0;T<j.length;T++){L[T]||(L[T]=obj.colgroup[j[T]].getAttribute("width"));var O=Array.isArray(M)&&M[T]?M[T]:M;obj.colgroup[j[T]].setAttribute("width",O),obj.options.columns[j[T]].width=O}}else L||(L=obj.colgroup[j].getAttribute("width")),obj.colgroup[j].setAttribute("width",M),obj.options.columns[j].width=M;obj.setHistory({action:"setWidth",column:j,oldValue:L,newValue:M}),obj.dispatch("onresizecolumn",el,j,M,L),obj.updateCornerPosition()}},obj.setHeight=function(j,M,L){M>0&&("object"==typeof j&&(j=j.getAttribute("data-y")),L||(L=obj.rows[j].getAttribute("height"))||(L=obj.rows[j].getBoundingClientRect().height),M=parseInt(M),obj.rows[j].style.height=M+"px",obj.options.rows[j]||(obj.options.rows[j]={}),obj.options.rows[j].height=M,obj.setHistory({action:"setHeight",row:j,oldValue:L,newValue:M}),obj.dispatch("onresizerow",el,j,M,L),obj.updateCornerPosition())},obj.getHeight=function(j){if(j){"object"==typeof j&&(j=$(j).getAttribute("data-y"));var M=obj.rows[j].style.height}else{M=[];for(var L=0;L<obj.rows.length;L++){var T=obj.rows[L].style.height;T&&(M[L]=T)}}return M},obj.setFooter=function(j){if(j&&(obj.options.footers=j),obj.options.footers){obj.tfoot||(obj.tfoot=document.createElement("tfoot"),obj.table.appendChild(obj.tfoot));for(var M=0;M<obj.options.footers.length;M++){if(obj.tfoot.children[M])var L=obj.tfoot.children[M];else{L=document.createElement("tr");var T=document.createElement("td");L.appendChild(T),obj.tfoot.appendChild(L)}for(var O=0;O<obj.headers.length;O++)obj.options.footers[M][O]||(obj.options.footers[M][O]=""),obj.tfoot.children[M].children[O+1]?T=obj.tfoot.children[M].children[O+1]:(T=document.createElement("td"),L.appendChild(T),T.style.textAlign=obj.options.columns[O].align?obj.options.columns[O].align:"center"),T.innerText=obj.parseValue(O,M,obj.options.footers[M][O])}}},obj.getHeader=function(j){return obj.headers[j].innerText},obj.setHeader=function(j,M){if(obj.headers[j]){var L=obj.headers[j].innerText;M||(M=prompt(obj.options.text.columnName,L)),M&&(obj.headers[j].innerText=M,obj.headers[j].setAttribute("title",M),obj.options.columns[j].title=M),obj.setHistory({action:"setHeader",column:j,oldValue:L,newValue:M}),obj.dispatch("onchangeheader",el,j,L,M)}},obj.getHeaders=function(j){for(var M=[],L=0;L<obj.headers.length;L++)M.push(obj.getHeader(L));return j?M:M.join(obj.options.csvDelimiter)},obj.getMeta=function(j,M){return j?M?obj.options.meta[j]&&obj.options.meta[j][M]?obj.options.meta[j][M]:null:obj.options.meta[j]?obj.options.meta[j]:null:obj.options.meta},obj.setMeta=function(j,M,L){if(obj.options.meta||(obj.options.meta={}),M&&L)obj.options.meta[j]||(obj.options.meta[j]={}),obj.options.meta[j][M]=L;else for(var T=Object.keys(j),O=0;O<T.length;O++){obj.options.meta[T[O]]||(obj.options.meta[T[O]]={});for(var S=Object.keys(j[T[O]]),V=0;V<S.length;V++)obj.options.meta[T[O]][S[V]]=j[T[O]][S[V]]}obj.dispatch("onchangemeta",el,j,M,L)},obj.updateMeta=function(j){if(obj.options.meta){for(var M={},L=Object.keys(obj.options.meta),T=0;T<L.length;T++)j[L[T]]?M[j[L[T]]]=obj.options.meta[L[T]]:M[L[T]]=obj.options.meta[L[T]];obj.options.meta=M}},obj.getStyle=function(j,M){if(j)return j=jexcel.getIdFromColumnName(j,!0),M?obj.records[j[1]][j[0]].style[M]:obj.records[j[1]][j[0]].getAttribute("style");for(var L={},T=obj.options.data[0].length,O=obj.options.data.length,S=0;S<O;S++)for(var V=0;V<T;V++){var _=M?obj.records[S][V].style[M]:obj.records[S][V].getAttribute("style");_&&(L[jexcel.getColumnNameFromId([V,S])]=_)}return L},obj.resetStyle=function(j,M){for(var L=Object.keys(j),T=0;T<L.length;T++){var O=jexcel.getIdFromColumnName(L[T],!0);obj.records[O[1]]&&obj.records[O[1]][O[0]]&&obj.records[O[1]][O[0]].setAttribute("style","")}obj.setStyle(j,null,null,null,M)},obj.setStyle=function(j,M,L,T,O){var S={},V={},_=function(oe,me,ce){var ge=jexcel.getIdFromColumnName(oe,!0);if(obj.records[ge[1]]&&obj.records[ge[1]][ge[0]]&&(0==obj.records[ge[1]][ge[0]].classList.contains("readonly")||T)){var xe=obj.records[ge[1]][ge[0]].style[me];xe!=ce||T?obj.records[ge[1]][ge[0]].style[me]=ce:(ce="",obj.records[ge[1]][ge[0]].style[me]=""),V[oe]||(V[oe]=[]),S[oe]||(S[oe]=[]),V[oe].push([me+":"+xe]),S[oe].push([me+":"+ce])}};if(M&&L)if("string"==typeof j)_(j,M,L);else for(var z=[],W=0;W<j.length;W++){var te=j[W].getAttribute("data-x"),ee=j[W].getAttribute("data-y"),Q=jexcel.getColumnNameFromId([te,ee]);z[Q]||(_(Q,M,L),z[Q]=!0)}else{var se=Object.keys(j);for(W=0;W<se.length;W++){var Z=j[se[W]];"string"==typeof Z&&(Z=Z.split(";"));for(var X=0;X<Z.length;X++)"string"==typeof Z[X]&&(Z[X]=Z[X].split(":")),Z[X][0].trim()&&_(se[W],Z[X][0].trim(),Z[X][1])}}for(se=Object.keys(V),W=0;W<se.length;W++)V[se[W]]=V[se[W]].join(";");for(se=Object.keys(S),W=0;W<se.length;W++)S[se[W]]=S[se[W]].join(";");O||obj.setHistory({action:"setStyle",oldValue:V,newValue:S}),obj.dispatch("onchangestyle",el,j,M,L)},obj.getComments=function(j,M){if(j)return"string"==typeof j&&(j=jexcel.getIdFromColumnName(j,!0)),M?[obj.records[j[1]][j[0]].getAttribute("title"),obj.records[j[1]][j[0]].getAttribute("author")]:obj.records[j[1]][j[0]].getAttribute("title")||"";for(var L={},T=0;T<obj.options.data.length;T++)for(var O=0;O<obj.options.columns.length;O++){var S=obj.records[T][O].getAttribute("title");S&&(L[j=jexcel.getColumnNameFromId([O,T])]=S)}return L},obj.setComments=function(j,M,L){if("string"==typeof j)var T=jexcel.getIdFromColumnName(j,!0);else T=j;var O=obj.records[T[1]][T[0]].getAttribute("title"),S=[O,L=obj.records[T[1]][T[0]].getAttribute("data-author")];obj.records[T[1]][T[0]].setAttribute("title",M||""),obj.records[T[1]][T[0]].setAttribute("data-author",L||""),M?obj.records[T[1]][T[0]].classList.add("jexcel_comments"):obj.records[T[1]][T[0]].classList.remove("jexcel_comments"),obj.setHistory({action:"setComments",column:j,newValue:[M,L],oldValue:S}),obj.dispatch("oncomments",el,M,O,T,T[0],T[1])},obj.getConfig=function(){var j=obj.options;return j.style=obj.getStyle(),j.mergeCells=obj.getMerge(),j.comments=obj.getComments(),j},obj.orderBy=function(j,M){if(j>=0){if(Object.keys(obj.options.mergeCells).length>0){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}M=null==M?obj.headers[j].classList.contains("arrow-down")?1:0:M?1:0;var L=[];if("number"==obj.options.columns[j].type||"percentage"==obj.options.columns[j].type||"autonumber"==obj.options.columns[j].type||"color"==obj.options.columns[j].type)for(var T=0;T<obj.options.data.length;T++)L[T]=[T,Number(obj.options.data[T][j])];else if("calendar"==obj.options.columns[j].type||"checkbox"==obj.options.columns[j].type||"radio"==obj.options.columns[j].type)for(T=0;T<obj.options.data.length;T++)L[T]=[T,obj.options.data[T][j]];else for(T=0;T<obj.options.data.length;T++)L[T]=[T,obj.records[T][j].innerText.toLowerCase()];"function"!=typeof obj.options.sorting&&(obj.options.sorting=function(S){return function(V,_){var z=V[1],W=_[1];return S?""===z&&""!==W?1:""!==z&&""===W||z>W?-1:z<W?1:0:""===z&&""!==W?1:""!==z&&""===W?-1:z>W?1:z<W?-1:0}}),L=L.sort(obj.options.sorting(M));var O=[];for(T=0;T<L.length;T++)O[T]=L[T][0];return obj.setHistory({action:"orderBy",rows:O,column:j,order:M}),obj.updateOrderArrow(j,M),obj.updateOrder(O),obj.dispatch("onsort",el,j,M),!0}},obj.updateOrderArrow=function(j,M){for(var L=0;L<obj.headers.length;L++)obj.headers[L].classList.remove("arrow-up"),obj.headers[L].classList.remove("arrow-down");obj.headers[j].classList.add(M?"arrow-up":"arrow-down")},obj.updateOrder=function(j){for(var M=[],L=0;L<j.length;L++)M[L]=obj.options.data[j[L]];for(obj.options.data=M,M=[],L=0;L<j.length;L++)M[L]=obj.records[j[L]];for(obj.records=M,M=[],L=0;L<j.length;L++)M[L]=obj.rows[j[L]];if(obj.rows=M,obj.updateTableReferences(),obj.results&&obj.results.length)obj.searchInput.value?obj.search(obj.searchInput.value):obj.closeFilter();else if(obj.results=null,obj.pageNumber=0,obj.options.pagination>0)obj.page(0);else if(1==obj.options.lazyLoading)obj.loadPage(0);else for(L=0;L<obj.rows.length;L++)obj.tbody.appendChild(obj.rows[L])},obj.moveRow=function(j,M,L){if(Object.keys(obj.options.mergeCells).length>0){if(j>M)var T=1;else T=0;if(obj.isRowMerged(j).length||obj.isRowMerged(M,T).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}L||(Array.prototype.indexOf.call(obj.tbody.children,obj.rows[M])>=0?obj.tbody.insertBefore(obj.rows[j],j>M?obj.rows[M]:obj.rows[M].nextSibling):obj.tbody.removeChild(obj.rows[j])),obj.rows.splice(M,0,obj.rows.splice(j,1)[0]),obj.records.splice(M,0,obj.records.splice(j,1)[0]),obj.options.data.splice(M,0,obj.options.data.splice(j,1)[0]),obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.setHistory({action:"moveRow",oldValue:j,newValue:M}),obj.updateTableReferences(),obj.dispatch("onmoverow",el,j,M)},obj.insertRow=function(j,M,L){if(1==obj.options.allowInsertRow){var O=[];if(j>0)var S=j;else S=1,j&&(O=j);L=!!L;var V=obj.options.data.length-1;if((null==M||M>=parseInt(V)||M<0)&&(M=V),!1===obj.dispatch("onbeforeinsertrow",el,M,S,L))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isRowMerged(M,L).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(var _=L?M:M+1,z=obj.records.splice(_),W=obj.options.data.splice(_),te=obj.rows.splice(_),ee=[],Q=[],Z=[],X=_;X<S+_;X++){obj.options.data[X]=[];for(var se=0;se<obj.options.columns.length;se++)obj.options.data[X][se]=O[se]?O[se]:"";var oe=obj.createRow(X,obj.options.data[X]);te[0]?Array.prototype.indexOf.call(obj.tbody.children,te[0])>=0&&obj.tbody.insertBefore(oe,te[0]):Array.prototype.indexOf.call(obj.tbody.children,obj.rows[M])>=0&&obj.tbody.appendChild(oe),ee.push(obj.records[X]),Q.push(obj.options.data[X]),Z.push(oe)}Array.prototype.push.apply(obj.records,z),Array.prototype.push.apply(obj.options.data,W),Array.prototype.push.apply(obj.rows,te),obj.options.pagination>0&&obj.page(obj.pageNumber),obj.setHistory({action:"insertRow",rowNumber:M,numOfRows:S,insertBefore:L,rowRecords:ee,rowData:Q,rowNode:Z}),obj.updateTableReferences(),obj.dispatch("oninsertrow",el,M,S,ee,L)}},obj.deleteRow=function(j,M){if(1==obj.options.allowDeleteRow)if(1==obj.options.allowDeletingAllRows||obj.options.data.length>1){if(null==j){var L=obj.getSelectedRows();L[0]?(j=parseInt(L[0].getAttribute("data-y")),M=L.length):(j=obj.options.data.length-1,M=1)}var T=obj.options.data.length-1;if((null==j||j>T||j<0)&&(j=T),M||(M=1),j+M>=obj.options.data.length&&(M=obj.options.data.length-j),!1===obj.dispatch("onbeforedeleterow",el,j,M))return!1;if(parseInt(j)>-1){var O=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var S=j;S<j+M;S++)obj.isRowMerged(S,!1).length&&(O=!0);if(O){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}if(1==obj.options.search){if(obj.results&&obj.results.length!=obj.rows.length){if(!confirm(obj.options.text.thisActionWillClearYourSearchResultsAreYouSure))return!1;obj.resetSearch()}obj.results=null}for(0==obj.options.allowDeletingAllRows&&T+1===M&&(M--,console.error("Jspreadsheet: It is not possible to delete the last row")),S=j;S<j+M;S++)Array.prototype.indexOf.call(obj.tbody.children,obj.rows[S])>=0&&(obj.rows[S].className="",obj.rows[S].parentNode.removeChild(obj.rows[S]));var V=obj.records.splice(j,M),_=obj.options.data.splice(j,M),z=obj.rows.splice(j,M);obj.options.pagination>0&&obj.tbody.children.length!=obj.options.pagination&&obj.page(obj.pageNumber),obj.conditionalSelectionUpdate(1,j,j+M-1),obj.setHistory({action:"deleteRow",rowNumber:j,numOfRows:M,insertBefore:1,rowRecords:V,rowData:_,rowNode:z}),obj.updateTableReferences(),obj.dispatch("ondeleterow",el,j,M,V)}}else console.error("Jspreadsheet: It is not possible to delete the last row")},obj.moveColumn=function(j,M){if(Object.keys(obj.options.mergeCells).length>0){if(j>M)var L=1;else L=0;if(obj.isColMerged(j).length||obj.isColMerged(M,L).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}}if((j=parseInt(j))>(M=parseInt(M))){obj.headerContainer.insertBefore(obj.headers[j],obj.headers[M]),obj.colgroupContainer.insertBefore(obj.colgroup[j],obj.colgroup[M]);for(var T=0;T<obj.rows.length;T++)obj.rows[T].insertBefore(obj.records[T][j],obj.records[T][M])}else for(obj.headerContainer.insertBefore(obj.headers[j],obj.headers[M].nextSibling),obj.colgroupContainer.insertBefore(obj.colgroup[j],obj.colgroup[M].nextSibling),T=0;T<obj.rows.length;T++)obj.rows[T].insertBefore(obj.records[T][j],obj.records[T][M].nextSibling);for(obj.options.columns.splice(M,0,obj.options.columns.splice(j,1)[0]),obj.headers.splice(M,0,obj.headers.splice(j,1)[0]),obj.colgroup.splice(M,0,obj.colgroup.splice(j,1)[0]),T=0;T<obj.rows.length;T++)obj.options.data[T].splice(M,0,obj.options.data[T].splice(j,1)[0]),obj.records[T].splice(M,0,obj.records[T].splice(j,1)[0]);if(obj.options.footers)for(T=0;T<obj.options.footers.length;T++)obj.options.footers[T].splice(M,0,obj.options.footers[T].splice(j,1)[0]);obj.setHistory({action:"moveColumn",oldValue:j,newValue:M}),obj.updateTableReferences(),obj.dispatch("onmovecolumn",el,j,M)},obj.insertColumn=function(j,M,L,T){if(1==obj.options.allowInsertColumn){var S=[];if(j>0)var V=j;else V=1,j&&(S=j);L=!!L;var _=obj.options.columns.length-1;if((null==M||M>=parseInt(_)||M<0)&&(M=_),!1===obj.dispatch("onbeforeinsertcolumn",el,M,V,L))return!1;if(Object.keys(obj.options.mergeCells).length>0&&obj.isColMerged(M,L).length){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}T||(T=[]);for(var z=0;z<V;z++)T[z]||(T[z]={type:"text",source:[],options:[],width:obj.options.defaultColWidth,align:obj.options.defaultColAlign});var W=L?M:M+1;obj.options.columns=jexcel.injectArray(obj.options.columns,W,T);for(var te=obj.headers.splice(W),ee=obj.colgroup.splice(W),Q=[],Z=[],X=[],se=[],oe=[],me=W;me<V+W;me++)obj.createCellHeader(me),obj.headerContainer.insertBefore(obj.headers[me],obj.headerContainer.children[me+1]),obj.colgroupContainer.insertBefore(obj.colgroup[me],obj.colgroupContainer.children[me+1]),Q.push(obj.headers[me]),Z.push(obj.colgroup[me]);if(obj.options.footers)for(var ce=0;ce<obj.options.footers.length;ce++){for(oe[ce]=[],z=0;z<V;z++)oe[ce].push("");obj.options.footers[ce].splice(W,0,oe[ce])}for(var ge=0;ge<obj.options.data.length;ge++){var xe=obj.options.data[ge].splice(W),Ee=obj.records[ge].splice(W);for(se[ge]=[],X[ge]=[],me=W;me<V+W;me++){var Ve=S[ge]?S[ge]:"";obj.options.data[ge][me]=Ve;var ze=obj.createCell(me,ge,obj.options.data[ge][me]);obj.records[ge][me]=ze,obj.rows[ge]&&obj.rows[ge].insertBefore(ze,obj.rows[ge].children[me+1]),se[ge].push(Ve),X[ge].push(ze)}Array.prototype.push.apply(obj.options.data[ge],xe),Array.prototype.push.apply(obj.records[ge],Ee)}if(Array.prototype.push.apply(obj.headers,te),Array.prototype.push.apply(obj.colgroup,ee),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(ce=0;ce<obj.options.nestedHeaders.length;ce++){var Re=parseInt(obj.options.nestedHeaders[ce][obj.options.nestedHeaders[ce].length-1].colspan)+V;obj.options.nestedHeaders[ce][obj.options.nestedHeaders[ce].length-1].colspan=Re,obj.thead.children[ce].children[obj.thead.children[ce].children.length-1].setAttribute("colspan",Re);var be=obj.thead.children[ce].children[obj.thead.children[ce].children.length-1].getAttribute("data-column");for(be=be.split(","),me=W;me<V+W;me++)be.push(me);obj.thead.children[ce].children[obj.thead.children[ce].children.length-1].setAttribute("data-column",be)}else Re=parseInt(obj.options.nestedHeaders[0].colspan)+V,obj.options.nestedHeaders[0].colspan=Re,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",Re);obj.setHistory({action:"insertColumn",columnNumber:M,numOfColumns:V,insertBefore:L,columns:T,headers:Q,colgroup:Z,records:X,footers:oe,data:se}),obj.updateTableReferences(),obj.dispatch("oninsertcolumn",el,M,V,X,L)}},obj.deleteColumn=function(j,M){if(1==obj.options.allowDeleteColumn)if(obj.headers.length>1){if(null==j){var L=obj.getSelectedColumns(!0);L.length?(j=parseInt(L[0]),M=parseInt(L.length)):(j=obj.headers.length-1,M=1)}var T=obj.options.data[0].length-1;if((null==j||j>T||j<0)&&(j=T),M||(M=1),M>obj.options.data[0].length-j&&(M=obj.options.data[0].length-j),!1===obj.dispatch("onbeforedeletecolumn",el,j,M))return!1;if(parseInt(j)>-1){var O=!1;if(Object.keys(obj.options.mergeCells).length>0)for(var S=j;S<j+M;S++)obj.isColMerged(S,!1).length&&(O=!0);if(O){if(!confirm(obj.options.text.thisActionWillDestroyAnyExistingMergedCellsAreYouSure))return!1;obj.destroyMerged()}var V=obj.options.columns.splice(j,M);for(S=j;S<j+M;S++)obj.colgroup[S].className="",obj.headers[S].className="",obj.colgroup[S].parentNode.removeChild(obj.colgroup[S]),obj.headers[S].parentNode.removeChild(obj.headers[S]);for(var _=obj.headers.splice(j,M),z=obj.colgroup.splice(j,M),W=[],te=[],ee=[],Q=0;Q<obj.options.data.length;Q++)for(S=j;S<j+M;S++)obj.records[Q][S].className="",obj.records[Q][S].parentNode.removeChild(obj.records[Q][S]);for(Q=0;Q<obj.options.data.length;Q++)te[Q]=obj.options.data[Q].splice(j,M),W[Q]=obj.records[Q].splice(j,M);if(obj.options.footers)for(Q=0;Q<obj.options.footers.length;Q++)ee[Q]=obj.options.footers[Q].splice(j,M);if(obj.conditionalSelectionUpdate(0,j,j+M-1),obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(var Z=0;Z<obj.options.nestedHeaders.length;Z++){var X=parseInt(obj.options.nestedHeaders[Z][obj.options.nestedHeaders[Z].length-1].colspan)-M;obj.options.nestedHeaders[Z][obj.options.nestedHeaders[Z].length-1].colspan=X,obj.thead.children[Z].children[obj.thead.children[Z].children.length-1].setAttribute("colspan",X)}else X=parseInt(obj.options.nestedHeaders[0].colspan)-M,obj.options.nestedHeaders[0].colspan=X,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",X);obj.setHistory({action:"deleteColumn",columnNumber:j,numOfColumns:M,insertBefore:1,columns:V,headers:_,colgroup:z,records:W,footers:ee,data:te}),obj.updateTableReferences(),obj.dispatch("ondeletecolumn",el,j,M,W)}}else console.error("Jspreadsheet: It is not possible to delete the last column")},obj.getSelectedRows=function(j){for(var M=[],L=0;L<obj.rows.length;L++)obj.rows[L].classList.contains("selected")&&M.push(j?L:obj.rows[L]);return M},obj.getSelectedColumns=function(){for(var j=[],M=0;M<obj.headers.length;M++)obj.headers[M].classList.contains("selected")&&j.push(M);return j},obj.getHighlighted=function(){return obj.highlighted},obj.updateTableReferences=function(){for(var j=0;j<obj.headers.length;j++)(M=obj.headers[j].getAttribute("data-x"))!=j&&(obj.headers[j].setAttribute("data-x",j),obj.headers[j].getAttribute("title")||(obj.headers[j].innerHTML=jexcel.getColumnName(j)));for(var L=0;L<obj.rows.length;L++)obj.rows[L]&&(T=obj.rows[L].getAttribute("data-y"))!=L&&(obj.rows[L].setAttribute("data-y",L),obj.rows[L].children[0].setAttribute("data-y",L),obj.rows[L].children[0].innerHTML=L+1);var O=[],S=[],V=function(Z,X,se,oe){if(Z!=se&&obj.records[oe][se].setAttribute("data-x",se),X!=oe&&obj.records[oe][se].setAttribute("data-y",oe),Z!=se||X!=oe){var me=jexcel.getColumnNameFromId([Z,X]),ce=jexcel.getColumnNameFromId([se,oe]);O[me]=ce}};for(L=0;L<obj.records.length;L++)for(j=0;j<obj.records[0].length;j++)if(obj.records[L][j]){var M=obj.records[L][j].getAttribute("data-x"),T=obj.records[L][j].getAttribute("data-y");if(obj.records[L][j].getAttribute("data-merged")){var _=jexcel.getColumnNameFromId([M,T]),z=jexcel.getColumnNameFromId([j,L]);if(null==S[_])if(_==z)S[_]=!1;else{var W=parseInt(j-M),te=parseInt(L-T);S[_]=[z,W,te]}}else V(M,T,j,L)}var ee=Object.keys(S);if(ee.length)for(j=0;j<ee.length;j++)if(S[ee[j]]){var Q=jexcel.getIdFromColumnName(ee[j],!0);for(V(M=Q[0],T=Q[1],M+S[ee[j]][1],T+S[ee[j]][2]),_=ee[j],z=S[ee[j]][0],L=0;L<obj.options.mergeCells[_][2].length;L++)M=parseInt(obj.options.mergeCells[_][2][L].getAttribute("data-x")),T=parseInt(obj.options.mergeCells[_][2][L].getAttribute("data-y")),obj.options.mergeCells[_][2][L].setAttribute("data-x",M+S[ee[j]][1]),obj.options.mergeCells[_][2][L].setAttribute("data-y",T+S[ee[j]][2]);obj.options.mergeCells[z]=obj.options.mergeCells[_],delete obj.options.mergeCells[_]}obj.updateFormulas(O),obj.updateMeta(O),obj.refreshSelection(),obj.updateTable()},obj.updateTable=function(){if(obj.options.minSpareRows>0){for(var j=0,M=obj.rows.length-1;M>=0;M--){for(var L=!1,T=0;T<obj.headers.length;T++)obj.options.data[M][T]&&(L=!0);if(L)break;j++}obj.options.minSpareRows-j>0&&obj.insertRow(obj.options.minSpareRows-j)}if(obj.options.minSpareCols>0){var O=0;for(T=obj.headers.length-1;T>=0;T--){for(L=!1,M=0;M<obj.rows.length;M++)obj.options.data[M][T]&&(L=!0);if(L)break;O++}obj.options.minSpareCols-O>0&&obj.insertColumn(obj.options.minSpareCols-O)}if("function"==typeof obj.options.updateTable){for(obj.options.detachForUpdates&&el.removeChild(obj.content),M=0;M<obj.rows.length;M++)for(T=0;T<obj.headers.length;T++)obj.options.updateTable(el,obj.records[M][T],T,M,obj.options.data[M][T],obj.records[M][T].innerText,jexcel.getColumnNameFromId([T,M]));obj.options.detachForUpdates&&el.insertBefore(obj.content,obj.pagination)}obj.options.footers&&obj.setFooter(),setTimeout(function(){obj.updateCornerPosition()},0)},obj.isReadOnly=function(j){if(j=obj.getCell(j))return!!j.classList.contains("readonly")},obj.setReadOnly=function(j,M){(j=obj.getCell(j))&&(M?j.classList.add("readonly"):j.classList.remove("readonly"))},obj.showRow=function(j){obj.rows[j].style.display=""},obj.hideRow=function(j){obj.rows[j].style.display="none"},obj.showColumn=function(j){obj.headers[j].style.display="",obj.colgroup[j].style.display="";for(var M=0;M<obj.options.data.length;M++)obj.records[M][j].style.display=""},obj.hideColumn=function(j){obj.headers[j].style.display="none",obj.colgroup[j].style.display="none";for(var M=0;M<obj.options.data.length;M++)obj.records[M][j].style.display="none"},obj.showIndex=function(){obj.table.classList.remove("jexcel_hidden_index")},obj.hideIndex=function(){obj.table.classList.add("jexcel_hidden_index")};var chainLoopProtection=[];obj.updateFormulaChain=function(j,M,L){var T=jexcel.getColumnNameFromId([j,M]);if(obj.formula[T]&&obj.formula[T].length>0)if(chainLoopProtection[T])obj.records[M][j].innerHTML="#ERROR",obj.formula[T]="";else{chainLoopProtection[T]=!0;for(var O=0;O<obj.formula[T].length;O++){var S=jexcel.getIdFromColumnName(obj.formula[T][O],!0),V=""+obj.options.data[S[1]][S[0]];"="==V.substr(0,1)?L.push(obj.updateCell(S[0],S[1],V,!0)):Object.keys(obj.formula)[O]=null,obj.updateFormulaChain(S[0],S[1],L)}}chainLoopProtection=[]},obj.updateFormulas=function(j){for(var M=0;M<obj.options.data.length;M++)for(var L=0;L<obj.options.data[0].length;L++)if("="==(T=""+obj.options.data[M][L]).substr(0,1)){var O=obj.updateFormula(T,j);O!=T&&(obj.options.data[M][L]=O)}var S=[],V=Object.keys(obj.formula);for(M=0;M<V.length;M++){var _=V[M],T=obj.formula[_];for(j[_]&&(_=j[_]),S[_]=[],L=0;L<T.length;L++){var z=T[L];j[z]&&(z=j[z]),S[_].push(z)}}obj.formula=S},obj.updateFormula=function(j,M){for(var L=/[A-Z]/,T=/[0-9]/,O="",S=null,V=null,_="",z=0;z<j.length;z++)L.exec(j[z])?(S=1,V=0,_+=j[z]):T.exec(j[z])?(V=S?1:0,_+=j[z]):(S&&V&&(_=M[_]?M[_]:_),O+=_,O+=j[z],S=0,V=0,_="");return _&&(S&&V&&(_=M[_]?M[_]:_),O+=_),O};var secureFormula=function(j){for(var M="",L=0,T=0;T<j.length;T++)'"'==j[T]&&(L=0==L?1:0),M+=1==L?j[T]:j[T].toUpperCase();return M};obj.executeFormula=function(expression,x,y){var formulaResults=[],formulaLoopProtection=[],execute=function(expression,x,y){var parentId=jexcel.getColumnNameFromId([x,y]);if(formulaLoopProtection[parentId])return console.error("Reference loop detected"),"#ERROR";formulaLoopProtection[parentId]=!0;var tokensUpdate=function(j){for(var M=0;M<j.length;M++){var L=[],T=j[M].split(":"),O=jexcel.getIdFromColumnName(T[0],!0),S=jexcel.getIdFromColumnName(T[1],!0);if(O[0]<=S[0])var V=O[0],_=S[0];else V=S[0],_=O[0];if(O[1]<=S[1])var z=O[1],W=S[1];else z=S[1],W=O[1];for(var te=z;te<=W;te++)for(var ee=V;ee<=_;ee++)L.push(jexcel.getColumnNameFromId([ee,te]));expression=expression.replace(j[M],L.join(","))}};expression=expression.replace(/\$?([A-Z]+)\$?([0-9]+)/g,"$1$2");var tokens=expression.match(/([A-Z]+[0-9]+)\:([A-Z]+[0-9]+)/g);tokens&&tokens.length&&tokensUpdate(tokens);var tokens=expression.match(/([A-Z]+[0-9]+)/g);if(tokens&&tokens.indexOf(parentId)>-1)return console.error("Self Reference detected"),"#ERROR";var formulaExpressions={};if(tokens)for(var i=0;i<tokens.length;i++)if(obj.formula[tokens[i]]||(obj.formula[tokens[i]]=[]),obj.formula[tokens[i]].indexOf(parentId)<0&&obj.formula[tokens[i]].push(parentId),eval("typeof("+tokens[i]+') == "undefined"')){var position=jexcel.getIdFromColumnName(tokens[i],1);if(void 0!==obj.options.data[position[1]]&&void 0!==obj.options.data[position[1]][position[0]])var value=obj.options.data[position[1]][position[0]];else var value="";if("="==(""+value).substr(0,1)&&(formulaResults[tokens[i]]?value=formulaResults[tokens[i]]:(value=execute(value,position[0],position[1]),formulaResults[tokens[i]]=value)),""==(""+value).trim())formulaExpressions[tokens[i]]=null;else if(value==Number(value)&&1==obj.options.autoCasting)formulaExpressions[tokens[i]]=Number(value);else{var number=obj.parseNumber(value,position[0]);formulaExpressions[tokens[i]]=1==obj.options.autoCasting&&number?number:'"'+value+'"'}}try{var res=jexcel.formula(expression.substr(1),formulaExpressions,x,y,obj)}catch(j){var res="#ERROR";console.log(j)}return res};return execute(expression,x,y)},obj.parseNumber=function(j,M){var T=""+j;return(T=T.split(M&&obj.options.columns[M].decimal?obj.options.columns[M].decimal:"."))[0]=T[0].match(/[+-]?[0-9]/g),T[0]&&(T[0]=T[0].join("")),T[1]&&(T[1]=T[1].match(/[0-9]*/g).join("")),T[0]&&Number(T[0])>=0?Number(T[1]?T[0]+"."+T[1]:T[0]+".00"):null},obj.row=function(j){},obj.col=function(j){},obj.up=function(j,M){if(j?obj.selectedCell[3]>0&&obj.up.visible(1,M?0:1):(obj.selectedCell[1]>0&&obj.up.visible(0,M?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)if(0==obj.selectedCell[1]||0==obj.selectedCell[3])obj.loadPage(0),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else if(obj.loadValidation())obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]);else{var L=parseInt(obj.tbody.firstChild.getAttribute("data-y"));obj.selectedCell[1]-L<30&&(obj.loadUp(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]))}else if(obj.options.pagination>0){var T=obj.whichPage(obj.selectedCell[3]);T!=obj.pageNumber&&obj.page(T)}obj.updateScroll(1)},obj.up.visible=function(j,M){if(0==j)var L=parseInt(obj.selectedCell[0]),T=parseInt(obj.selectedCell[1]);else L=parseInt(obj.selectedCell[2]),T=parseInt(obj.selectedCell[3]);if(0==M){for(var O=0;O<T;O++)if("none"!=obj.records[O][L].style.display&&"none"!=obj.rows[O].style.display){T=O;break}}else T=obj.up.get(L,T);0==j?(obj.selectedCell[0]=L,obj.selectedCell[1]=T):(obj.selectedCell[2]=L,obj.selectedCell[3]=T)},obj.up.get=function(j,M){j=parseInt(j);for(var L=(M=parseInt(M))-1;L>=0;L--)if("none"!=obj.records[L][j].style.display&&"none"!=obj.rows[L].style.display){if(obj.records[L][j].getAttribute("data-merged")&&obj.records[L][j]==obj.records[M][j])continue;M=L;break}return M},obj.down=function(j,M){if(j?obj.selectedCell[3]<obj.records.length-1&&obj.down.visible(1,M?0:1):(obj.selectedCell[1]<obj.records.length-1&&obj.down.visible(0,M?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),1==obj.options.lazyLoading)obj.selectedCell[1]==obj.records.length-1||obj.selectedCell[3]==obj.records.length-1?(obj.loadPage(-1),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])):obj.loadValidation()?obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]):parseInt(obj.tbody.lastChild.getAttribute("data-y"))-obj.selectedCell[3]<30&&(obj.loadDown(),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]));else if(obj.options.pagination>0){var T=obj.whichPage(obj.selectedCell[3]);T!=obj.pageNumber&&obj.page(T)}obj.updateScroll(3)},obj.down.visible=function(j,M){if(0==j)var L=parseInt(obj.selectedCell[0]),T=parseInt(obj.selectedCell[1]);else L=parseInt(obj.selectedCell[2]),T=parseInt(obj.selectedCell[3]);if(0==M){for(var O=obj.rows.length-1;O>T;O--)if("none"!=obj.records[O][L].style.display&&"none"!=obj.rows[O].style.display){T=O;break}}else T=obj.down.get(L,T);0==j?(obj.selectedCell[0]=L,obj.selectedCell[1]=T):(obj.selectedCell[2]=L,obj.selectedCell[3]=T)},obj.down.get=function(j,M){j=parseInt(j);for(var L=(M=parseInt(M))+1;L<obj.rows.length;L++)if("none"!=obj.records[L][j].style.display&&"none"!=obj.rows[L].style.display){if(obj.records[L][j].getAttribute("data-merged")&&obj.records[L][j]==obj.records[M][j])continue;M=L;break}return M},obj.right=function(j,M){j?obj.selectedCell[2]<obj.headers.length-1&&obj.right.visible(1,M?0:1):(obj.selectedCell[0]<obj.headers.length-1&&obj.right.visible(0,M?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(2)},obj.right.visible=function(j,M){if(0==j)var L=parseInt(obj.selectedCell[0]),T=parseInt(obj.selectedCell[1]);else L=parseInt(obj.selectedCell[2]),T=parseInt(obj.selectedCell[3]);if(0==M){for(var O=obj.headers.length-1;O>L;O--)if("none"!=obj.records[T][O].style.display){L=O;break}}else L=obj.right.get(L,T);0==j?(obj.selectedCell[0]=L,obj.selectedCell[1]=T):(obj.selectedCell[2]=L,obj.selectedCell[3]=T)},obj.right.get=function(j,M){j=parseInt(j),M=parseInt(M);for(var L=j+1;L<obj.headers.length;L++)if("none"!=obj.records[M][L].style.display){if(obj.records[M][L].getAttribute("data-merged")&&obj.records[M][L]==obj.records[M][j])continue;j=L;break}return j},obj.left=function(j,M){j?obj.selectedCell[2]>0&&obj.left.visible(1,M?0:1):(obj.selectedCell[0]>0&&obj.left.visible(0,M?0:1),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(0)},obj.left.visible=function(j,M){if(0==j)var L=parseInt(obj.selectedCell[0]),T=parseInt(obj.selectedCell[1]);else L=parseInt(obj.selectedCell[2]),T=parseInt(obj.selectedCell[3]);if(0==M){for(var O=0;O<L;O++)if("none"!=obj.records[T][O].style.display){L=O;break}}else L=obj.left.get(L,T);0==j?(obj.selectedCell[0]=L,obj.selectedCell[1]=T):(obj.selectedCell[2]=L,obj.selectedCell[3]=T)},obj.left.get=function(j,M){j=parseInt(j),M=parseInt(M);for(var L=j-1;L>=0;L--)if("none"!=obj.records[M][L].style.display){if(obj.records[M][L].getAttribute("data-merged")&&obj.records[M][L]==obj.records[M][j])continue;j=L;break}return j},obj.first=function(j,M){if(j?M?obj.selectedCell[3]=0:obj.left.visible(1,0):(M?obj.selectedCell[1]=0:obj.left.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||0!=obj.selectedCell[1]&&0!=obj.selectedCell[3]){if(obj.options.pagination>0){var L=obj.whichPage(obj.selectedCell[3]);L!=obj.pageNumber&&obj.page(L)}}else obj.loadPage(0);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(1)},obj.last=function(j,M){if(j?M?obj.selectedCell[3]=obj.records.length-1:obj.right.visible(1,0):(M?obj.selectedCell[1]=obj.records.length-1:obj.right.visible(0,0),obj.selectedCell[2]=obj.selectedCell[0],obj.selectedCell[3]=obj.selectedCell[1]),1!=obj.options.lazyLoading||obj.selectedCell[1]!=obj.records.length-1&&obj.selectedCell[3]!=obj.records.length-1){if(obj.options.pagination>0){var L=obj.whichPage(obj.selectedCell[3]);L!=obj.pageNumber&&obj.page(L)}}else obj.loadPage(-1);obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3]),obj.updateScroll(3)},obj.selectAll=function(){obj.selectedCell||(obj.selectedCell=[]),obj.selectedCell[0]=0,obj.selectedCell[1]=0,obj.selectedCell[2]=obj.headers.length-1,obj.selectedCell[3]=obj.records.length-1,obj.updateSelectionFromCoords(obj.selectedCell[0],obj.selectedCell[1],obj.selectedCell[2],obj.selectedCell[3])},obj.loadPage=function(j){if(1==obj.options.search&&obj.results)var M=obj.results;else M=obj.rows;var L=100;(null==j||-1==j)&&(j=Math.ceil(M.length/L)-1);var T=j*L,O=j*L+L;O>M.length&&(O=M.length),(T=O-100)<0&&(T=0);for(var S=T;S<O;S++)obj.tbody.appendChild(1==obj.options.search&&obj.results?obj.rows[M[S]]:obj.rows[S]),obj.tbody.children.length>L&&obj.tbody.removeChild(obj.tbody.firstChild)},obj.loadUp=function(){if(1==obj.options.search&&obj.results)var j=obj.results;else j=obj.rows;var M=0;if(j.length>100){var L=parseInt(obj.tbody.firstChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(L=j.indexOf(L)),L>0)for(var T=0;T<30;T++)(L-=1)>-1&&(obj.tbody.insertBefore(1==obj.options.search&&obj.results?obj.rows[j[L]]:obj.rows[L],obj.tbody.firstChild),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.lastChild),M=1))}return M},obj.loadDown=function(){if(1==obj.options.search&&obj.results)var j=obj.results;else j=obj.rows;var M=0;if(j.length>100){var L=parseInt(obj.tbody.lastChild.getAttribute("data-y"));if(1==obj.options.search&&obj.results&&(L=j.indexOf(L)),L<obj.rows.length-1)for(var T=0;T<=30;T++)L<j.length&&(obj.tbody.appendChild(1==obj.options.search&&obj.results?obj.rows[j[L]]:obj.rows[L]),obj.tbody.children.length>100&&(obj.tbody.removeChild(obj.tbody.firstChild),M=1)),L+=1}return M},obj.loadValidation=function(){if(obj.selectedCell){var j=parseInt(obj.tbody.firstChild.getAttribute("data-y"))/100,M=parseInt(obj.selectedCell[3]/100),L=parseInt(obj.rows.length/100);if(j!=M&&M<=L&&!Array.prototype.indexOf.call(obj.tbody.children,obj.rows[obj.selectedCell[3]]))return obj.loadPage(M),!0}return!1},obj.resetSearch=function(){obj.searchInput.value="",obj.search(""),obj.results=null},obj.search=function(j){if(j&&(j=j.toLowerCase()),obj.options.filters&&obj.resetFilters(),obj.resetSelection(),obj.pageNumber=0,obj.results=[],j){var L=function(O){-1==obj.results.indexOf(O)&&obj.results.push(O)};obj.options.data.filter(function(O,S){if(function(O,S,V){for(var _=0;_<O.length;_++)if((""+O[_]).toLowerCase().search(S)>=0||(""+obj.records[V][_].innerHTML).toLowerCase().search(S)>=0)return!0;return!1}(O,j,S)){var V=obj.isRowMerged(S);if(V.length)for(var _=0;_<V.length;_++)for(var z=jexcel.getIdFromColumnName(V[_],!0),W=0;W<obj.options.mergeCells[V[_]][1];W++)L(z[1]+W);else L(S);return!0}return!1})}else obj.results=null;return obj.updateResult()},obj.updateResult=function(){var j,M=0;for(j=1==obj.options.lazyLoading?100:obj.options.pagination>0?obj.options.pagination:obj.results?obj.results.length:obj.rows.length;obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var L=0;L<obj.rows.length;L++)!obj.results||obj.results.indexOf(L)>-1?(M<j&&(obj.tbody.appendChild(obj.rows[L]),M++),obj.rows[L].style.display=""):obj.rows[L].style.display="none";return obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),j},obj.whichPage=function(j){return 1==obj.options.search&&obj.results&&(j=obj.results.indexOf(j)),Math.ceil((parseInt(j)+1)/parseInt(obj.options.pagination))-1},obj.page=function(j){var M=obj.pageNumber;if(1==obj.options.search&&obj.results)var L=obj.results;else L=obj.rows;var T=parseInt(obj.options.pagination);(null==j||-1==j)&&(j=Math.ceil(L.length/T)-1),obj.pageNumber=j;var O=j*T,S=j*T+T;for(S>L.length&&(S=L.length),O<0&&(O=0);obj.tbody.firstChild;)obj.tbody.removeChild(obj.tbody.firstChild);for(var V=O;V<S;V++)obj.tbody.appendChild(1==obj.options.search&&obj.results?obj.rows[L[V]]:obj.rows[V]);obj.options.pagination>0&&obj.updatePagination(),obj.updateCornerPosition(),obj.dispatch("onchangepage",el,j,M)},obj.updatePagination=function(){if(obj.pagination.children[0].innerHTML="",obj.pagination.children[1].innerHTML="",obj.options.pagination){if(1==obj.options.search&&obj.results)var j=obj.results.length;else j=obj.rows.length;if(j){var M=Math.ceil(j/obj.options.pagination);if(obj.pageNumber<6)var L=1,T=M<10?M:10;else M-obj.pageNumber<5?(T=M,(L=M-9)<1&&(L=1)):(L=obj.pageNumber-4,T=obj.pageNumber+5);L>1&&((O=document.createElement("div")).className="jexcel_page",O.innerHTML="<",O.title=1,obj.pagination.children[1].appendChild(O));for(var S=L;S<=T;S++){var O;(O=document.createElement("div")).className="jexcel_page",O.innerHTML=S,obj.pagination.children[1].appendChild(O),obj.pageNumber==S-1&&O.classList.add("jexcel_page_selected")}T<M&&((O=document.createElement("div")).className="jexcel_page",O.innerHTML=">",O.title=M,obj.pagination.children[1].appendChild(O)),obj.pagination.children[0].innerHTML=function(_){var z=Array.prototype.slice.call(arguments,1);return _.replace(/{(\d+)}/g,function(W,te){return void 0!==z[te]?z[te]:W})}(obj.options.text.showingPage,obj.pageNumber+1,M)}else obj.pagination.children[0].innerHTML=obj.options.text.noRecordsFound}},obj.download=function(j){if(0==obj.options.allowExport)console.error("Export not allowed");else{var M="";M+=obj.copy(!1,obj.options.csvDelimiter,!0,j,!0);var L=new Blob(["\ufeff"+M],{type:"text/csv;charset=utf-8;"});if(window.navigator&&window.navigator.msSaveOrOpenBlob)window.navigator.msSaveOrOpenBlob(L,obj.options.csvFileName+".csv");else{var T=document.createElement("a"),O=URL.createObjectURL(L);T.href=O,T.setAttribute("download",obj.options.csvFileName+".csv"),document.body.appendChild(T),T.click(),T.parentNode.removeChild(T)}}},obj.setHistory=function(j){if(1!=obj.ignoreHistory){var M=++obj.historyIndex;obj.history=obj.history=obj.history.slice(0,M+1),obj.history[M]=j}},obj.copy=function(j,M,L,T,O){M||(M="\t");var S=new RegExp(M,"ig"),V=[],_=[],z=[],W=[],te=[],ee=obj.options.data[0].length,Q=obj.options.data.length,Z="",X=!1,se="",oe="",me=0,ce=0;if(O&&1==obj.options.includeHeadersOnDownload||!O&&1==obj.options.includeHeadersOnCopy||T){if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0){Z=obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0]?obj.options.nestedHeaders:[obj.options.nestedHeaders];for(var ge=0;ge<Z.length;ge++){for(var xe=[],Ee=0;Ee<Z[ge].length;Ee++){var Ve=parseInt(Z[ge][Ee].colspan);xe.push(Z[ge][Ee].title);for(var ze=0;ze<Ve-1;ze++)xe.push("")}oe+=xe.join(M)+"\r\n"}}X=!0}for(obj.style=[],ge=0;ge<Q;ge++){for(_=[],z=[],Ee=0;Ee<ee;Ee++)if(!j||obj.records[ge][Ee].classList.contains("highlight")){1==X&&V.push(obj.headers[Ee].innerText);var Re=obj.options.data[ge][Ee];if(Re.match&&(Re.match(S)||Re.match(/,/g)||Re.match(/\n/)||Re.match(/\"/))&&(Re='"'+(Re=Re.replace(new RegExp('"',"g"),'""'))+'"'),_.push(Re),"checkbox"==obj.options.columns[Ee].type||"radio"==obj.options.columns[Ee].type)var be=Re;else(be=1==obj.options.stripHTMLOnCopy?obj.records[ge][Ee].innerText:obj.records[ge][Ee].innerHTML).match&&(be.match(S)||be.match(/,/g)||be.match(/\n/)||be.match(/\"/))&&(be='"'+(be=be.replace(new RegExp('"',"g"),'""'))+'"');z.push(be),Z=(Z=obj.records[ge][Ee].getAttribute("style")).replace("display: none;",""),obj.style.push(Z||"")}_.length&&(X&&(me=_.length,W.push(V.join(M))),W.push(_.join(M))),z.length&&(ce++,X&&(te.push(V.join(M)),X=!1),te.push(z.join(M)))}ee==me&&Q==ce&&(se=oe);var re=se+W.join("\r\n"),ie=se+te.join("\r\n");if(L||(obj.textarea.value=1==obj.options.copyCompatibility?ie:re,obj.textarea.select(),document.execCommand("copy")),obj.data=1==obj.options.copyCompatibility?ie:re,obj.hashString=obj.hash(obj.data),!L){if(obj.removeCopyingSelection(),obj.highlighted)for(Ee=0;Ee<obj.highlighted.length;Ee++)obj.highlighted[Ee].classList.add("copying"),obj.highlighted[Ee].classList.contains("highlight-left")&&obj.highlighted[Ee].classList.add("copying-left"),obj.highlighted[Ee].classList.contains("highlight-right")&&obj.highlighted[Ee].classList.add("copying-right"),obj.highlighted[Ee].classList.contains("highlight-top")&&obj.highlighted[Ee].classList.add("copying-top"),obj.highlighted[Ee].classList.contains("highlight-bottom")&&obj.highlighted[Ee].classList.add("copying-bottom");obj.dispatch("oncopy",el,1==obj.options.copyCompatibility?te:W,obj.hashString)}return obj.data},obj.paste=function(j,M,L){var T=obj.dispatch("onbeforepaste",el,L,j,M);if(!1===T)return!1;T&&(L=T);var O=obj.hash(L),S=O==obj.hashString?obj.style:null;if(1==obj.options.copyCompatibility&&O==obj.hashString&&(L=obj.data),L=obj.parseCSV(L,"\t"),null!=j&&null!=M&&L){for(var V=0,_=0,z=[],W={},te={},ee=0,Q=parseInt(j),Z=parseInt(M),X=null;X=L[_];){for(V=0,Q=parseInt(j);null!=X[V];){var se=obj.updateCell(Q,Z,X[V]);if(z.push(se),obj.updateFormulaChain(Q,Z,z),S&&S[ee]){var oe=jexcel.getColumnNameFromId([Q,Z]);W[oe]=S[ee],te[oe]=obj.getStyle(oe),obj.records[Z][Q].setAttribute("style",S[ee]),ee++}if(null!=X[++V]){if(Q>=obj.headers.length-1){if(1!=obj.options.allowInsertColumn)break;obj.insertColumn()}Q=obj.right.get(Q,Z)}}if(L[++_]){if(Z>=obj.rows.length-1){if(1!=obj.options.allowInsertRow)break;obj.insertRow()}Z=obj.down.get(j,Z)}}obj.updateSelectionFromCoords(j,M,Q,Z),obj.setHistory({action:"setValue",records:z,selection:obj.selectedCell,newStyle:W,oldStyle:te}),obj.updateTable(),obj.dispatch("onpaste",el,L),obj.onafterchanges(el,z)}obj.removeCopyingSelection()},obj.removeCopyingSelection=function(){for(var j=document.querySelectorAll(".jexcel .copying"),M=0;M<j.length;M++)j[M].classList.remove("copying"),j[M].classList.remove("copying-left"),j[M].classList.remove("copying-right"),j[M].classList.remove("copying-top"),j[M].classList.remove("copying-bottom")},obj.historyProcessRow=function(j,M){var L=M.insertBefore?+M.rowNumber:M.rowNumber+1;if(1==obj.options.search&&obj.results&&obj.results.length!=obj.rows.length&&obj.resetSearch(),1==j){for(var T=M.numOfRows,O=L;O<T+L;O++)obj.rows[O].parentNode.removeChild(obj.rows[O]);obj.records.splice(L,T),obj.options.data.splice(L,T),obj.rows.splice(L,T),obj.conditionalSelectionUpdate(1,L,T+L-1)}else{obj.records=jexcel.injectArray(obj.records,L,M.rowRecords),obj.options.data=jexcel.injectArray(obj.options.data,L,M.rowData),obj.rows=jexcel.injectArray(obj.rows,L,M.rowNode);var S=0;for(O=L;O<M.numOfRows+L;O++)obj.tbody.insertBefore(M.rowNode[S],obj.tbody.children[O]),S++}obj.options.pagination>0&&obj.page(obj.pageNumber),obj.updateTableReferences()},obj.historyProcessColumn=function(j,M){var L=M.insertBefore?M.columnNumber:M.columnNumber+1;if(1==j){var T=M.numOfColumns;obj.options.columns.splice(L,T);for(var O=L;O<T+L;O++)obj.headers[O].parentNode.removeChild(obj.headers[O]),obj.colgroup[O].parentNode.removeChild(obj.colgroup[O]);obj.headers.splice(L,T),obj.colgroup.splice(L,T);for(var S=0;S<M.data.length;S++){for(O=L;O<T+L;O++)obj.records[S][O].parentNode.removeChild(obj.records[S][O]);obj.records[S].splice(L,T),obj.options.data[S].splice(L,T)}if(obj.options.footers)for(S=0;S<obj.options.footers.length;S++)obj.options.footers[S].splice(L,T)}else{obj.options.columns=jexcel.injectArray(obj.options.columns,L,M.columns),obj.headers=jexcel.injectArray(obj.headers,L,M.headers),obj.colgroup=jexcel.injectArray(obj.colgroup,L,M.colgroup);var V=0;for(O=L;O<M.numOfColumns+L;O++)obj.headerContainer.insertBefore(M.headers[V],obj.headerContainer.children[O+1]),obj.colgroupContainer.insertBefore(M.colgroup[V],obj.colgroupContainer.children[O+1]),V++;for(S=0;S<M.data.length;S++)for(obj.options.data[S]=jexcel.injectArray(obj.options.data[S],L,M.data[S]),obj.records[S]=jexcel.injectArray(obj.records[S],L,M.records[S]),V=0,O=L;O<M.numOfColumns+L;O++)obj.rows[S].insertBefore(M.records[S][V],obj.rows[S].children[O+1]),V++;if(obj.options.footers)for(S=0;S<obj.options.footers.length;S++)obj.options.footers[S]=jexcel.injectArray(obj.options.footers[S],L,M.footers[S])}if(obj.options.nestedHeaders&&obj.options.nestedHeaders.length>0)if(obj.options.nestedHeaders[0]&&obj.options.nestedHeaders[0][0])for(S=0;S<obj.options.nestedHeaders.length;S++){if(1==j)var _=parseInt(obj.options.nestedHeaders[S][obj.options.nestedHeaders[S].length-1].colspan)-M.numOfColumns;else _=parseInt(obj.options.nestedHeaders[S][obj.options.nestedHeaders[S].length-1].colspan)+M.numOfColumns;obj.options.nestedHeaders[S][obj.options.nestedHeaders[S].length-1].colspan=_,obj.thead.children[S].children[obj.thead.children[S].children.length-1].setAttribute("colspan",_)}else _=1==j?parseInt(obj.options.nestedHeaders[0].colspan)-M.numOfColumns:parseInt(obj.options.nestedHeaders[0].colspan)+M.numOfColumns,obj.options.nestedHeaders[0].colspan=_,obj.thead.children[0].children[obj.thead.children[0].children.length-1].setAttribute("colspan",_);obj.updateTableReferences()},obj.undo=function(){var j=!!obj.ignoreEvents,M=!!obj.ignoreHistory;obj.ignoreEvents=!0,obj.ignoreHistory=!0;var L=[];if(obj.historyIndex>=0){var T=obj.history[obj.historyIndex--];if("insertRow"==T.action)obj.historyProcessRow(1,T);else if("deleteRow"==T.action)obj.historyProcessRow(0,T);else if("insertColumn"==T.action)obj.historyProcessColumn(1,T);else if("deleteColumn"==T.action)obj.historyProcessColumn(0,T);else if("moveRow"==T.action)obj.moveRow(T.newValue,T.oldValue);else if("moveColumn"==T.action)obj.moveColumn(T.newValue,T.oldValue);else if("setMerge"==T.action)obj.removeMerge(T.column,T.data);else if("setStyle"==T.action)obj.setStyle(T.oldValue,null,null,1);else if("setWidth"==T.action)obj.setWidth(T.column,T.oldValue);else if("setHeight"==T.action)obj.setHeight(T.row,T.oldValue);else if("setHeader"==T.action)obj.setHeader(T.column,T.oldValue);else if("setComments"==T.action)obj.setComments(T.column,T.oldValue[0],T.oldValue[1]);else if("orderBy"==T.action){for(var O=[],S=0;S<T.rows.length;S++)O[T.rows[S]]=S;obj.updateOrderArrow(T.column,T.order?0:1),obj.updateOrder(O)}else if("setValue"==T.action){for(var V=0;V<T.records.length;V++)L.push({x:T.records[V].x,y:T.records[V].y,newValue:T.records[V].oldValue}),T.oldStyle&&obj.resetStyle(T.oldStyle);obj.setValue(L),T.selection&&obj.updateSelectionFromCoords(T.selection[0],T.selection[1],T.selection[2],T.selection[3])}}obj.ignoreEvents=j,obj.ignoreHistory=M,obj.dispatch("onundo",el,T)},obj.redo=function(){var j=!!obj.ignoreEvents,M=!!obj.ignoreHistory;if(obj.ignoreEvents=!0,obj.ignoreHistory=!0,obj.historyIndex<obj.history.length-1){var T=obj.history[++obj.historyIndex];if("insertRow"==T.action)obj.historyProcessRow(0,T);else if("deleteRow"==T.action)obj.historyProcessRow(1,T);else if("insertColumn"==T.action)obj.historyProcessColumn(0,T);else if("deleteColumn"==T.action)obj.historyProcessColumn(1,T);else if("moveRow"==T.action)obj.moveRow(T.oldValue,T.newValue);else if("moveColumn"==T.action)obj.moveColumn(T.oldValue,T.newValue);else if("setMerge"==T.action)obj.setMerge(T.column,T.colspan,T.rowspan,1);else if("setStyle"==T.action)obj.setStyle(T.newValue,null,null,1);else if("setWidth"==T.action)obj.setWidth(T.column,T.newValue);else if("setHeight"==T.action)obj.setHeight(T.row,T.newValue);else if("setHeader"==T.action)obj.setHeader(T.column,T.newValue);else if("setComments"==T.action)obj.setComments(T.column,T.newValue[0],T.newValue[1]);else if("orderBy"==T.action)obj.updateOrderArrow(T.column,T.order),obj.updateOrder(T.rows);else if("setValue"==T.action){obj.setValue(T.records);for(var O=0;O<T.records.length;O++)T.oldStyle&&obj.resetStyle(T.newStyle);T.selection&&obj.updateSelectionFromCoords(T.selection[0],T.selection[1],T.selection[2],T.selection[3])}}obj.ignoreEvents=j,obj.ignoreHistory=M,obj.dispatch("onredo",el,T)},obj.getDropDownValue=function(j,M){var L=[];if(obj.options.columns[j]&&obj.options.columns[j].source){for(var T=[],O=obj.options.columns[j].source,S=0;S<O.length;S++)"object"==typeof O[S]?T[O[S].id]=O[S].name:T[O[S]]=O[S];var V=Array.isArray(M)?M:(""+M).split(";");for(S=0;S<V.length;S++)"object"==typeof V[S]?L.push(T[V[S].id]):T[V[S]]&&L.push(T[V[S]])}else console.error("Invalid column");return L.length>0?L.join("; "):""},obj.parseCSV=function(j,M){9==(j=j.replace(/\r?\n$|\r$|\n$/g,"")).charCodeAt(j.length-1)&&(j+="\0"),M=M||",";for(var L=[],T=!1,O=0,S=0,V=0;V<j.length;V++){var _=j[V],z=j[V+1];L[O]=L[O]||[],L[O][S]=L[O][S]||"",'"'==_&&T&&'"'==z?(L[O][S]+=_,++V):'"'!=_?_!=M||T?"\r"!=_||"\n"!=z||T?"\n"==_&&!T||"\r"==_&&!T?(++O,S=0):L[O][S]+=_:(++O,S=0,++V):++S:T=!T}return L},obj.hash=function(j){var L,M=0;if(0===j.length)return M;for(L=0;L<j.length;L++)M=(M<<5)-M+j.charCodeAt(L),M|=0;return M},obj.onafterchanges=function(j,M){obj.dispatch("onafterchanges",j,M)},obj.destroy=function(){jexcel.destroy(el)},obj.init=function(){jexcel.current=obj,"function"==typeof jexcel.build&&(obj.options.root?jexcel.build(obj.options.root):(jexcel.build(document),jexcel.build=null)),el.setAttribute("tabindex",1),el.addEventListener("focus",function(j){jexcel.current&&!obj.selectedCell&&(obj.updateSelectionFromCoords(0,0,0,0),obj.left())}),obj.options.csv?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.csv,method:obj.options.method,data:obj.options.requestVariables,dataType:"text",success:function(j){var M=obj.parseCSV(j,obj.options.csvDelimiter);if(1==obj.options.csvHeaders&&M.length>0)for(var L=M.shift(),T=0;T<L.length;T++)obj.options.columns[T]||(obj.options.columns[T]={type:"text",align:obj.options.defaultColAlign,width:obj.options.defaultColWidth}),void 0===obj.options.columns[T].title&&(obj.options.columns[T].title=L[T]);obj.options.data=M,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.options.url?(1==obj.options.loadingSpin&&jSuites.loading.show(),jSuites.ajax({url:obj.options.url,method:obj.options.method,data:obj.options.requestVariables,dataType:"json",success:function(j){obj.options.data=j.data?j.data:j,obj.prepareTable(),1==obj.options.loadingSpin&&jSuites.loading.hide()}})):obj.prepareTable()},obj.options.contextMenu=options&&null!=options.contextMenu?options.contextMenu:function(j,M,L,T){var O=[];if(null==L)1==obj.options.allowInsertColumn&&O.push({title:obj.options.text.insertANewColumnBefore,onclick:function(){obj.insertColumn(1,parseInt(M),1)}}),1==obj.options.allowInsertColumn&&O.push({title:obj.options.text.insertANewColumnAfter,onclick:function(){obj.insertColumn(1,parseInt(M),0)}}),1==obj.options.allowDeleteColumn&&O.push({title:obj.options.text.deleteSelectedColumns,onclick:function(){obj.deleteColumn(obj.getSelectedColumns().length?void 0:parseInt(M))}}),1==obj.options.allowRenameColumn&&O.push({title:obj.options.text.renameThisColumn,onclick:function(){obj.setHeader(M)}}),1==obj.options.columnSorting&&(O.push({type:"line"}),O.push({title:obj.options.text.orderAscending,onclick:function(){obj.orderBy(M,0)}}),O.push({title:obj.options.text.orderDescending,onclick:function(){obj.orderBy(M,1)}}));else if(1==obj.options.allowInsertRow&&(O.push({title:obj.options.text.insertANewRowBefore,onclick:function(){obj.insertRow(1,parseInt(L),1)}}),O.push({title:obj.options.text.insertANewRowAfter,onclick:function(){obj.insertRow(1,parseInt(L))}})),1==obj.options.allowDeleteRow&&O.push({title:obj.options.text.deleteSelectedRows,onclick:function(){obj.deleteRow(obj.getSelectedRows().length?void 0:parseInt(L))}}),M&&1==obj.options.allowComments){O.push({type:"line"});var S=obj.records[L][M].getAttribute("title")||"";O.push({title:S?obj.options.text.editComments:obj.options.text.addComments,onclick:function(){var V=prompt(obj.options.text.comments,S);V&&obj.setComments([M,L],V)}}),S&&O.push({title:obj.options.text.clearComments,onclick:function(){obj.setComments([M,L],"")}})}return O.push({type:"line"}),O.push({title:obj.options.text.copy,shortcut:"Ctrl + C",onclick:function(){obj.copy(!0)}}),navigator&&navigator.clipboard&&O.push({title:obj.options.text.paste,shortcut:"Ctrl + V",onclick:function(){obj.selectedCell&&navigator.clipboard.readText().then(function(V){V&&jexcel.current.paste(obj.selectedCell[0],obj.selectedCell[1],V)})}}),obj.options.allowExport&&O.push({title:obj.options.text.saveAs,shortcut:"Ctrl + S",onclick:function(){obj.download()}}),obj.options.about&&O.push({title:obj.options.text.about,onclick:function(){!0===obj.options.about?alert(Version().print()):alert(obj.options.about)}}),O},obj.scrollControls=function(j){obj.wheelControls(),obj.options.freezeColumns>0&&obj.content.scrollLeft!=scrollLeft&&obj.updateFreezePosition(),(1==obj.options.lazyLoading||1==obj.options.tableOverflow)&&obj.edition&&"jdropdown"!=j.target.className.substr(0,9)&&obj.closeEditor(obj.edition[0],!0)},obj.wheelControls=function(j){1==obj.options.lazyLoading&&null==jexcel.timeControlLoading&&(jexcel.timeControlLoading=setTimeout(function(){obj.content.scrollTop+obj.content.clientHeight>=obj.content.scrollHeight-10?obj.loadDown()&&(obj.content.scrollTop+obj.content.clientHeight>obj.content.scrollHeight-10&&(obj.content.scrollTop=obj.content.scrollTop-obj.content.clientHeight),obj.updateCornerPosition()):obj.content.scrollTop<=obj.content.clientHeight&&obj.loadUp()&&(obj.content.scrollTop<10&&(obj.content.scrollTop=obj.content.scrollTop+obj.content.clientHeight),obj.updateCornerPosition()),jexcel.timeControlLoading=null},100))},obj.getFreezeWidth=function(){var j=0;if(obj.options.freezeColumns>0)for(var M=0;M<obj.options.freezeColumns;M++)j+=parseInt(obj.options.columns[M].width);return j};var scrollLeft=0;return obj.updateFreezePosition=function(){var j=0;if((scrollLeft=obj.content.scrollLeft)>50)for(var M=0;M<obj.options.freezeColumns;M++){M>0&&(j+=parseInt(obj.options.columns[M-1].width)),obj.headers[M].classList.add("jexcel_freezed"),obj.headers[M].style.left=j+"px";for(var L=0;L<obj.rows.length;L++)if(obj.rows[L]&&obj.records[L][M]){var T=scrollLeft+(M>0?obj.records[L][M-1].style.width:0)-51+"px";obj.records[L][M].classList.add("jexcel_freezed"),obj.records[L][M].style.left=T}}else for(M=0;M<obj.options.freezeColumns;M++)for(obj.headers[M].classList.remove("jexcel_freezed"),obj.headers[M].style.left="",L=0;L<obj.rows.length;L++)obj.records[L][M]&&(obj.records[L][M].classList.remove("jexcel_freezed"),obj.records[L][M].style.left="");obj.updateCornerPosition()},el.addEventListener("DOMMouseScroll",obj.wheelControls),el.addEventListener("mousewheel",obj.wheelControls),el.jexcel=obj,el.jspreadsheet=obj,obj.init(),obj},j;return jexcel.setDictionary=function(j){jSuites.setDictionary(j)},jexcel.setExtensions=function(j){for(var M=Object.keys(j),L=0;L<M.length;L++)"function"==typeof j[M[L]]&&(jexcel[M[L]]=j[M[L]],jexcel.license&&"function"==typeof j[M[L]].license&&j[M[L]].license(jexcel.license))},void 0!==formula&&(jexcel.formula=formula),jexcel.version=Version,jexcel.current=null,jexcel.timeControl=null,jexcel.timeControlLoading=null,jexcel.destroy=function(j,M){if(j.jexcel){var L=j.jexcel.options.root?j.jexcel.options.root:document;j.removeEventListener("DOMMouseScroll",j.jexcel.scrollControls),j.removeEventListener("mousewheel",j.jexcel.scrollControls),j.jexcel=null,j.innerHTML="",M&&(L.removeEventListener("mouseup",jexcel.mouseUpControls),L.removeEventListener("mousedown",jexcel.mouseDownControls),L.removeEventListener("mousemove",jexcel.mouseMoveControls),L.removeEventListener("mouseover",jexcel.mouseOverControls),L.removeEventListener("dblclick",jexcel.doubleClickControls),L.removeEventListener("paste",jexcel.pasteControls),L.removeEventListener("contextmenu",jexcel.contextMenuControls),L.removeEventListener("touchstart",jexcel.touchStartControls),L.removeEventListener("touchend",jexcel.touchEndControls),L.removeEventListener("touchcancel",jexcel.touchEndControls),document.removeEventListener("keydown",jexcel.keyDownControls),jexcel=null)}},jexcel.build=function(j){j.addEventListener("mouseup",jexcel.mouseUpControls),j.addEventListener("mousedown",jexcel.mouseDownControls),j.addEventListener("mousemove",jexcel.mouseMoveControls),j.addEventListener("mouseover",jexcel.mouseOverControls),j.addEventListener("dblclick",jexcel.doubleClickControls),j.addEventListener("paste",jexcel.pasteControls),j.addEventListener("contextmenu",jexcel.contextMenuControls),j.addEventListener("touchstart",jexcel.touchStartControls),j.addEventListener("touchend",jexcel.touchEndControls),j.addEventListener("touchcancel",jexcel.touchEndControls),j.addEventListener("touchmove",jexcel.touchEndControls),document.addEventListener("keydown",jexcel.keyDownControls)},jexcel.keyDownControls=function(j){if(jexcel.current){if(jexcel.current.edition)if(27==j.which)jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!1),j.preventDefault();else if(13==j.which){if("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else if("dropdown"!=jexcel.current.options.columns[jexcel.current.edition[2]].type&&"autocomplete"!=jexcel.current.options.columns[jexcel.current.edition[2]].type)if((1==jexcel.current.options.wordWrap||1==jexcel.current.options.columns[jexcel.current.edition[2]].wordWrap||jexcel.current.options.data[jexcel.current.edition[3]][jexcel.current.edition[2]].length>200)&&j.altKey){var M=jexcel.current.edition[0].children[0],L=jexcel.current.edition[0].children[0].value,T=M.selectionStart;L=L.slice(0,T)+"\n"+L.slice(T),M.value=L,M.focus(),M.selectionStart=T+1,M.selectionEnd=T+1}else jexcel.current.edition[0].children[0].blur()}else 9==j.which&&("calendar"==jexcel.current.options.columns[jexcel.current.edition[2]].type?jexcel.current.closeEditor(jexcel.current.edition[0],!0):jexcel.current.edition[0].children[0].blur());if(!jexcel.current.edition&&jexcel.current.selectedCell)if(37==j.which)jexcel.current.left(j.shiftKey,j.ctrlKey),j.preventDefault();else if(39==j.which)jexcel.current.right(j.shiftKey,j.ctrlKey),j.preventDefault();else if(38==j.which)jexcel.current.up(j.shiftKey,j.ctrlKey),j.preventDefault();else if(40==j.which)jexcel.current.down(j.shiftKey,j.ctrlKey),j.preventDefault();else if(36==j.which)jexcel.current.first(j.shiftKey,j.ctrlKey),j.preventDefault();else if(35==j.which)jexcel.current.last(j.shiftKey,j.ctrlKey),j.preventDefault();else if(32==j.which)1==jexcel.current.options.editable&&jexcel.current.setCheckRadioValue(),j.preventDefault();else if(46==j.which)1==jexcel.current.options.editable&&(jexcel.current.selectedRow?1==jexcel.current.options.allowDeleteRow&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedRows)&&jexcel.current.deleteRow():jexcel.current.selectedHeader?1==jexcel.current.options.allowDeleteColumn&&confirm(jexcel.current.options.text.areYouSureToDeleteTheSelectedColumns)&&jexcel.current.deleteColumn():jexcel.current.setValue(jexcel.current.highlighted,""));else if(13==j.which)j.shiftKey?jexcel.current.up():(1==jexcel.current.options.allowInsertRow&&1==jexcel.current.options.allowManualInsertRow&&jexcel.current.selectedCell[1]==jexcel.current.options.data.length-1&&jexcel.current.insertRow(),jexcel.current.down()),j.preventDefault();else if(9==j.which)j.shiftKey?jexcel.current.left():(1==jexcel.current.options.allowInsertColumn&&1==jexcel.current.options.allowManualInsertColumn&&jexcel.current.selectedCell[0]==jexcel.current.options.data[0].length-1&&jexcel.current.insertColumn(),jexcel.current.right()),j.preventDefault();else if(!j.ctrlKey&&!j.metaKey||j.shiftKey){if(jexcel.current.selectedCell&&1==jexcel.current.options.editable){var O=jexcel.current.selectedCell[1],S=jexcel.current.selectedCell[0];"readonly"!=jexcel.current.options.columns[S].type&&(32==j.keyCode?"checkbox"==jexcel.current.options.columns[S].type||"radio"==jexcel.current.options.columns[S].type?j.preventDefault():jexcel.current.openEditor(jexcel.current.records[O][S],!0):113==j.keyCode?jexcel.current.openEditor(jexcel.current.records[O][S],!1):(8==j.keyCode||j.keyCode>=48&&j.keyCode<=57||j.keyCode>=96&&j.keyCode<=111||j.keyCode>=187&&j.keyCode<=190||(String.fromCharCode(j.keyCode)==j.key||String.fromCharCode(j.keyCode).toLowerCase()==j.key.toLowerCase())&&jexcel.validLetter(String.fromCharCode(j.keyCode)))&&(jexcel.current.openEditor(jexcel.current.records[O][S],!0),"calendar"==jexcel.current.options.columns[S].type&&j.preventDefault()))}}else 65==j.which?(jexcel.current.selectAll(),j.preventDefault()):83==j.which?(jexcel.current.download(),j.preventDefault()):89==j.which?(jexcel.current.redo(),j.preventDefault()):90==j.which?(jexcel.current.undo(),j.preventDefault()):67==j.which?(jexcel.current.copy(!0),j.preventDefault()):88==j.which?(1==jexcel.current.options.editable?jexcel.cutControls():jexcel.copyControls(),j.preventDefault()):86==j.which&&jexcel.pasteControls();else j.target.classList.contains("jexcel_search")&&(jexcel.timeControl&&clearTimeout(jexcel.timeControl),jexcel.timeControl=setTimeout(function(){jexcel.current.search(j.target.value)},200))}},jexcel.isMouseAction=!1,jexcel.mouseDownControls=function(j){if((j=j||window.event).buttons)var M=j.buttons;else M=j.button?j.button:j.which;var L=jexcel.getElement(j.target);if(L[0]?jexcel.current!=L[0].jexcel&&(jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection()),jexcel.current=L[0].jexcel):jexcel.current&&(jexcel.current.edition&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.resetSelection(!0),jexcel.current=null),jexcel.current&&1==M){if(j.target.classList.contains("jexcel_selectall"))jexcel.current&&jexcel.current.selectAll();else if(j.target.classList.contains("jexcel_corner"))1==jexcel.current.options.editable&&(jexcel.current.selectedCorner=!0);else{if(1==L[1]){if(T=j.target.getAttribute("data-x")){var O=j.target.getBoundingClientRect();if(1==jexcel.current.options.columnResize&&O.width-j.offsetX<6){jexcel.current.resizing={mousePosition:j.pageX,column:T,width:O.width},jexcel.current.headers[T].classList.add("resizing");for(var S=0;S<jexcel.current.records.length;S++)jexcel.current.records[S][T]&&jexcel.current.records[S][T].classList.add("resizing")}else if(1==jexcel.current.options.columnDrag&&O.height-j.offsetY<6)if(jexcel.current.isColMerged(T).length)console.error("Jspreadsheet: This column is part of a merged cell.");else for(jexcel.current.resetSelection(),jexcel.current.dragging={element:j.target,column:T,destination:T},jexcel.current.headers[T].classList.add("dragging"),S=0;S<jexcel.current.records.length;S++)jexcel.current.records[S][T]&&jexcel.current.records[S][T].classList.add("dragging");else{if(jexcel.current.selectedHeader&&(j.shiftKey||j.ctrlKey))var V=jexcel.current.selectedHeader,_=T;else jexcel.current.selectedHeader==T&&1==jexcel.current.options.allowRenameColumn&&(jexcel.timeControl=setTimeout(function(){jexcel.current.setHeader(T)},800)),jexcel.current.selectedHeader=T,V=T,_=T;jexcel.current.updateSelectionFromCoords(V,0,_,jexcel.current.options.data.length-1)}}else if(j.target.parentNode.classList.contains("jexcel_nested")){if(j.target.getAttribute("data-column"))var z=j.target.getAttribute("data-column").split(","),W=parseInt(z[0]),te=parseInt(z[z.length-1]);else W=0,te=jexcel.current.options.columns.length-1;jexcel.current.updateSelectionFromCoords(W,0,te,jexcel.current.options.data.length-1)}}else jexcel.current.selectedHeader=!1;if(2==L[1]){var ee=j.target.getAttribute("data-y");if(j.target.classList.contains("jexcel_row"))O=j.target.getBoundingClientRect(),1==jexcel.current.options.rowResize&&O.height-j.offsetY<6?(jexcel.current.resizing={element:j.target.parentNode,mousePosition:j.pageY,row:ee,height:O.height},j.target.parentNode.classList.add("resizing")):1==jexcel.current.options.rowDrag&&O.width-j.offsetX<6?jexcel.current.isRowMerged(ee).length?console.error("Jspreadsheet: This row is part of a merged cell"):1==jexcel.current.options.search&&jexcel.current.results?console.error("Jspreadsheet: Please clear your search before perform this action"):(jexcel.current.resetSelection(),jexcel.current.dragging={element:j.target.parentNode,row:ee,destination:ee},j.target.parentNode.classList.add("dragging")):(jexcel.current.selectedRow&&(j.shiftKey||j.ctrlKey)?(V=jexcel.current.selectedRow,_=ee):(jexcel.current.selectedRow=ee,V=ee,_=ee),jexcel.current.updateSelectionFromCoords(0,V,jexcel.current.options.data[0].length-1,_));else if(j.target.classList.contains("jclose")&&j.target.clientWidth-j.offsetX<50&&j.offsetY<50)jexcel.current.closeEditor(jexcel.current.edition[0],!0);else{var Q=function(X){var se=X.getAttribute("data-x"),oe=X.getAttribute("data-y");return se&&oe?[se,oe]:X.parentNode?Q(X.parentNode):void 0},Z=Q(j.target);if(Z){var T=Z[0];ee=Z[1],jexcel.current.edition&&(jexcel.current.edition[2]!=T||jexcel.current.edition[3]!=ee)&&jexcel.current.closeEditor(jexcel.current.edition[0],!0),jexcel.current.edition||(j.shiftKey?jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],T,ee):jexcel.current.updateSelectionFromCoords(T,ee)),jexcel.current.selectedHeader=null,jexcel.current.selectedRow=null}}}else jexcel.current.selectedRow=!1;j.target.classList.contains("jexcel_page")&&jexcel.current.page("<"==j.target.innerText?0:">"==j.target.innerText?j.target.getAttribute("title")-1:j.target.innerText-1)}jexcel.isMouseAction=!jexcel.current.edition}else jexcel.isMouseAction=!1},jexcel.mouseUpControls=function(j){if(jexcel.current)if(jexcel.current.resizing){if(jexcel.current.resizing.column){var M=jexcel.current.colgroup[jexcel.current.resizing.column].getAttribute("width"),L=jexcel.current.getSelectedColumns();if(L.length>1){for(var T=[],O=0;O<L.length;O++)T.push(parseInt(jexcel.current.colgroup[L[O]].getAttribute("width")));T[L.indexOf(parseInt(jexcel.current.resizing.column))]=jexcel.current.resizing.width,jexcel.current.setWidth(L,M,T)}else jexcel.current.setWidth(jexcel.current.resizing.column,M,jexcel.current.resizing.width);jexcel.current.headers[jexcel.current.resizing.column].classList.remove("resizing");for(var V=0;V<jexcel.current.records.length;V++)jexcel.current.records[V][jexcel.current.resizing.column]&&jexcel.current.records[V][jexcel.current.resizing.column].classList.remove("resizing")}else{jexcel.current.rows[jexcel.current.resizing.row].children[0].classList.remove("resizing");var _=jexcel.current.rows[jexcel.current.resizing.row].getAttribute("height");jexcel.current.setHeight(jexcel.current.resizing.row,_,jexcel.current.resizing.height),jexcel.current.resizing.element.classList.remove("resizing")}jexcel.current.resizing=null}else if(jexcel.current.dragging){if(jexcel.current.dragging){if(jexcel.current.dragging.column){var z=j.target.getAttribute("data-x");for(jexcel.current.headers[jexcel.current.dragging.column].classList.remove("dragging"),V=0;V<jexcel.current.rows.length;V++)jexcel.current.records[V][jexcel.current.dragging.column]&&jexcel.current.records[V][jexcel.current.dragging.column].classList.remove("dragging");for(O=0;O<jexcel.current.headers.length;O++)jexcel.current.headers[O].classList.remove("dragging-left"),jexcel.current.headers[O].classList.remove("dragging-right");z&&jexcel.current.dragging.column!=jexcel.current.dragging.destination&&jexcel.current.moveColumn(jexcel.current.dragging.column,jexcel.current.dragging.destination)}else{if(jexcel.current.dragging.element.nextSibling){var W=parseInt(jexcel.current.dragging.element.nextSibling.getAttribute("data-y"));jexcel.current.dragging.row<W&&(W-=1)}else W=parseInt(jexcel.current.dragging.element.previousSibling.getAttribute("data-y"));jexcel.current.dragging.row!=jexcel.current.dragging.destination&&jexcel.current.moveRow(jexcel.current.dragging.row,W,!0),jexcel.current.dragging.element.classList.remove("dragging")}jexcel.current.dragging=null}}else jexcel.current.selectedCorner&&(jexcel.current.selectedCorner=!1,jexcel.current.selection.length>0&&(jexcel.current.copyData(jexcel.current.selection[0],jexcel.current.selection[jexcel.current.selection.length-1]),jexcel.current.removeCopySelection()));jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null),jexcel.isMouseAction=!1},jexcel.mouseMoveControls=function(j){if((j=j||window.event).buttons)var M=j.buttons;else M=j.button?j.button:j.which;if(M||(jexcel.isMouseAction=!1),jexcel.current)if(1==jexcel.isMouseAction){if(jexcel.current.resizing)if(jexcel.current.resizing.column){var L=j.pageX-jexcel.current.resizing.mousePosition;jexcel.current.resizing.width+L>0&&(jexcel.current.colgroup[jexcel.current.resizing.column].setAttribute("width",jexcel.current.resizing.width+L),jexcel.current.updateCornerPosition())}else{var O=j.pageY-jexcel.current.resizing.mousePosition;jexcel.current.resizing.height+O>0&&(jexcel.current.rows[jexcel.current.resizing.row].setAttribute("height",jexcel.current.resizing.height+O),jexcel.current.updateCornerPosition())}}else{var V=j.target.getAttribute("data-x"),_=j.target.getAttribute("data-y"),z=j.target.getBoundingClientRect();jexcel.current.cursor&&(jexcel.current.cursor.style.cursor="",jexcel.current.cursor=null),j.target.parentNode.parentNode&&j.target.parentNode.parentNode.className&&(j.target.parentNode.parentNode.classList.contains("resizable")&&(j.target&&V&&!_&&z.width-(j.clientX-z.left)<6?(jexcel.current.cursor=j.target,jexcel.current.cursor.style.cursor="col-resize"):j.target&&!V&&_&&z.height-(j.clientY-z.top)<6&&(jexcel.current.cursor=j.target,jexcel.current.cursor.style.cursor="row-resize")),j.target.parentNode.parentNode.classList.contains("draggable")&&(j.target&&!V&&_&&z.width-(j.clientX-z.left)<6||j.target&&V&&!_&&z.height-(j.clientY-z.top)<6)&&(jexcel.current.cursor=j.target,jexcel.current.cursor.style.cursor="move"))}},jexcel.mouseOverControls=function(j){if((j=j||window.event).buttons)var M=j.buttons;else M=j.button?j.button:j.which;if(M||(jexcel.isMouseAction=!1),jexcel.current&&1==jexcel.isMouseAction){var L=jexcel.getElement(j.target);if(L[0]){if(jexcel.current!=L[0].jexcel&&jexcel.current)return!1;var T=j.target.getAttribute("data-x"),O=j.target.getAttribute("data-y");if(jexcel.current.dragging){if(jexcel.current.dragging.column){if(T)if(jexcel.current.isColMerged(T).length)console.error("Jspreadsheet: This column is part of a merged cell.");else{for(var S=0;S<jexcel.current.headers.length;S++)jexcel.current.headers[S].classList.remove("dragging-left"),jexcel.current.headers[S].classList.remove("dragging-right");jexcel.current.dragging.column==T?jexcel.current.dragging.destination=parseInt(T):j.target.clientWidth/2>j.offsetX?(jexcel.current.dragging.destination=jexcel.current.dragging.column<T?parseInt(T)-1:parseInt(T),jexcel.current.headers[T].classList.add("dragging-left")):(jexcel.current.dragging.destination=jexcel.current.dragging.column<T?parseInt(T):parseInt(T)+1,jexcel.current.headers[T].classList.add("dragging-right"))}}else if(O)if(jexcel.current.isRowMerged(O).length)console.error("Jspreadsheet: This row is part of a merged cell.");else{var V=j.target.clientHeight/2>j.offsetY?j.target.parentNode.nextSibling:j.target.parentNode;jexcel.current.dragging.element!=V&&(j.target.parentNode.parentNode.insertBefore(jexcel.current.dragging.element,V),jexcel.current.dragging.destination=Array.prototype.indexOf.call(jexcel.current.dragging.element.parentNode.children,jexcel.current.dragging.element))}}else jexcel.current.resizing||(1==L[1]&&jexcel.current.selectedHeader&&(T=j.target.getAttribute("data-x"),jexcel.current.updateSelectionFromCoords(jexcel.current.selectedHeader,0,T,jexcel.current.options.data.length-1)),2==L[1]&&(j.target.classList.contains("jexcel_row")?jexcel.current.selectedRow&&jexcel.current.updateSelectionFromCoords(0,jexcel.current.selectedRow,jexcel.current.options.data[0].length-1,O):jexcel.current.edition||T&&O&&(jexcel.current.selectedCorner?jexcel.current.updateCopySelection(T,O):jexcel.current.selectedCell&&jexcel.current.updateSelectionFromCoords(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],T,O))))}}jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null)},jexcel.doubleClickControls=function(j){if(jexcel.current)if(j.target.classList.contains("jexcel_corner")){if(jexcel.current.highlighted.length>0){var M=jexcel.current.highlighted[0].getAttribute("data-x"),L=parseInt(jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-y"))+1,T=jexcel.current.highlighted[jexcel.current.highlighted.length-1].getAttribute("data-x");jexcel.current.copyData(jexcel.current.records[L][M],jexcel.current.records[jexcel.current.records.length-1][T])}}else if(j.target.classList.contains("jexcel_column_filter")){var S=j.target.getAttribute("data-x");jexcel.current.openFilter(S)}else{var V=jexcel.getElement(j.target);if(1==V[1]&&1==jexcel.current.options.columnSorting&&(S=j.target.getAttribute("data-x"))&&jexcel.current.orderBy(S),2==V[1]&&1==jexcel.current.options.editable&&!jexcel.current.edition){var _=function(W){if(W.parentNode){var te=W.getAttribute("data-x"),ee=W.getAttribute("data-y");return te&&ee?W:_(W.parentNode)}},z=_(j.target);z&&z.classList.contains("highlight")&&jexcel.current.openEditor(z)}}},jexcel.copyControls=function(j){jexcel.current&&jexcel.copyControls.enabled&&(jexcel.current.edition||jexcel.current.copy(!0))},jexcel.cutControls=function(j){jexcel.current&&(jexcel.current.edition||(jexcel.current.copy(!0),1==jexcel.current.options.editable&&jexcel.current.setValue(jexcel.current.highlighted,"")))},jexcel.pasteControls=function(j){jexcel.current&&jexcel.current.selectedCell&&(jexcel.current.edition||1==jexcel.current.options.editable&&(j&&j.clipboardData?(jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],j.clipboardData.getData("text")),j.preventDefault()):window.clipboardData&&jexcel.current.paste(jexcel.current.selectedCell[0],jexcel.current.selectedCell[1],window.clipboardData.getData("text"))))},jexcel.contextMenuControls=function(j){if(j=j||window.event,jexcel.current)if(jexcel.current.edition)j.preventDefault();else if(jexcel.current.options.contextMenu&&(jexcel.current.contextMenu.contextmenu.close(),jexcel.current)){var L=j.target.getAttribute("data-x"),T=j.target.getAttribute("data-y");if(L||T){(L<parseInt(jexcel.current.selectedCell[0])||L>parseInt(jexcel.current.selectedCell[2])||T<parseInt(jexcel.current.selectedCell[1])||T>parseInt(jexcel.current.selectedCell[3]))&&jexcel.current.updateSelectionFromCoords(L,T,L,T);var O=jexcel.current.options.contextMenu(jexcel.current,L,T,j);jexcel.current.contextMenu.contextmenu.open(j,O),j.preventDefault()}}},jexcel.touchStartControls=function(j){var M=jexcel.getElement(j.target);if(M[0]?jexcel.current!=M[0].jexcel&&(jexcel.current&&jexcel.current.resetSelection(),jexcel.current=M[0].jexcel):jexcel.current&&(jexcel.current.resetSelection(),jexcel.current=null),jexcel.current&&!jexcel.current.edition){var L=j.target.getAttribute("data-x"),T=j.target.getAttribute("data-y");L&&T&&(jexcel.current.updateSelectionFromCoords(L,T),jexcel.timeControl=setTimeout(function(){jexcel.tmpElement="color"==jexcel.current.options.columns[L].type?null:j.target,jexcel.current.openEditor(j.target,!1,j)},500))}},jexcel.touchEndControls=function(j){jexcel.timeControl&&(clearTimeout(jexcel.timeControl),jexcel.timeControl=null,jexcel.tmpElement&&"INPUT"==jexcel.tmpElement.children[0].tagName&&jexcel.tmpElement.children[0].focus(),jexcel.tmpElement=null)},jexcel.tabs=function(j,M){var L=[];if(j.classList.contains("jexcel_tabs"))var O=j.children[0],S=j.children[1];else{j.innerHTML="",j.classList.add("jexcel_tabs"),j.jexcel=[];var T=document.createElement("div");O=j.appendChild(T),T=document.createElement("div"),S=j.appendChild(T)}for(var V=[],_=[],z=0;z<M.length;z++){V[z]=document.createElement("div"),V[z].classList.add("jexcel_tab");var W=jexcel(V[z],M[z]);S.appendChild(V[z]),L[z]=j.jexcel.push(W),_[z]=document.createElement("div"),_[z].classList.add("jexcel_tab_link"),_[z].setAttribute("data-spreadsheet",j.jexcel.length-1),_[z].innerHTML=M[z].sheetName,_[z].onclick=function(){for(var ee=0;ee<O.children.length;ee++)O.children[ee].classList.remove("selected"),S.children[ee].style.display="none";var Q=this.getAttribute("data-spreadsheet");S.children[Q].style.display="block",O.children[Q].classList.add("selected")},O.appendChild(_[z])}for(var te=0;te<O.children.length;te++)O.children[te].classList.remove("selected"),S.children[te].style.display="none";return O.children[O.children.length-1].classList.add("selected"),S.children[O.children.length-1].style.display="block",L},jexcel.createTabs=jexcel.tabs,jexcel.fromSpreadsheet=function(j,M){var T,L=function(O){var S=[];return O.SheetNames.forEach(function(V){var _={rows:[],columns:[],data:[],style:{}};if(_.sheetName=V,(z=O.Sheets[V]["!cols"])&&z.length)for(var W=0;W<z.length;W++)_.columns[W]={},z[W]&&z[W].wpx&&(_.columns[W].width=z[W].wpx+"px");if((z=O.Sheets[V]["!rows"])&&z.length)for(W=0;W<z.length;W++)z[W]&&z[W].hpx&&(_.rows[W]={},_.rows[W].height=z[W].hpx+"px");if((z=O.Sheets[V]["!merges"])&&z.length>0)for(_.mergeCells=[],W=0;W<z.length;W++){var te=z[W].s.c,ee=z[W].s.r,Q=z[W].e.c,Z=z[W].e.r,X=jexcel.getColumnNameFromId([te,ee]);_.mergeCells[X]=[Q-te+1,Z-ee+1]}var se=0,oe=0,z=Object.keys(O.Sheets[V]);for(W=0;W<z.length;W++)if("!"!=z[W].substr(0,1)){var me=O.Sheets[V][z[W]],ce=jexcel.getIdFromColumnName(z[W],!0);_.data[ce[1]]||(_.data[ce[1]]=[]),_.data[ce[1]][ce[0]]=me.f?"="+me.f:me.w,se<ce[0]&&(se=ce[0]),oe<ce[1]&&(oe=ce[1]),me.style&&Object.keys(me.style).length>0&&(_.style[z[W]]=me.style),me.s&&me.s.fgColor&&(_.style[z[W]]&&(_.style[z[W]]+=";"),_.style[z[W]]+="background-color:#"+me.s.fgColor.rgb)}for(var ge=_.columns,xe=0;xe<=oe;xe++)for(W=0;W<=se;W++)_.data[xe]||(_.data[xe]=[]),_.data[xe][W]||ge<W&&(_.data[xe][W]="");S.push(_)}),S};(T=new XMLHttpRequest).open("GET",j,!0),"undefined"!=typeof Uint8Array?(T.responseType="arraybuffer",T.onload=function(O){var V=new Uint8Array(T.response),_=XLSX.read(V,{type:"array",cellFormula:!0,cellStyles:!0});M(L(_))}):(T.setRequestHeader("Accept-Charset","x-user-defined"),T.onreadystatechange=function(){if(4==T.readyState&&200==T.status){var O=convertResponseBodyToText(T.responseBody),S=XLSX.read(O,{type:"binary",cellFormula:!0,cellStyles:!0});M(L(S))}}),T.send()},jexcel.validLetter=function(j){return j.match(/([\u0041-\u005A\u0061-\u007A\u00AA\u00B5\u00BA\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02C1\u02C6-\u02D1\u02E0-\u02E4\u02EC\u02EE\u0370-\u0374\u0376\u0377\u037A-\u037D\u0386\u0388-\u038A\u038C\u038E-\u03A1\u03A3-\u03F5\u03F7-\u0481\u048A-\u0527\u0531-\u0556\u0559\u0561-\u0587\u05D0-\u05EA\u05F0-\u05F2\u0620-\u064A\u066E\u066F\u0671-\u06D3\u06D5\u06E5\u06E6\u06EE\u06EF\u06FA-\u06FC\u06FF\u0710\u0712-\u072F\u074D-\u07A5\u07B1\u07CA-\u07EA\u07F4\u07F5\u07FA\u0800-\u0815\u081A\u0824\u0828\u0840-\u0858\u08A0\u08A2-\u08AC\u0904-\u0939\u093D\u0950\u0958-\u0961\u0971-\u0977\u0979-\u097F\u0985-\u098C\u098F\u0990\u0993-\u09A8\u09AA-\u09B0\u09B2\u09B6-\u09B9\u09BD\u09CE\u09DC\u09DD\u09DF-\u09E1\u09F0\u09F1\u0A05-\u0A0A\u0A0F\u0A10\u0A13-\u0A28\u0A2A-\u0A30\u0A32\u0A33\u0A35\u0A36\u0A38\u0A39\u0A59-\u0A5C\u0A5E\u0A72-\u0A74\u0A85-\u0A8D\u0A8F-\u0A91\u0A93-\u0AA8\u0AAA-\u0AB0\u0AB2\u0AB3\u0AB5-\u0AB9\u0ABD\u0AD0\u0AE0\u0AE1\u0B05-\u0B0C\u0B0F\u0B10\u0B13-\u0B28\u0B2A-\u0B30\u0B32\u0B33\u0B35-\u0B39\u0B3D\u0B5C\u0B5D\u0B5F-\u0B61\u0B71\u0B83\u0B85-\u0B8A\u0B8E-\u0B90\u0B92-\u0B95\u0B99\u0B9A\u0B9C\u0B9E\u0B9F\u0BA3\u0BA4\u0BA8-\u0BAA\u0BAE-\u0BB9\u0BD0\u0C05-\u0C0C\u0C0E-\u0C10\u0C12-\u0C28\u0C2A-\u0C33\u0C35-\u0C39\u0C3D\u0C58\u0C59\u0C60\u0C61\u0C85-\u0C8C\u0C8E-\u0C90\u0C92-\u0CA8\u0CAA-\u0CB3\u0CB5-\u0CB9\u0CBD\u0CDE\u0CE0\u0CE1\u0CF1\u0CF2\u0D05-\u0D0C\u0D0E-\u0D10\u0D12-\u0D3A\u0D3D\u0D4E\u0D60\u0D61\u0D7A-\u0D7F\u0D85-\u0D96\u0D9A-\u0DB1\u0DB3-\u0DBB\u0DBD\u0DC0-\u0DC6\u0E01-\u0E30\u0E32\u0E33\u0E40-\u0E46\u0E81\u0E82\u0E84\u0E87\u0E88\u0E8A\u0E8D\u0E94-\u0E97\u0E99-\u0E9F\u0EA1-\u0EA3\u0EA5\u0EA7\u0EAA\u0EAB\u0EAD-\u0EB0\u0EB2\u0EB3\u0EBD\u0EC0-\u0EC4\u0EC6\u0EDC-\u0EDF\u0F00\u0F40-\u0F47\u0F49-\u0F6C\u0F88-\u0F8C\u1000-\u102A\u103F\u1050-\u1055\u105A-\u105D\u1061\u1065\u1066\u106E-\u1070\u1075-\u1081\u108E\u10A0-\u10C5\u10C7\u10CD\u10D0-\u10FA\u10FC-\u1248\u124A-\u124D\u1250-\u1256\u1258\u125A-\u125D\u1260-\u1288\u128A-\u128D\u1290-\u12B0\u12B2-\u12B5\u12B8-\u12BE\u12C0\u12C2-\u12C5\u12C8-\u12D6\u12D8-\u1310\u1312-\u1315\u1318-\u135A\u1380-\u138F\u13A0-\u13F4\u1401-\u166C\u166F-\u167F\u1681-\u169A\u16A0-\u16EA\u1700-\u170C\u170E-\u1711\u1720-\u1731\u1740-\u1751\u1760-\u176C\u176E-\u1770\u1780-\u17B3\u17D7\u17DC\u1820-\u1877\u1880-\u18A8\u18AA\u18B0-\u18F5\u1900-\u191C\u1950-\u196D\u1970-\u1974\u1980-\u19AB\u19C1-\u19C7\u1A00-\u1A16\u1A20-\u1A54\u1AA7\u1B05-\u1B33\u1B45-\u1B4B\u1B83-\u1BA0\u1BAE\u1BAF\u1BBA-\u1BE5\u1C00-\u1C23\u1C4D-\u1C4F\u1C5A-\u1C7D\u1CE9-\u1CEC\u1CEE-\u1CF1\u1CF5\u1CF6\u1D00-\u1DBF\u1E00-\u1F15\u1F18-\u1F1D\u1F20-\u1F45\u1F48-\u1F4D\u1F50-\u1F57\u1F59\u1F5B\u1F5D\u1F5F-\u1F7D\u1F80-\u1FB4\u1FB6-\u1FBC\u1FBE\u1FC2-\u1FC4\u1FC6-\u1FCC\u1FD0-\u1FD3\u1FD6-\u1FDB\u1FE0-\u1FEC\u1FF2-\u1FF4\u1FF6-\u1FFC\u2071\u207F\u2090-\u209C\u2102\u2107\u210A-\u2113\u2115\u2119-\u211D\u2124\u2126\u2128\u212A-\u212D\u212F-\u2139\u213C-\u213F\u2145-\u2149\u214E\u2183\u2184\u2C00-\u2C2E\u2C30-\u2C5E\u2C60-\u2CE4\u2CEB-\u2CEE\u2CF2\u2CF3\u2D00-\u2D25\u2D27\u2D2D\u2D30-\u2D67\u2D6F\u2D80-\u2D96\u2DA0-\u2DA6\u2DA8-\u2DAE\u2DB0-\u2DB6\u2DB8-\u2DBE\u2DC0-\u2DC6\u2DC8-\u2DCE\u2DD0-\u2DD6\u2DD8-\u2DDE\u2E2F\u3005\u3006\u3031-\u3035\u303B\u303C\u3041-\u3096\u309D-\u309F\u30A1-\u30FA\u30FC-\u30FF\u3105-\u312D\u3131-\u318E\u31A0-\u31BA\u31F0-\u31FF\u3400-\u4DB5\u4E00-\u9FCC\uA000-\uA48C\uA4D0-\uA4FD\uA500-\uA60C\uA610-\uA61F\uA62A\uA62B\uA640-\uA66E\uA67F-\uA697\uA6A0-\uA6E5\uA717-\uA71F\uA722-\uA788\uA78B-\uA78E\uA790-\uA793\uA7A0-\uA7AA\uA7F8-\uA801\uA803-\uA805\uA807-\uA80A\uA80C-\uA822\uA840-\uA873\uA882-\uA8B3\uA8F2-\uA8F7\uA8FB\uA90A-\uA925\uA930-\uA946\uA960-\uA97C\uA984-\uA9B2\uA9CF\uAA00-\uAA28\uAA40-\uAA42\uAA44-\uAA4B\uAA60-\uAA76\uAA7A\uAA80-\uAAAF\uAAB1\uAAB5\uAAB6\uAAB9-\uAABD\uAAC0\uAAC2\uAADB-\uAADD\uAAE0-\uAAEA\uAAF2-\uAAF4\uAB01-\uAB06\uAB09-\uAB0E\uAB11-\uAB16\uAB20-\uAB26\uAB28-\uAB2E\uABC0-\uABE2\uAC00-\uD7A3\uD7B0-\uD7C6\uD7CB-\uD7FB\uF900-\uFA6D\uFA70-\uFAD9\uFB00-\uFB06\uFB13-\uFB17\uFB1D\uFB1F-\uFB28\uFB2A-\uFB36\uFB38-\uFB3C\uFB3E\uFB40\uFB41\uFB43\uFB44\uFB46-\uFBB1\uFBD3-\uFD3D\uFD50-\uFD8F\uFD92-\uFDC7\uFDF0-\uFDFB\uFE70-\uFE74\uFE76-\uFEFC\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFBE\uFFC2-\uFFC7\uFFCA-\uFFCF\uFFD2-\uFFD7\uFFDA-\uFFDC-\u0400-\u04FF']+)/g)?1:0},jexcel.injectArray=function(j,M,L){return j.slice(0,M).concat(L).concat(j.slice(M))},jexcel.getColumnName=function(j){var M="";return j>701?(M+=String.fromCharCode(64+parseInt(j/676)),M+=String.fromCharCode(64+parseInt(j%676/26))):j>25&&(M+=String.fromCharCode(64+parseInt(j/26))),M+String.fromCharCode(65+j%26)},jexcel.getIdFromColumnName=function(j,M){var L=/^[a-zA-Z]+/.exec(j);if(L){for(var T=0,O=0;O<L[0].length;O++)T+=parseInt(L[0].charCodeAt(O)-64)*Math.pow(26,L[0].length-1-O);--T<0&&(T=0);var S=parseInt(/[0-9]+$/.exec(j));S>0&&S--,j=1==M?[T,S]:T+"-"+S}return j},jexcel.getColumnNameFromId=function(j){return Array.isArray(j)||(j=j.split("-")),jexcel.getColumnName(parseInt(j[0]))+(parseInt(j[1])+1)},jexcel.getElement=function(j){var M=0,L=0;return function T(O){O.className&&O.classList.contains("jexcel_container")&&(L=O),"THEAD"==O.tagName?M=1:"TBODY"==O.tagName&&(M=2),O.parentNode&&(L||T(O.parentNode))}(j),[L,M]},jexcel.doubleDigitFormat=function(j){return 1==(j=""+j).length&&(j="0"+j),j},jexcel.createFromTable=function(j,M){if("TABLE"==j.tagName){M||(M={}),M.columns=[],M.data=[];var L=j.querySelectorAll("colgroup > col");if(L.length)for(var T=0;T<L.length;T++){if(!(O=L[T].style.width))var O=L[T].getAttribute("width");O&&(M.columns[T]||(M.columns[T]={}),M.columns[T].width=O)}var S=function(K){var ae=K.getBoundingClientRect(),ue=ae.width>50?ae.width:50;M.columns[T]||(M.columns[T]={}),M.columns[T].type=K.getAttribute("data-celltype")?K.getAttribute("data-celltype"):"text",M.columns[T].width=ue+"px",M.columns[T].title=K.innerHTML,M.columns[T].align=K.style.textAlign||"center",(ae=K.getAttribute("name"))&&(M.columns[T].name=ae),(ae=K.getAttribute("id"))&&(M.columns[T].id=ae)},V=[],_=j.querySelectorAll(":scope > thead > tr");if(_.length){for(var z=0;z<_.length-1;z++){var W=[];for(T=0;T<_[z].children.length;T++){var te={title:_[z].children[T].innerText,colspan:_[z].children[T].getAttribute("colspan")||1};W.push(te)}V.push(W)}for(_=_[_.length-1].children,T=0;T<_.length;T++)S(_[T])}var ee=0,Q={},Z={},X={},se={},oe=j.querySelectorAll(":scope > tr, :scope > tbody > tr");for(z=0;z<oe.length;z++)if(M.data[ee]=[],1!=M.parseTableFirstRowAsHeader||_.length||0!=z){for(T=0;T<oe[z].children.length;T++){if(me=oe[z].children[T].getAttribute("data-formula"))"="!=me.substr(0,1)&&(me="="+me);else var me=oe[z].children[T].innerHTML;M.data[ee].push(me);var ce=jexcel.getColumnNameFromId([T,z]),ge=oe[z].children[T].getAttribute("class");ge&&(se[ce]=ge);var xe=parseInt(oe[z].children[T].getAttribute("colspan"))||0,Ee=parseInt(oe[z].children[T].getAttribute("rowspan"))||0;(xe||Ee)&&(Q[ce]=[xe||1,Ee||1]),oe[z].children[T].style&&"none"==oe[z].children[T].style.display&&(oe[z].children[T].style.display="");var Ve=oe[z].children[T].getAttribute("style");Ve&&(X[ce]=Ve),oe[z].children[T].classList.contains("styleBold")&&(X[ce]?X[ce]+="; font-weight:bold;":X[ce]="font-weight:bold;")}oe[z].style&&oe[z].style.height&&(Z[z]={height:oe[z].style.height}),ee++}else for(T=0;T<oe[z].children.length;T++)S(oe[z].children[T]);if(Object.keys(V).length>0&&(M.nestedHeaders=V),Object.keys(X).length>0&&(M.style=X),Object.keys(Q).length>0&&(M.mergeCells=Q),Object.keys(Z).length>0&&(M.rows=Z),Object.keys(se).length>0&&(M.classes=se),(oe=j.querySelectorAll("tfoot tr")).length){var ze=[];for(z=0;z<oe.length;z++){var Re=[];for(T=0;T<oe[z].children.length;T++)Re.push(oe[z].children[T].innerText);ze.push(Re)}Object.keys(ze).length>0&&(M.footers=ze)}if(1==M.parseTableAutoCellType){var be=[];for(T=0;T<M.columns.length;T++){var re=!0,ie=!0;for(be[T]=[],z=0;z<M.data.length;z++)be[T][me=M.data[z][T]]||(be[T][me]=0),be[T][me]++,me.length>25&&(re=!1),10==me.length&&"-"==me.substr(4,1)&&"-"==me.substr(7,1)||(ie=!1);var he=Object.keys(be[T]).length;ie?M.columns[T].type="calendar":1==re&&he>1&&he<=parseInt(.1*M.data.length)&&(M.columns[T].type="dropdown",M.columns[T].source=Object.keys(be[T]))}}return M}console.log("Element is not a table")},"undefined"!=typeof jQuery&&function(j){j.fn.jspreadsheet=j.fn.jexcel=function(M){var L=j(this).get(0);return L.jexcel?Array.isArray(L.jexcel)?L.jexcel[M][arguments[1]].apply(this,Array.prototype.slice.call(arguments,2)):L.jexcel[M].apply(this,Array.prototype.slice.call(arguments,1)):jexcel(j(this).get(0),arguments[0])}}(jQuery),jexcel},"object"==typeof exports&&void 0!==module?module.exports=M():"function"==typeof define&&define.amd?define(M):j.jspreadsheet=j.jexcel=M()},{"@jspreadsheet/formula":1,jsuites:2}]},{},[3])(3)},module.exports=j()},851:(j,M,L)=>{"use strict";function T(r){return"function"==typeof r}let O=!1;const S={Promise:void 0,set useDeprecatedSynchronousErrorHandling(r){if(r){const o=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+o.stack)}else O&&console.log("RxJS: Back to a better error behavior. Thank you. <3");O=r},get useDeprecatedSynchronousErrorHandling(){return O}};function V(r){setTimeout(()=>{throw r},0)}const _={closed:!0,next(r){},error(r){if(S.useDeprecatedSynchronousErrorHandling)throw r;V(r)},complete(){}},z=Array.isArray||(r=>r&&"number"==typeof r.length);function W(r){return null!==r&&"object"==typeof r}const ee=(()=>{function r(o){return Error.call(this),this.message=o?`${o.length} errors occurred during unsubscription:\n${o.map((s,u)=>`${u+1}) ${s.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=o,this}return r.prototype=Object.create(Error.prototype),r})();class Q{constructor(o){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,o&&(this._ctorUnsubscribe=!0,this._unsubscribe=o)}unsubscribe(){let o;if(this.closed)return;let{_parentOrParents:s,_ctorUnsubscribe:u,_unsubscribe:v,_subscriptions:N}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,s instanceof Q)s.remove(this);else if(null!==s)for(let R=0;R<s.length;++R)s[R].remove(this);if(T(v)){u&&(this._unsubscribe=void 0);try{v.call(this)}catch(R){o=R instanceof ee?Z(R.errors):[R]}}if(z(N)){let R=-1,P=N.length;for(;++R<P;){const H=N[R];if(W(H))try{H.unsubscribe()}catch(U){o=o||[],U instanceof ee?o=o.concat(Z(U.errors)):o.push(U)}}}if(o)throw new ee(o)}add(o){let s=o;if(!o)return Q.EMPTY;switch(typeof o){case"function":s=new Q(o);case"object":if(s===this||s.closed||"function"!=typeof s.unsubscribe)return s;if(this.closed)return s.unsubscribe(),s;if(!(s instanceof Q)){const N=s;s=new Q,s._subscriptions=[N]}break;default:throw new Error("unrecognized teardown "+o+" added to Subscription.")}let{_parentOrParents:u}=s;if(null===u)s._parentOrParents=this;else if(u instanceof Q){if(u===this)return s;s._parentOrParents=[u,this]}else{if(-1!==u.indexOf(this))return s;u.push(this)}const v=this._subscriptions;return null===v?this._subscriptions=[s]:v.push(s),s}remove(o){const s=this._subscriptions;if(s){const u=s.indexOf(o);-1!==u&&s.splice(u,1)}}}var r;function Z(r){return r.reduce((o,s)=>o.concat(s instanceof ee?s.errors:s),[])}Q.EMPTY=((r=new Q).closed=!0,r);const X="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random();class oe extends Q{constructor(o,s,u){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=_;break;case 1:if(!o){this.destination=_;break}if("object"==typeof o){o instanceof oe?(this.syncErrorThrowable=o.syncErrorThrowable,this.destination=o,o.add(this)):(this.syncErrorThrowable=!0,this.destination=new me(this,o));break}default:this.syncErrorThrowable=!0,this.destination=new me(this,o,s,u)}}[X](){return this}static create(o,s,u){const v=new oe(o,s,u);return v.syncErrorThrowable=!1,v}next(o){this.isStopped||this._next(o)}error(o){this.isStopped||(this.isStopped=!0,this._error(o))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(o){this.destination.next(o)}_error(o){this.destination.error(o),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:o}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=o,this}}class me extends oe{constructor(o,s,u,v){super(),this._parentSubscriber=o;let N,R=this;T(s)?N=s:s&&(N=s.next,u=s.error,v=s.complete,s!==_&&(R=Object.create(s),T(R.unsubscribe)&&this.add(R.unsubscribe.bind(R)),R.unsubscribe=this.unsubscribe.bind(this))),this._context=R,this._next=N,this._error=u,this._complete=v}next(o){if(!this.isStopped&&this._next){const{_parentSubscriber:s}=this;S.useDeprecatedSynchronousErrorHandling&&s.syncErrorThrowable?this.__tryOrSetError(s,this._next,o)&&this.unsubscribe():this.__tryOrUnsub(this._next,o)}}error(o){if(!this.isStopped){const{_parentSubscriber:s}=this,{useDeprecatedSynchronousErrorHandling:u}=S;if(this._error)u&&s.syncErrorThrowable?(this.__tryOrSetError(s,this._error,o),this.unsubscribe()):(this.__tryOrUnsub(this._error,o),this.unsubscribe());else if(s.syncErrorThrowable)u?(s.syncErrorValue=o,s.syncErrorThrown=!0):V(o),this.unsubscribe();else{if(this.unsubscribe(),u)throw o;V(o)}}}complete(){if(!this.isStopped){const{_parentSubscriber:o}=this;if(this._complete){const s=()=>this._complete.call(this._context);S.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable?(this.__tryOrSetError(o,s),this.unsubscribe()):(this.__tryOrUnsub(s),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(o,s){try{o.call(this._context,s)}catch(u){if(this.unsubscribe(),S.useDeprecatedSynchronousErrorHandling)throw u;V(u)}}__tryOrSetError(o,s,u){if(!S.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{s.call(this._context,u)}catch(v){return S.useDeprecatedSynchronousErrorHandling?(o.syncErrorValue=v,o.syncErrorThrown=!0,!0):(V(v),!0)}return!1}_unsubscribe(){const{_parentSubscriber:o}=this;this._context=null,this._parentSubscriber=null,o.unsubscribe()}}const xe="function"==typeof Symbol&&Symbol.observable||"@@observable";function Ee(r){return r}let Re=(()=>{class r{constructor(s){this._isScalar=!1,s&&(this._subscribe=s)}lift(s){const u=new r;return u.source=this,u.operator=s,u}subscribe(s,u,v){const{operator:N}=this,R=function(r,o,s){if(r){if(r instanceof oe)return r;if(r[X])return r[X]()}return r||o||s?new oe(r,o,s):new oe(_)}(s,u,v);if(R.add(N?N.call(R,this.source):this.source||S.useDeprecatedSynchronousErrorHandling&&!R.syncErrorThrowable?this._subscribe(R):this._trySubscribe(R)),S.useDeprecatedSynchronousErrorHandling&&R.syncErrorThrowable&&(R.syncErrorThrowable=!1,R.syncErrorThrown))throw R.syncErrorValue;return R}_trySubscribe(s){try{return this._subscribe(s)}catch(u){S.useDeprecatedSynchronousErrorHandling&&(s.syncErrorThrown=!0,s.syncErrorValue=u),function(r){for(;r;){const{closed:o,destination:s,isStopped:u}=r;if(o||u)return!1;r=s&&s instanceof oe?s:null}return!0}(s)?s.error(u):console.warn(u)}}forEach(s,u){return new(u=be(u))((v,N)=>{let R;R=this.subscribe(P=>{try{s(P)}catch(H){N(H),R&&R.unsubscribe()}},N,v)})}_subscribe(s){const{source:u}=this;return u&&u.subscribe(s)}[xe](){return this}pipe(...s){return 0===s.length?this:function(r){return 0===r.length?Ee:1===r.length?r[0]:function(s){return r.reduce((u,v)=>v(u),s)}}(s)(this)}toPromise(s){return new(s=be(s))((u,v)=>{let N;this.subscribe(R=>N=R,R=>v(R),()=>u(N))})}}return r.create=o=>new r(o),r})();function be(r){if(r||(r=S.Promise||Promise),!r)throw new Error("no Promise impl found");return r}const ie=(()=>{function r(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return r.prototype=Object.create(Error.prototype),r})();class he extends Q{constructor(o,s){super(),this.subject=o,this.subscriber=s,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const o=this.subject,s=o.observers;if(this.subject=null,!s||0===s.length||o.isStopped||o.closed)return;const u=s.indexOf(this.subscriber);-1!==u&&s.splice(u,1)}}class K extends oe{constructor(o){super(o),this.destination=o}}let ae=(()=>{class r extends Re{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[X](){return new K(this)}lift(s){const u=new ue(this,this);return u.operator=s,u}next(s){if(this.closed)throw new ie;if(!this.isStopped){const{observers:u}=this,v=u.length,N=u.slice();for(let R=0;R<v;R++)N[R].next(s)}}error(s){if(this.closed)throw new ie;this.hasError=!0,this.thrownError=s,this.isStopped=!0;const{observers:u}=this,v=u.length,N=u.slice();for(let R=0;R<v;R++)N[R].error(s);this.observers.length=0}complete(){if(this.closed)throw new ie;this.isStopped=!0;const{observers:s}=this,u=s.length,v=s.slice();for(let N=0;N<u;N++)v[N].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(s){if(this.closed)throw new ie;return super._trySubscribe(s)}_subscribe(s){if(this.closed)throw new ie;return this.hasError?(s.error(this.thrownError),Q.EMPTY):this.isStopped?(s.complete(),Q.EMPTY):(this.observers.push(s),new he(this,s))}asObservable(){const s=new Re;return s.source=this,s}}return r.create=(o,s)=>new ue(o,s),r})();class ue extends ae{constructor(o,s){super(),this.destination=o,this.source=s}next(o){const{destination:s}=this;s&&s.next&&s.next(o)}error(o){const{destination:s}=this;s&&s.error&&this.destination.error(o)}complete(){const{destination:o}=this;o&&o.complete&&this.destination.complete()}_subscribe(o){const{source:s}=this;return s?this.source.subscribe(o):Q.EMPTY}}function Ce(r){return r&&"function"==typeof r.schedule}function je(r,o){return function(u){if("function"!=typeof r)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return u.lift(new pe(r,o))}}class pe{constructor(o,s){this.project=o,this.thisArg=s}call(o,s){return s.subscribe(new Me(o,this.project,this.thisArg))}}class Me extends oe{constructor(o,s,u){super(o),this.project=s,this.count=0,this.thisArg=u||this}_next(o){let s;try{s=this.project.call(this.thisArg,o,this.count++)}catch(u){return void this.destination.error(u)}this.destination.next(s)}}const Se=r=>o=>{for(let s=0,u=r.length;s<u&&!o.closed;s++)o.next(r[s]);o.complete()},Te="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator",De=r=>r&&"number"==typeof r.length&&"function"!=typeof r;function _e(r){return!!r&&"function"!=typeof r.subscribe&&"function"==typeof r.then}const Le=r=>{if(r&&"function"==typeof r[xe])return(r=>o=>{const s=r[xe]();if("function"!=typeof s.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return s.subscribe(o)})(r);if(De(r))return Se(r);if(_e(r))return(r=>o=>(r.then(s=>{o.closed||(o.next(s),o.complete())},s=>o.error(s)).then(null,V),o))(r);if(r&&"function"==typeof r[Te])return(r=>o=>{const s=r[Te]();for(;;){let u;try{u=s.next()}catch(v){return o.error(v),o}if(u.done){o.complete();break}if(o.next(u.value),o.closed)break}return"function"==typeof s.return&&o.add(()=>{s.return&&s.return()}),o})(r);{const s=`You provided ${W(r)?"an invalid object":`'${r}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(s)}};function Dt(r,o){return new Re(s=>{const u=new Q;let v=0;return u.add(o.schedule(function(){v!==r.length?(s.next(r[v++]),s.closed||u.add(this.schedule())):s.complete()})),u})}function Pd(r,o){return o?function(r,o){if(null!=r){if(function(r){return r&&"function"==typeof r[xe]}(r))return function(r,o){return new Re(s=>{const u=new Q;return u.add(o.schedule(()=>{const v=r[xe]();u.add(v.subscribe({next(N){u.add(o.schedule(()=>s.next(N)))},error(N){u.add(o.schedule(()=>s.error(N)))},complete(){u.add(o.schedule(()=>s.complete()))}}))})),u})}(r,o);if(_e(r))return function(r,o){return new Re(s=>{const u=new Q;return u.add(o.schedule(()=>r.then(v=>{u.add(o.schedule(()=>{s.next(v),u.add(o.schedule(()=>s.complete()))}))},v=>{u.add(o.schedule(()=>s.error(v)))}))),u})}(r,o);if(De(r))return Dt(r,o);if(function(r){return r&&"function"==typeof r[Te]}(r)||"string"==typeof r)return function(r,o){if(!r)throw new Error("Iterable cannot be null");return new Re(s=>{const u=new Q;let v;return u.add(()=>{v&&"function"==typeof v.return&&v.return()}),u.add(o.schedule(()=>{v=r[Te](),u.add(o.schedule(function(){if(s.closed)return;let N,R;try{const P=v.next();N=P.value,R=P.done}catch(P){return void s.error(P)}R?s.complete():(s.next(N),this.schedule())}))})),u})}(r,o)}throw new TypeError((null!==r&&typeof r||r)+" is not observable")}(r,o):r instanceof Re?r:new Re(Le(r))}class Bd extends oe{constructor(o){super(),this.parent=o}_next(o){this.parent.notifyNext(o)}_error(o){this.parent.notifyError(o),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class Vd extends oe{notifyNext(o){this.destination.next(o)}notifyError(o){this.destination.error(o)}notifyComplete(){this.destination.complete()}}function Hd(r,o){if(o.closed)return;if(r instanceof Re)return r.subscribe(o);let s;try{s=Le(r)(o)}catch(u){o.error(u)}return s}function Ud(r,o,s=Number.POSITIVE_INFINITY){return"function"==typeof o?u=>u.pipe(Ud((v,N)=>Pd(r(v,N)).pipe(je((R,P)=>o(v,R,N,P))),s)):("number"==typeof o&&(s=o),u=>u.lift(new Rv(r,s)))}class Rv{constructor(o,s=Number.POSITIVE_INFINITY){this.project=o,this.concurrent=s}call(o,s){return s.subscribe(new Ov(o,this.project,this.concurrent))}}class Ov extends Vd{constructor(o,s,u=Number.POSITIVE_INFINITY){super(o),this.project=s,this.concurrent=u,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(o){this.active<this.concurrent?this._tryNext(o):this.buffer.push(o)}_tryNext(o){let s;const u=this.index++;try{s=this.project(o,u)}catch(v){return void this.destination.error(v)}this.active++,this._innerSub(s)}_innerSub(o){const s=new Bd(this),u=this.destination;u.add(s);const v=Hd(o,s);v!==s&&u.add(v)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(o){this.destination.next(o)}notifyComplete(){const o=this.buffer;this.active--,o.length>0?this._next(o.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}function kv(r=Number.POSITIVE_INFINITY){return Ud(Ee,r)}function $d(r,o){return o?Dt(r,o):new Re(Se(r))}function zd(){return function(o){return o.lift(new Bv(o))}}class Bv{constructor(o){this.connectable=o}call(o,s){const{connectable:u}=this;u._refCount++;const v=new Vv(o,u),N=s.subscribe(v);return v.closed||(v.connection=u.connect()),N}}class Vv extends oe{constructor(o,s){super(o),this.connectable=s}_unsubscribe(){const{connectable:o}=this;if(!o)return void(this.connection=null);this.connectable=null;const s=o._refCount;if(s<=0)return void(this.connection=null);if(o._refCount=s-1,s>1)return void(this.connection=null);const{connection:u}=this,v=o._connection;this.connection=null,v&&(!u||v===u)&&v.unsubscribe()}}class Hv extends Re{constructor(o,s){super(),this.source=o,this.subjectFactory=s,this._refCount=0,this._isComplete=!1}_subscribe(o){return this.getSubject().subscribe(o)}getSubject(){const o=this._subject;return(!o||o.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let o=this._connection;return o||(this._isComplete=!1,o=this._connection=new Q,o.add(this.source.subscribe(new $v(this.getSubject(),this))),o.closed&&(this._connection=null,o=Q.EMPTY)),o}refCount(){return zd()(this)}}const Uv=(()=>{const r=Hv.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:r._subscribe},_isComplete:{value:r._isComplete,writable:!0},getSubject:{value:r.getSubject},connect:{value:r.connect},refCount:{value:r.refCount}}})();class $v extends K{constructor(o,s){super(o),this.connectable=s}_error(o){this._unsubscribe(),super._error(o)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const o=this.connectable;if(o){this.connectable=null;const s=o._connection;o._refCount=0,o._subject=null,o._connection=null,s&&s.unsubscribe()}}}function Yv(){return new ae}function ct(r){for(let o in r)if(r[o]===ct)return o;throw Error("Could not find renamed property on target object.")}function ot(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(ot).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const s=o.indexOf("\n");return-1===s?o:o.substring(0,s)}function al(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const Qv=ct({__forward_ref__:ct});function ll(r){return r.__forward_ref__=ll,r.toString=function(){return ot(this())},r}function Ue(r){return function(r){return"function"==typeof r&&r.hasOwnProperty(Qv)&&r.__forward_ref__===ll}(r)?r():r}class Br extends Error{constructor(o,s){super(function(r,o){return`${r?`NG0${r}: `:""}${o}`}(o,s)),this.code=o}}function qt(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():function(r){return"string"==typeof r?r:null==r?"":String(r)}(r)}function ys(r,o){const s=o?` in ${o}`:"";throw new Br("201",`No provider for ${qt(r)} found${s}`)}function cn(r,o){null==r&&function(r,o,s,u){throw new Error(`ASSERTION ERROR: ${r}`+(null==u?"":` [Expected=> ${s} ${u} ${o} <=Actual]`))}(o,r,null,"!=")}function gt(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function wr(r){return{providers:r.providers||[],imports:r.imports||[]}}function pr(r){return Gd(r,Cs)||Gd(r,qd)}function Gd(r,o){return r.hasOwnProperty(o)?r[o]:null}function Yd(r){return r&&(r.hasOwnProperty(cl)||r.hasOwnProperty(ny))?r[cl]:null}const Cs=ct({\u0275prov:ct}),cl=ct({\u0275inj:ct}),qd=ct({ngInjectableDef:ct}),ny=ct({ngInjectorDef:ct});var Ge=(()=>((Ge=Ge||{})[Ge.Default=0]="Default",Ge[Ge.Host=1]="Host",Ge[Ge.Self=2]="Self",Ge[Ge.SkipSelf=4]="SkipSelf",Ge[Ge.Optional=8]="Optional",Ge))();let dl;function Dr(r){const o=dl;return dl=r,o}function Qd(r,o,s){const u=pr(r);return u&&"root"==u.providedIn?void 0===u.value?u.value=u.factory():u.value:s&Ge.Optional?null:void 0!==o?o:void ys(ot(r),"Injector")}function xr(r){return{toString:r}.toString()}var yn=(()=>((yn=yn||{})[yn.OnPush=0]="OnPush",yn[yn.Default=1]="Default",yn))(),Lt=(()=>((Lt=Lt||{})[Lt.Emulated=0]="Emulated",Lt[Lt.None=2]="None",Lt[Lt.ShadowDom=3]="ShadowDom",Lt))();const oy="undefined"!=typeof globalThis&&globalThis,iy="undefined"!=typeof window&&window,sy="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ay="undefined"!=typeof global&&global,dt=oy||ay||iy||sy,lo={},mt=[],js=ct({\u0275cmp:ct}),fl=ct({\u0275dir:ct}),pl=ct({\u0275pipe:ct}),Kd=ct({\u0275mod:ct}),ly=ct({\u0275loc:ct}),hr=ct({\u0275fac:ct}),ci=ct({__NG_ELEMENT_ID__:ct});let uy=0;function hl(r){return xr(()=>{const s={},u={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:s,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===yn.OnPush,directiveDefs:null,pipeDefs:null,selectors:r.selectors||mt,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||Lt.Emulated,id:"c",styles:r.styles||mt,_:null,setInput:null,schemas:r.schemas||null,tView:null},v=r.directives,N=r.features,R=r.pipes;return u.id+=uy++,u.inputs=ef(r.inputs,s),u.outputs=ef(r.outputs),N&&N.forEach(P=>P(u)),u.directiveDefs=v?()=>("function"==typeof v?v():v).map(Xd):null,u.pipeDefs=R?()=>("function"==typeof R?R():R).map(Zd):null,u})}function Xd(r){return Qt(r)||function(r){return r[fl]||null}(r)}function Zd(r){return function(r){return r[pl]||null}(r)}const Jd={};function uo(r){return xr(()=>{const o={type:r.type,bootstrap:r.bootstrap||mt,declarations:r.declarations||mt,imports:r.imports||mt,exports:r.exports||mt,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null};return null!=r.id&&(Jd[r.id]=r.type),o})}function ef(r,o){if(null==r)return lo;const s={};for(const u in r)if(r.hasOwnProperty(u)){let v=r[u],N=v;Array.isArray(v)&&(N=v[1],v=v[0]),s[v]=u,o&&(o[v]=N)}return s}const dn=hl;function Qt(r){return r[js]||null}function Cn(r,o){const s=r[Kd]||null;if(!s&&!0===o)throw new Error(`Type ${ot(r)} does not have '\u0275mod' property.`);return s}function Kn(r){return Array.isArray(r)&&"object"==typeof r[1]}function Fn(r){return Array.isArray(r)&&!0===r[1]}function bl(r){return 0!=(8&r.flags)}function xs(r){return 2==(2&r.flags)}function Ln(r){return null!==r.template}function my(r){return 0!=(512&r[2])}function zr(r,o){return r.hasOwnProperty(hr)?r[hr]:null}class nf{constructor(o,s,u){this.previousValue=o,this.currentValue=s,this.firstChange=u}isFirstChange(){return this.firstChange}}function hi(){return rf}function rf(r){return r.type.prototype.ngOnChanges&&(r.setInput=Cy),yy}function yy(){const r=sf(this),o=null==r?void 0:r.current;if(o){const s=r.previous;if(s===lo)r.previous=o;else for(let u in o)s[u]=o[u];r.current=null,this.ngOnChanges(o)}}function Cy(r,o,s,u){const v=sf(r)||function(r,o){return r[of]=o}(r,{previous:lo,current:null}),N=v.current||(v.current={}),R=v.previous,P=this.declaredInputs[s],H=R[P];N[P]=new nf(H&&H.currentValue,o,R===lo),r[u]=o}hi.ngInherit=!0;const of="__ngSimpleChanges__";function sf(r){return r[of]||null}let Cl;function xt(r){return!!r.listen}const uf={createRenderer:(r,o)=>void 0!==Cl?Cl:"undefined"!=typeof document?document:void 0};function Nt(r){for(;Array.isArray(r);)r=r[0];return r}function wn(r,o){return Nt(o[r.index])}function El(r,o){return r.data[o]}function pn(r,o){const s=o[r];return Kn(s)?s:s[0]}function cf(r){return 4==(4&r[2])}function wl(r){return 128==(128&r[2])}function Ar(r,o){return null==o?null:r[o]}function df(r){r[18]=0}function Dl(r,o){r[5]+=o;let s=r,u=r[3];for(;null!==u&&(1===o&&1===s[5]||-1===o&&0===s[5]);)u[5]+=o,s=u,u=u[3]}const qe={lFrame:yf(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function ff(){return qe.bindingsEnabled}function Ie(){return qe.lFrame.lView}function ut(){return qe.lFrame.tView}function Rt(){let r=pf();for(;null!==r&&64===r.type;)r=r.parent;return r}function pf(){return qe.lFrame.currentTNode}function Xn(r,o){const s=qe.lFrame;s.currentTNode=r,s.isParent=o}function xl(){return qe.lFrame.isParent}function Is(){return qe.isInCheckNoChangesMode}function Ms(r){qe.isInCheckNoChangesMode=r}function Oy(r,o){const s=qe.lFrame;s.bindingIndex=s.bindingRootIndex=r,Al(o)}function Al(r){qe.lFrame.currentDirectiveIndex=r}function mf(){return qe.lFrame.currentQueryIndex}function Ml(r){qe.lFrame.currentQueryIndex=r}function Py(r){const o=r[1];return 2===o.type?o.declTNode:1===o.type?r[6]:null}function bf(r,o,s){if(s&Ge.SkipSelf){let v=o,N=r;for(;!(v=v.parent,null!==v||s&Ge.Host||(v=Py(N),null===v||(N=N[15],10&v.type))););if(null===v)return!1;o=v,r=N}const u=qe.lFrame=vf();return u.currentTNode=o,u.lView=r,!0}function Ts(r){const o=vf(),s=r[1];qe.lFrame=o,o.currentTNode=s.firstChild,o.lView=r,o.tView=s,o.contextLView=r,o.bindingIndex=s.bindingStartIndex,o.inI18n=!1}function vf(){const r=qe.lFrame,o=null===r?null:r.child;return null===o?yf(r):o}function yf(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function Cf(){const r=qe.lFrame;return qe.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const jf=Cf;function Ns(){const r=Cf();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function Xt(){return qe.lFrame.selectedIndex}function Ir(r){qe.lFrame.selectedIndex=r}function Ss(r,o){for(let s=o.directiveStart,u=o.directiveEnd;s<u;s++){const N=r.data[s].type.prototype,{ngAfterContentInit:R,ngAfterContentChecked:P,ngAfterViewInit:H,ngAfterViewChecked:U,ngOnDestroy:Y}=N;R&&(r.contentHooks||(r.contentHooks=[])).push(-s,R),P&&((r.contentHooks||(r.contentHooks=[])).push(s,P),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(s,P)),H&&(r.viewHooks||(r.viewHooks=[])).push(-s,H),U&&((r.viewHooks||(r.viewHooks=[])).push(s,U),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(s,U)),null!=Y&&(r.destroyHooks||(r.destroyHooks=[])).push(s,Y)}}function Fs(r,o,s){Ef(r,o,3,s)}function Ls(r,o,s,u){(3&r[2])===s&&Ef(r,o,s,u)}function Tl(r,o){let s=r[2];(3&s)===o&&(s&=2047,s+=1,r[2]=s)}function Ef(r,o,s,u){const N=null!=u?u:-1,R=o.length-1;let P=0;for(let H=void 0!==u?65535&r[18]:0;H<R;H++)if("number"==typeof o[H+1]){if(P=o[H],null!=u&&P>=u)break}else o[H]<0&&(r[18]+=65536),(P<N||-1==N)&&(Yy(r,s,o,H),r[18]=(4294901760&r[18])+H+2),H++}function Yy(r,o,s,u){const v=s[u]<0,N=s[u+1],P=r[v?-s[u]:s[u]];if(v){if(r[2]>>11<r[18]>>16&&(3&r[2])===o){r[2]+=2048;try{N.call(P)}finally{}}}else try{N.call(P)}finally{}}class mi{constructor(o,s,u){this.factory=o,this.resolving=!1,this.canSeeViewProviders=s,this.injectImpl=u}}function Rs(r,o,s){const u=xt(r);let v=0;for(;v<s.length;){const N=s[v];if("number"==typeof N){if(0!==N)break;v++;const R=s[v++],P=s[v++],H=s[v++];u?r.setAttribute(o,P,H,R):o.setAttributeNS(R,P,H)}else{const R=N,P=s[++v];Sl(R)?u&&r.setProperty(o,R,P):u?r.setAttribute(o,R,P):o.setAttribute(R,P),v++}}return v}function wf(r){return 3===r||4===r||6===r}function Sl(r){return 64===r.charCodeAt(0)}function Os(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let s=-1;for(let u=0;u<o.length;u++){const v=o[u];"number"==typeof v?s=v:0===s||Df(r,s,v,null,-1===s||2===s?o[++u]:null)}}return r}function Df(r,o,s,u,v){let N=0,R=r.length;if(-1===o)R=-1;else for(;N<r.length;){const P=r[N++];if("number"==typeof P){if(P===o){R=-1;break}if(P>o){R=N-1;break}}}for(;N<r.length;){const P=r[N];if("number"==typeof P)break;if(P===s){if(null===u)return void(null!==v&&(r[N+1]=v));if(u===r[N+1])return void(r[N+2]=v)}N++,null!==u&&N++,null!==v&&N++}-1!==R&&(r.splice(R,0,o),N=R+1),r.splice(N++,0,s),null!==u&&r.splice(N++,0,u),null!==v&&r.splice(N++,0,v)}function xf(r){return-1!==r}function bo(r){return 32767&r}function vo(r,o){let s=function(r){return r>>16}(r),u=o;for(;s>0;)u=u[15],s--;return u}let Fl=!0;function ks(r){const o=Fl;return Fl=r,o}let Jy=0;function vi(r,o){const s=Rl(r,o);if(-1!==s)return s;const u=o[1];u.firstCreatePass&&(r.injectorIndex=o.length,Ll(u.data,r),Ll(o,null),Ll(u.blueprint,null));const v=Ps(r,o),N=r.injectorIndex;if(xf(v)){const R=bo(v),P=vo(v,o),H=P[1].data;for(let U=0;U<8;U++)o[N+U]=P[R+U]|H[R+U]}return o[N+8]=v,N}function Ll(r,o){r.push(0,0,0,0,0,0,0,0,o)}function Rl(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function Ps(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let s=0,u=null,v=o;for(;null!==v;){const N=v[1],R=N.type;if(u=2===R?N.declTNode:1===R?v[6]:null,null===u)return-1;if(s++,v=v[15],-1!==u.injectorIndex)return u.injectorIndex|s<<16}return-1}function Bs(r,o,s){!function(r,o,s){let u;"string"==typeof s?u=s.charCodeAt(0)||0:s.hasOwnProperty(ci)&&(u=s[ci]),null==u&&(u=s[ci]=Jy++);const v=255&u;o.data[r+(v>>5)]|=1<<v}(r,o,s)}function If(r,o,s){if(s&Ge.Optional)return r;ys(o,"NodeInjector")}function Mf(r,o,s,u){if(s&Ge.Optional&&void 0===u&&(u=null),0==(s&(Ge.Self|Ge.Host))){const v=r[9],N=Dr(void 0);try{return v?v.get(o,u,s&Ge.Optional):Qd(o,u,s&Ge.Optional)}finally{Dr(N)}}return If(u,o,s)}function Tf(r,o,s,u=Ge.Default,v){if(null!==r){const N=function(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(ci)?r[ci]:void 0;return"number"==typeof o?o>=0?255&o:nC:o}(s);if("function"==typeof N){if(!bf(o,r,u))return u&Ge.Host?If(v,s,u):Mf(o,s,u,v);try{const R=N(u);if(null!=R||u&Ge.Optional)return R;ys(s)}finally{jf()}}else if("number"==typeof N){let R=null,P=Rl(r,o),H=-1,U=u&Ge.Host?o[16][6]:null;for((-1===P||u&Ge.SkipSelf)&&(H=-1===P?Ps(r,o):o[P+8],-1!==H&&Ff(u,!1)?(R=o[1],P=bo(H),o=vo(H,o)):P=-1);-1!==P;){const Y=o[1];if(Sf(N,P,Y.data)){const J=rC(P,o,s,R,u,U);if(J!==Nf)return J}H=o[P+8],-1!==H&&Ff(u,o[1].data[P+8]===U)&&Sf(N,P,o)?(R=Y,P=bo(H),o=vo(H,o)):P=-1}}}return Mf(o,s,u,v)}const Nf={};function nC(){return new yo(Rt(),Ie())}function rC(r,o,s,u,v,N){const R=o[1],P=R.data[r+8],Y=Vs(P,R,s,null==u?xs(P)&&Fl:u!=R&&0!=(3&P.type),v&Ge.Host&&N===P);return null!==Y?yi(o,R,Y,P):Nf}function Vs(r,o,s,u,v){const N=r.providerIndexes,R=o.data,P=1048575&N,H=r.directiveStart,Y=N>>20,ne=v?P+Y:r.directiveEnd;for(let le=u?P:P+Y;le<ne;le++){const fe=R[le];if(le<H&&s===fe||le>=H&&fe.type===s)return le}if(v){const le=R[H];if(le&&Ln(le)&&le.type===s)return H}return null}function yi(r,o,s,u){let v=r[s];const N=o.data;if(function(r){return r instanceof mi}(v)){const R=v;R.resolving&&function(r,o){throw new Br("200",`Circular dependency in DI detected for ${r}`)}(qt(N[s]));const P=ks(R.canSeeViewProviders);R.resolving=!0;const H=R.injectImpl?Dr(R.injectImpl):null;bf(r,u,Ge.Default);try{v=r[s]=R.factory(void 0,N,r,u),o.firstCreatePass&&s>=u.directiveStart&&function(r,o,s){const{ngOnChanges:u,ngOnInit:v,ngDoCheck:N}=o.type.prototype;if(u){const R=rf(o);(s.preOrderHooks||(s.preOrderHooks=[])).push(r,R),(s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(r,R)}v&&(s.preOrderHooks||(s.preOrderHooks=[])).push(0-r,v),N&&((s.preOrderHooks||(s.preOrderHooks=[])).push(r,N),(s.preOrderCheckHooks||(s.preOrderCheckHooks=[])).push(r,N))}(s,N[s],o)}finally{null!==H&&Dr(H),ks(P),R.resolving=!1,jf()}}return v}function Sf(r,o,s){return!!(s[o+(r>>5)]&1<<r)}function Ff(r,o){return!(r&Ge.Self||r&Ge.Host&&o)}class yo{constructor(o,s){this._tNode=o,this._lView=s}get(o,s){return Tf(this._tNode,this._lView,o,void 0,s)}}const jo="__parameters__";function Wr(r,o,s){return xr(()=>{const u=function(r){return function(...s){if(r){const u=r(...s);for(const v in u)this[v]=u[v]}}}(o);function v(...N){if(this instanceof v)return u.apply(this,N),this;const R=new v(...N);return P.annotation=R,P;function P(H,U,Y){const J=H.hasOwnProperty(jo)?H[jo]:Object.defineProperty(H,jo,{value:[]})[jo];for(;J.length<=Y;)J.push(null);return(J[Y]=J[Y]||[]).push(R),H}}return s&&(v.prototype=Object.create(s.prototype)),v.prototype.ngMetadataName=r,v.annotationCls=v,v})}class pt{constructor(o,s){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof s?this.__NG_ELEMENT_ID__=s:void 0!==s&&(this.\u0275prov=gt({token:this,providedIn:s.providedIn||"root",factory:s.factory}))}toString(){return`InjectionToken ${this._desc}`}}function Dn(r,o){void 0===o&&(o=r);for(let s=0;s<r.length;s++){let u=r[s];Array.isArray(u)?(o===r&&(o=r.slice(0,s)),Dn(u,o)):o!==r&&o.push(u)}return o}function Jn(r,o){r.forEach(s=>Array.isArray(s)?Jn(s,o):o(s))}function Us(r,o,s){o>=r.length?r.push(s):r.splice(o,0,s)}function Gr(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}const wi={},Ul="__NG_DI_FLAG__",Do="ngTempTokenPath",bC=/\n/gm,$l="__source",zl=ct({provide:String,useValue:ct});let Di;function xo(r){const o=Di;return Di=r,o}function yC(r,o=Ge.Default){if(void 0===Di)throw new Error("inject() must be called from an injection context");return null===Di?Qd(r,void 0,o):Di.get(r,o&Ge.Optional?null:void 0,o)}function lt(r,o=Ge.Default){return(dl||yC)(Ue(r),o)}function Yr(r){const o=[];for(let s=0;s<r.length;s++){const u=Ue(r[s]);if(Array.isArray(u)){if(0===u.length)throw new Error("Arguments array must have arguments.");let v,N=Ge.Default;for(let R=0;R<u.length;R++){const P=u[R],H=CC(P);"number"==typeof H?-1===H?v=P.token:N|=H:v=P}o.push(lt(v,N))}else o.push(lt(u))}return o}function xi(r,o){return r[Ul]=o,r.prototype[Ul]=o,r}function CC(r){return r[Ul]}function Bf(r,o,s,u){const v=r[Do];throw o[$l]&&v.unshift(o[$l]),r.message=function(r,o,s,u=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.substr(2):r;let v=ot(o);if(Array.isArray(o))v=o.map(ot).join(" -> ");else if("object"==typeof o){let N=[];for(let R in o)if(o.hasOwnProperty(R)){let P=o[R];N.push(R+":"+("string"==typeof P?JSON.stringify(P):ot(P)))}v=`{${N.join(", ")}}`}return`${s}${u?"("+u+")":""}[${v}]: ${r.replace(bC,"\n  ")}`}("\n"+r.message,v,s,u),r.ngTokenPath=v,r[Do]=null,r}const _i=xi(Wr("Inject",r=>({token:r})),-1),er=xi(Wr("Optional"),8),qr=xi(Wr("SkipSelf"),4),ip="__ngContext__";function zt(r,o){r[ip]=o}function Jl(r){const o=function(r){return r[ip]||null}(r);return o?Array.isArray(o)?o:o.lView:null}function Qs(r){return r.ngOriginalError}function p1(r,...o){r.error(...o)}class Kr{constructor(){this._console=console}handleError(o){const s=this._findOriginalError(o),u=this._findContext(o),v=function(r){return r&&r.ngErrorLogger||p1}(o);v(this._console,"ERROR",o),s&&v(this._console,"ORIGINAL ERROR",s),u&&v(this._console,"ERROR CONTEXT",u)}_findContext(o){return o?function(r){return r.ngDebugContext}(o)||this._findContext(Qs(o)):null}_findOriginalError(o){let s=o&&Qs(o);for(;s&&Qs(s);)s=Qs(s);return s||null}}const hp=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(dt))();function rr(r){return r instanceof Function?r():r}var mn=(()=>((mn=mn||{})[mn.Important=1]="Important",mn[mn.DashCase=2]="DashCase",mn))();function nu(r,o){return undefined(r,o)}function Si(r){const o=r[3];return Fn(o)?o[3]:o}function ru(r){return yp(r[13])}function ou(r){return yp(r[4])}function yp(r){for(;null!==r&&!Fn(r);)r=r[4];return r}function Mo(r,o,s,u,v){if(null!=u){let N,R=!1;Fn(u)?N=u:Kn(u)&&(R=!0,u=u[0]);const P=Nt(u);0===r&&null!==s?null==v?xp(o,s,P):Xr(o,s,P,v||null,!0):1===r&&null!==s?Xr(o,s,P,v||null,!0):2===r?function(r,o,s){const u=Xs(r,o);u&&function(r,o,s,u){xt(r)?r.removeChild(o,s,u):o.removeChild(s)}(r,u,o,s)}(o,P,R):3===r&&o.destroyNode(P),null!=N&&function(r,o,s,u,v){const N=s[7];N!==Nt(s)&&Mo(o,r,u,N,v);for(let P=10;P<s.length;P++){const H=s[P];Fi(H[1],H,r,o,u,N)}}(o,r,N,s,v)}}function su(r,o,s){return xt(r)?r.createElement(o,s):null===s?r.createElement(o):r.createElementNS(s,o)}function jp(r,o){const s=r[9],u=s.indexOf(o),v=o[3];1024&o[2]&&(o[2]&=-1025,Dl(v,-1)),s.splice(u,1)}function au(r,o){if(r.length<=10)return;const s=10+o,u=r[s];if(u){const v=u[17];null!==v&&v!==r&&jp(v,u),o>0&&(r[s-1][4]=u[4]);const N=Gr(r,10+o);!function(r,o){Fi(r,o,o[11],2,null,null),o[0]=null,o[6]=null}(u[1],u);const R=N[19];null!==R&&R.detachView(N[1]),u[3]=null,u[4]=null,u[2]&=-129}return u}function Ep(r,o){if(!(256&o[2])){const s=o[11];xt(s)&&s.destroyNode&&Fi(r,o,s,3,null,null),function(r){let o=r[13];if(!o)return lu(r[1],r);for(;o;){let s=null;if(Kn(o))s=o[13];else{const u=o[10];u&&(s=u)}if(!s){for(;o&&!o[4]&&o!==r;)Kn(o)&&lu(o[1],o),o=o[3];null===o&&(o=r),Kn(o)&&lu(o[1],o),s=o&&o[4]}o=s}}(o)}}function lu(r,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function(r,o){let s;if(null!=r&&null!=(s=r.destroyHooks))for(let u=0;u<s.length;u+=2){const v=o[s[u]];if(!(v instanceof mi)){const N=s[u+1];if(Array.isArray(N))for(let R=0;R<N.length;R+=2){const P=v[N[R]],H=N[R+1];try{H.call(P)}finally{}}else try{N.call(v)}finally{}}}}(r,o),function(r,o){const s=r.cleanup,u=o[7];let v=-1;if(null!==s)for(let N=0;N<s.length-1;N+=2)if("string"==typeof s[N]){const R=s[N+1],P="function"==typeof R?R(o):Nt(o[R]),H=u[v=s[N+2]],U=s[N+3];"boolean"==typeof U?P.removeEventListener(s[N],H,U):U>=0?u[v=U]():u[v=-U].unsubscribe(),N+=2}else{const R=u[v=s[N+1]];s[N].call(R)}if(null!==u){for(let N=v+1;N<u.length;N++)u[N]();o[7]=null}}(r,o),1===o[1].type&&xt(o[11])&&o[11].destroy();const s=o[17];if(null!==s&&Fn(o[3])){s!==o[3]&&jp(s,o);const u=o[19];null!==u&&u.detachView(r)}}}function wp(r,o,s){return function(r,o,s){let u=o;for(;null!==u&&40&u.type;)u=(o=u).parent;if(null===u)return s[0];if(2&u.flags){const v=r.data[u.directiveStart].encapsulation;if(v===Lt.None||v===Lt.Emulated)return null}return wn(u,s)}(r,o.parent,s)}function Xr(r,o,s,u,v){xt(r)?r.insertBefore(o,s,u,v):o.insertBefore(s,u,v)}function xp(r,o,s){xt(r)?r.appendChild(o,s):o.appendChild(s)}function _p(r,o,s,u,v){null!==u?Xr(r,o,s,u,v):xp(r,o,s)}function Xs(r,o){return xt(r)?r.parentNode(o):o.parentNode}let Mp=function(r,o,s){return 40&r.type?wn(r,s):null};function Zs(r,o,s,u){const v=wp(r,u,o),N=o[11],P=function(r,o,s){return Mp(r,o,s)}(u.parent||o[6],u,o);if(null!=v)if(Array.isArray(s))for(let H=0;H<s.length;H++)_p(N,v,s[H],P,!1);else _p(N,v,s,P,!1)}function Js(r,o){if(null!==o){const s=o.type;if(3&s)return wn(o,r);if(4&s)return cu(-1,r[o.index]);if(8&s){const u=o.child;if(null!==u)return Js(r,u);{const v=r[o.index];return Fn(v)?cu(-1,v):Nt(v)}}if(32&s)return nu(o,r)()||Nt(r[o.index]);{const u=Np(r,o);return null!==u?Array.isArray(u)?u[0]:Js(Si(r[16]),u):Js(r,o.next)}}return null}function Np(r,o){return null!==o?r[16][6].projection[o.projection]:null}function cu(r,o){const s=10+r+1;if(s<o.length){const u=o[s],v=u[1].firstChild;if(null!==v)return Js(u,v)}return o[7]}function du(r,o,s,u,v,N,R){for(;null!=s;){const P=u[s.index],H=s.type;if(R&&0===o&&(P&&zt(Nt(P),u),s.flags|=4),64!=(64&s.flags))if(8&H)du(r,o,s.child,u,v,N,!1),Mo(o,r,v,P,N);else if(32&H){const U=nu(s,u);let Y;for(;Y=U();)Mo(o,r,v,Y,N);Mo(o,r,v,P,N)}else 16&H?Fp(r,o,u,s,v,N):Mo(o,r,v,P,N);s=R?s.projectionNext:s.next}}function Fi(r,o,s,u,v,N){du(s,u,r.firstChild,o,v,N,!1)}function Fp(r,o,s,u,v,N){const R=s[16],H=R[6].projection[u.projection];if(Array.isArray(H))for(let U=0;U<H.length;U++)Mo(o,r,v,H[U],N);else du(r,o,H,R[3],v,N,!0)}function Lp(r,o,s){xt(r)?r.setAttribute(o,"style",s):o.style.cssText=s}function fu(r,o,s){xt(r)?""===s?r.removeAttribute(o,"class"):r.setAttribute(o,"class",s):o.className=s}function Rp(r,o,s){let u=r.length;for(;;){const v=r.indexOf(o,s);if(-1===v)return v;if(0===v||r.charCodeAt(v-1)<=32){const N=o.length;if(v+N===u||r.charCodeAt(v+N)<=32)return v}s=v+1}}const Op="ng-template";function B1(r,o,s){let u=0;for(;u<r.length;){let v=r[u++];if(s&&"class"===v){if(v=r[u],-1!==Rp(v.toLowerCase(),o,0))return!0}else if(1===v){for(;u<r.length&&"string"==typeof(v=r[u++]);)if(v.toLowerCase()===o)return!0;return!1}}return!1}function kp(r){return 4===r.type&&r.value!==Op}function V1(r,o,s){return o===(4!==r.type||s?r.value:Op)}function H1(r,o,s){let u=4;const v=r.attrs||[],N=function(r){for(let o=0;o<r.length;o++)if(wf(r[o]))return o;return r.length}(v);let R=!1;for(let P=0;P<o.length;P++){const H=o[P];if("number"!=typeof H){if(!R)if(4&u){if(u=2|1&u,""!==H&&!V1(r,H,s)||""===H&&1===o.length){if(Rn(u))return!1;R=!0}}else{const U=8&u?H:o[++P];if(8&u&&null!==r.attrs){if(!B1(r.attrs,U,s)){if(Rn(u))return!1;R=!0}continue}const J=U1(8&u?"class":H,v,kp(r),s);if(-1===J){if(Rn(u))return!1;R=!0;continue}if(""!==U){let ne;ne=J>N?"":v[J+1].toLowerCase();const le=8&u?ne:null;if(le&&-1!==Rp(le,U,0)||2&u&&U!==ne){if(Rn(u))return!1;R=!0}}}}else{if(!R&&!Rn(u)&&!Rn(H))return!1;if(R&&Rn(H))continue;R=!1,u=H|1&u}}return Rn(u)||R}function Rn(r){return 0==(1&r)}function U1(r,o,s,u){if(null===o)return-1;let v=0;if(u||!s){let N=!1;for(;v<o.length;){const R=o[v];if(R===r)return v;if(3===R||6===R)N=!0;else{if(1===R||2===R){let P=o[++v];for(;"string"==typeof P;)P=o[++v];continue}if(4===R)break;if(0===R){v+=4;continue}}v+=N?1:2}return-1}return function(r,o){let s=r.indexOf(4);if(s>-1)for(s++;s<r.length;){const u=r[s];if("number"==typeof u)return-1;if(u===o)return s;s++}return-1}(o,r)}function Pp(r,o,s=!1){for(let u=0;u<o.length;u++)if(H1(r,o[u],s))return!0;return!1}function Bp(r,o){return r?":not("+o.trim()+")":o}function Y1(r){let o=r[0],s=1,u=2,v="",N=!1;for(;s<r.length;){let R=r[s];if("string"==typeof R)if(2&u){const P=r[++s];v+="["+R+(P.length>0?'="'+P+'"':"")+"]"}else 8&u?v+="."+R:4&u&&(v+=" "+R);else""!==v&&!Rn(R)&&(o+=Bp(N,v),v=""),u=R,N=N||!Rn(u);s++}return""!==v&&(o+=Bp(N,v)),o}const Ke={};function Hp(r,o,s,u){if(!u)if(3==(3&o[2])){const N=r.preOrderCheckHooks;null!==N&&Fs(o,N,s)}else{const N=r.preOrderHooks;null!==N&&Ls(o,N,0,s)}Ir(s)}function Xp(r,o){const s=r.contentQueries;if(null!==s)for(let u=0;u<s.length;u+=2){const v=s[u],N=s[u+1];if(-1!==N){const R=r.data[N];Ml(v),R.contentQueries(2,o[N],N)}}}function Li(r,o,s,u,v,N,R,P,H,U){const Y=o.blueprint.slice();return Y[0]=v,Y[2]=140|u,df(Y),Y[3]=Y[15]=r,Y[8]=s,Y[10]=R||r&&r[10],Y[11]=P||r&&r[11],Y[12]=H||r&&r[12]||null,Y[9]=U||r&&r[9]||null,Y[6]=N,Y[16]=2==o.type?r[16]:Y,Y}function To(r,o,s,u,v){let N=r.data[o];if(null===N)N=function(r,o,s,u,v){const N=pf(),R=xl(),H=r.data[o]=function(r,o,s,u,v,N){return{type:s,index:u,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:v,attrs:N,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,R?N:N&&N.parent,s,o,u,v);return null===r.firstChild&&(r.firstChild=H),null!==N&&(R?null==N.child&&null!==H.parent&&(N.child=H):null===N.next&&(N.next=H)),H}(r,o,s,u,v),qe.lFrame.inI18n&&(N.flags|=64);else if(64&N.type){N.type=s,N.value=u,N.attrs=v;const R=function(){const r=qe.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}();N.injectorIndex=null===R?-1:R.injectorIndex}return Xn(N,!0),N}function No(r,o,s,u){if(0===s)return-1;const v=o.length;for(let N=0;N<s;N++)o.push(u),r.blueprint.push(u),r.data.push(null);return v}function Ri(r,o,s){Ts(o);try{const u=r.viewQuery;null!==u&&Nu(1,u,s);const v=r.template;null!==v&&Zp(r,o,v,1,s),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&Xp(r,o),r.staticViewQueries&&Nu(2,r.viewQuery,s);const N=r.components;null!==N&&function(r,o){for(let s=0;s<o.length;s++)_j(r,o[s])}(o,N)}catch(u){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),u}finally{o[2]&=-5,Ns()}}function So(r,o,s,u){const v=o[2];if(256==(256&v))return;Ts(o);const N=Is();try{df(o),function(r){qe.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==s&&Zp(r,o,s,2,u);const R=3==(3&v);if(!N)if(R){const U=r.preOrderCheckHooks;null!==U&&Fs(o,U,null)}else{const U=r.preOrderHooks;null!==U&&Ls(o,U,0,null),Tl(o,0)}if(function(r){for(let o=ru(r);null!==o;o=ou(o)){if(!o[2])continue;const s=o[9];for(let u=0;u<s.length;u++){const v=s[u],N=v[3];0==(1024&v[2])&&Dl(N,1),v[2]|=1024}}}(o),function(r){for(let o=ru(r);null!==o;o=ou(o))for(let s=10;s<o.length;s++){const u=o[s],v=u[1];wl(u)&&So(v,u,v.template,u[8])}}(o),null!==r.contentQueries&&Xp(r,o),!N)if(R){const U=r.contentCheckHooks;null!==U&&Fs(o,U)}else{const U=r.contentHooks;null!==U&&Ls(o,U,1),Tl(o,1)}!function(r,o){const s=r.hostBindingOpCodes;if(null!==s)try{for(let u=0;u<s.length;u++){const v=s[u];if(v<0)Ir(~v);else{const N=v,R=s[++u],P=s[++u];Oy(R,N),P(2,o[N])}}}finally{Ir(-1)}}(r,o);const P=r.components;null!==P&&function(r,o){for(let s=0;s<o.length;s++)xj(r,o[s])}(o,P);const H=r.viewQuery;if(null!==H&&Nu(2,H,u),!N)if(R){const U=r.viewCheckHooks;null!==U&&Fs(o,U)}else{const U=r.viewHooks;null!==U&&Ls(o,U,2),Tl(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),N||(o[2]&=-73),1024&o[2]&&(o[2]&=-1025,Dl(o[3],-1))}finally{Ns()}}function sj(r,o,s,u){const v=o[10],N=!Is(),R=cf(o);try{N&&!R&&v.begin&&v.begin(),R&&Ri(r,o,u),So(r,o,s,u)}finally{N&&!R&&v.end&&v.end()}}function Zp(r,o,s,u,v){const N=Xt(),R=2&u;try{Ir(-1),R&&o.length>20&&Hp(r,o,20,Is()),s(u,v)}finally{Ir(N)}}function eh(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=ra(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function ra(r,o,s,u,v,N,R,P,H,U){const Y=20+u,J=Y+v,ne=function(r,o){const s=[];for(let u=0;u<o;u++)s.push(u<r?null:Ke);return s}(Y,J),le="function"==typeof U?U():U;return ne[1]={type:r,blueprint:ne,template:s,queries:null,viewQuery:P,declTNode:o,data:ne.slice().fill(null,Y),bindingStartIndex:Y,expandoStartIndex:J,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof N?N():N,pipeRegistry:"function"==typeof R?R():R,firstChild:null,schemas:H,consts:le,incompleteFirstPass:!1}}function rh(r,o,s,u){const v=function(r){return r[7]||(r[7]=[])}(o);null===s?v.push(u):(v.push(s),r.firstCreatePass&&function(r){return r.cleanup||(r.cleanup=[])}(r).push(u,v.length-1))}function oh(r,o,s){for(let u in r)if(r.hasOwnProperty(u)){const v=r[u];(s=null===s?{}:s).hasOwnProperty(u)?s[u].push(o,v):s[u]=[o,v]}return s}function sh(r,o,s,u,v,N){const R=N.hostBindings;if(R){let P=r.hostBindingOpCodes;null===P&&(P=r.hostBindingOpCodes=[]);const H=~o.index;(function(r){let o=r.length;for(;o>0;){const s=r[--o];if("number"==typeof s&&s<0)return s}return 0})(P)!=H&&P.push(H),P.push(u,v,R)}}function ah(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function lh(r,o){o.flags|=2,(r.components||(r.components=[])).push(o.index)}function yj(r,o,s){if(s){if(o.exportAs)for(let u=0;u<o.exportAs.length;u++)s[o.exportAs[u]]=r;Ln(o)&&(s[""]=r)}}function uh(r,o,s){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+s,r.providerIndexes=o}function ch(r,o,s,u,v){r.data[u]=v;const N=v.factory||(v.factory=zr(v.type)),R=new mi(N,Ln(v),null);r.blueprint[u]=R,s[u]=R,sh(r,o,0,u,No(r,s,v.hostVars,Ke),v)}function Cj(r,o,s){const u=wn(o,r),v=eh(s),N=r[10],R=oa(r,Li(r,v,null,s.onPush?64:16,u,o,N,N.createRenderer(u,s),null,null));r[o.index]=R}function jj(r,o,s,u,v,N){const R=N[o];if(null!==R){const P=u.setInput;for(let H=0;H<R.length;){const U=R[H++],Y=R[H++],J=R[H++];null!==P?u.setInput(s,J,U,Y):s[Y]=J}}}function Ej(r,o){let s=null,u=0;for(;u<o.length;){const v=o[u];if(0!==v)if(5!==v){if("number"==typeof v)break;r.hasOwnProperty(v)&&(null===s&&(s=[]),s.push(v,r[v],o[u+1])),u+=2}else u+=2;else u+=4}return s}function xj(r,o){const s=pn(o,r);if(wl(s)){const u=s[1];80&s[2]?So(u,s,u.template,s[8]):s[5]>0&&Au(s)}}function Au(r){for(let u=ru(r);null!==u;u=ou(u))for(let v=10;v<u.length;v++){const N=u[v];if(1024&N[2]){const R=N[1];So(R,N,R.template,N[8])}else N[5]>0&&Au(N)}const s=r[1].components;if(null!==s)for(let u=0;u<s.length;u++){const v=pn(s[u],r);wl(v)&&v[5]>0&&Au(v)}}function _j(r,o){const s=pn(o,r),u=s[1];(function(r,o){for(let s=o.length;s<r.blueprint.length;s++)o.push(r.blueprint[s])})(u,s),Ri(u,s,s[8])}function oa(r,o){return r[13]?r[14][4]=o:r[13]=o,r[14]=o,o}function Tu(r,o,s){const u=o[10];u.begin&&u.begin();try{So(r,o,r.template,s)}catch(v){throw function(r,o){const s=r[9],u=s?s.get(Kr,null):null;u&&u.handleError(o)}(o,v),v}finally{u.end&&u.end()}}function fh(r){!function(r){for(let o=0;o<r.components.length;o++){const s=r.components[o],u=Jl(s),v=u[1];sj(v,u,v.template,s)}}(r[8])}function Nu(r,o,s){Ml(0),o(r,s)}const Nj=(()=>Promise.resolve(null))();function bh(r,o,s,u,v){for(let N=0;N<s.length;){const R=s[N++],P=s[N++],H=o[R],U=r.data[R];null!==U.setInput?U.setInput(H,v,u,P):H[P]=v}}function ia(r,o,s){let u=s?r.styles:null,v=s?r.classes:null,N=0;if(null!==o)for(let R=0;R<o.length;R++){const P=o[R];"number"==typeof P?N=P:1==N?v=al(v,P):2==N&&(u=al(u,P+": "+o[++R]+";"))}s?r.styles=u:r.stylesWithoutHost=u,s?r.classes=v:r.classesWithoutHost=v}const Fo=new pt("INJECTOR",-1);class vh{get(o,s=wi){if(s===wi){const u=new Error(`NullInjectorError: No provider for ${ot(o)}!`);throw u.name="NullInjectorError",u}return s}}const Oi=new pt("Set Injector scope."),ki={},Lj={};let Su;function yh(){return void 0===Su&&(Su=new vh),Su}function Ch(r,o=null,s=null,u){return new Oj(r,s,o||yh(),u)}class Oj{constructor(o,s,u,v=null){this.parent=u,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const N=[];s&&Jn(s,P=>this.processProvider(P,o,s)),Jn([o],P=>this.processInjectorType(P,[],N)),this.records.set(Fo,Lo(void 0,this));const R=this.records.get(Oi);this.scope=null!=R?R.value:null,this.source=v||("object"==typeof o?null:ot(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,s=wi,u=Ge.Default){this.assertNotDestroyed();const v=xo(this),N=Dr(void 0);try{if(!(u&Ge.SkipSelf)){let P=this.records.get(o);if(void 0===P){const H=function(r){return"function"==typeof r||"object"==typeof r&&r instanceof pt}(o)&&pr(o);P=H&&this.injectableDefInScope(H)?Lo(Fu(o),ki):null,this.records.set(o,P)}if(null!=P)return this.hydrate(o,P)}return(u&Ge.Self?yh():this.parent).get(o,s=u&Ge.Optional&&s===wi?null:s)}catch(R){if("NullInjectorError"===R.name){if((R[Do]=R[Do]||[]).unshift(ot(o)),v)throw R;return Bf(R,o,"R3InjectorError",this.source)}throw R}finally{Dr(N),xo(v)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((u,v)=>o.push(ot(v))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(o,s,u){if(!(o=Ue(o)))return!1;let v=Yd(o);const N=null==v&&o.ngModule||void 0,R=void 0===N?o:N,P=-1!==u.indexOf(R);if(void 0!==N&&(v=Yd(N)),null==v)return!1;if(null!=v.imports&&!P){let Y;u.push(R);try{Jn(v.imports,J=>{this.processInjectorType(J,s,u)&&(void 0===Y&&(Y=[]),Y.push(J))})}finally{}if(void 0!==Y)for(let J=0;J<Y.length;J++){const{ngModule:ne,providers:le}=Y[J];Jn(le,fe=>this.processProvider(fe,ne,le||mt))}}this.injectorDefTypes.add(R);const H=zr(R)||(()=>new R);this.records.set(R,Lo(H,ki));const U=v.providers;if(null!=U&&!P){const Y=o;Jn(U,J=>this.processProvider(J,Y,U))}return void 0!==N&&void 0!==o.providers}processProvider(o,s,u){let v=Ro(o=Ue(o))?o:Ue(o&&o.provide);const N=function(r,o,s){return Eh(r)?Lo(void 0,r.useValue):Lo(function(r,o,s){let u;if(Ro(r)){const v=Ue(r);return zr(v)||Fu(v)}if(Eh(r))u=()=>Ue(r.useValue);else if(function(r){return!(!r||!r.useFactory)}(r))u=()=>r.useFactory(...Yr(r.deps||[]));else if(function(r){return!(!r||!r.useExisting)}(r))u=()=>lt(Ue(r.useExisting));else{const v=Ue(r&&(r.useClass||r.provide));if(!function(r){return!!r.deps}(r))return zr(v)||Fu(v);u=()=>new v(...Yr(r.deps))}return u}(r),ki)}(o);if(Ro(o)||!0!==o.multi)this.records.get(v);else{let R=this.records.get(v);R||(R=Lo(void 0,ki,!0),R.factory=()=>Yr(R.multi),this.records.set(v,R)),v=o,R.multi.push(o)}this.records.set(v,N)}hydrate(o,s){return s.value===ki&&(s.value=Lj,s.value=s.factory()),"object"==typeof s.value&&s.value&&function(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(s.value)&&this.onDestroy.add(s.value),s.value}injectableDefInScope(o){if(!o.providedIn)return!1;const s=Ue(o.providedIn);return"string"==typeof s?"any"===s||s===this.scope:this.injectorDefTypes.has(s)}}function Fu(r){const o=pr(r),s=null!==o?o.factory:zr(r);if(null!==s)return s;if(r instanceof pt)throw new Error(`Token ${ot(r)} is missing a \u0275prov definition.`);if(r instanceof Function)return function(r){const o=r.length;if(o>0){const u=function(r,o){const s=[];for(let u=0;u<r;u++)s.push(o);return s}(o,"?");throw new Error(`Can't resolve all parameters for ${ot(r)}: (${u.join(", ")}).`)}const s=function(r){const o=r&&(r[Cs]||r[qd]);if(o){const s=function(r){if(r.hasOwnProperty("name"))return r.name;const o=(""+r).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${s}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${s}" class.`),o}return null}(r);return null!==s?()=>s.factory(r):()=>new r}(r);throw new Error("unreachable")}function Lo(r,o,s=!1){return{factory:r,value:o,multi:s?[]:void 0}}function Eh(r){return null!==r&&"object"==typeof r&&zl in r}function Ro(r){return"function"==typeof r}const wh=function(r,o,s){return function(r,o=null,s=null,u){const v=Ch(r,o,s,u);return v._resolveInjectorDefTypes(),v}({name:s},o,r,s)};class ht{static create(o,s){return Array.isArray(o)?wh(o,s,""):wh(o.providers,o.parent,o.name||"")}}function rE(r,o){Ss(Jl(r)[1],Rt())}ht.THROW_IF_NOT_FOUND=wi,ht.NULL=new vh,ht.\u0275prov=gt({token:ht,providedIn:"any",factory:()=>lt(Fo)}),ht.__NG_ELEMENT_ID__=-1;let sa=null;function Oo(){if(!sa){const r=dt.Symbol;if(r&&r.iterator)sa=r.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let s=0;s<o.length;++s){const u=o[s];"entries"!==u&&"size"!==u&&Map.prototype[u]===Map.prototype.entries&&(sa=u)}}}return sa}function Bi(r){return!!Vu(r)&&(Array.isArray(r)||!(r instanceof Map)&&Oo()in r)}function Vu(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function it(r,o=Ge.Default){const s=Ie();return null===s?lt(r,o):Tf(Rt(),s,Ue(r),o)}function Wu(r,o,s){const u=Ie();return function(r,o,s){return!Object.is(r[o],s)&&(r[o]=s,!0)}(u,qe.lFrame.bindingIndex++,o)&&function(r,o,s,u,v,N,R,P){const H=wn(o,s);let Y,U=o.inputs;!P&&null!=U&&(Y=U[u])?(bh(r,s,Y,u,v),xs(o)&&function(r,o){const s=pn(o,r);16&s[2]||(s[2]|=64)}(s,o.index)):3&o.type&&(u=function(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(u),v=null!=R?R(v,o.value||"",u):v,xt(N)?N.setProperty(H,u,v):Sl(u)||(H.setProperty?H.setProperty(u,v):H[u]=v))}(ut(),function(){const r=qe.lFrame;return El(r.tView,r.selectedIndex)}(),u,r,o,u[11],s,!1),Wu}function Gu(r,o,s,u,v){const R=v?"class":"style";bh(r,s,o.inputs[R],R,u)}function ug(r,o,s,u){const v=Ie(),N=ut(),R=20+r,P=v[11],H=v[R]=su(P,o,qe.lFrame.currentNamespace),U=N.firstCreatePass?function(r,o,s,u,v,N,R){const P=o.consts,U=To(o,r,2,v,Ar(P,N));return function(r,o,s,u){let v=!1;if(ff()){const N=function(r,o,s){const u=r.directiveRegistry;let v=null;if(u)for(let N=0;N<u.length;N++){const R=u[N];Pp(s,R.selectors,!1)&&(v||(v=[]),Bs(vi(s,o),r,R.type),Ln(R)?(lh(r,s),v.unshift(R)):v.push(R))}return v}(r,o,s),R=null===u?null:{"":-1};if(null!==N){v=!0,uh(s,r.data.length,N.length);for(let Y=0;Y<N.length;Y++){const J=N[Y];J.providersResolver&&J.providersResolver(J)}let P=!1,H=!1,U=No(r,o,N.length,null);for(let Y=0;Y<N.length;Y++){const J=N[Y];s.mergedAttrs=Os(s.mergedAttrs,J.hostAttrs),ch(r,s,o,U,J),yj(U,J,R),null!==J.contentQueries&&(s.flags|=8),(null!==J.hostBindings||null!==J.hostAttrs||0!==J.hostVars)&&(s.flags|=128);const ne=J.type.prototype;!P&&(ne.ngOnChanges||ne.ngOnInit||ne.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(s.index),P=!0),!H&&(ne.ngOnChanges||ne.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(s.index),H=!0),U++}!function(r,o){const u=o.directiveEnd,v=r.data,N=o.attrs,R=[];let P=null,H=null;for(let U=o.directiveStart;U<u;U++){const Y=v[U],J=Y.inputs,ne=null===N||kp(o)?null:Ej(J,N);R.push(ne),P=oh(J,U,P),H=oh(Y.outputs,U,H)}null!==P&&(P.hasOwnProperty("class")&&(o.flags|=16),P.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=R,o.inputs=P,o.outputs=H}(r,s)}R&&function(r,o,s){if(o){const u=r.localNames=[];for(let v=0;v<o.length;v+=2){const N=s[o[v+1]];if(null==N)throw new Br("301",`Export of name '${o[v+1]}' not found!`);u.push(o[v],N)}}}(s,u,R)}s.mergedAttrs=Os(s.mergedAttrs,s.attrs)}(o,s,U,Ar(P,R)),null!==U.attrs&&ia(U,U.attrs,!1),null!==U.mergedAttrs&&ia(U,U.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,U),U}(R,N,v,0,o,s,u):N.data[R];Xn(U,!0);const Y=U.mergedAttrs;null!==Y&&Rs(P,H,Y);const J=U.classes;null!==J&&fu(P,H,J);const ne=U.styles;null!==ne&&Lp(P,H,ne),64!=(64&U.flags)&&Zs(N,v,H,U),0===qe.lFrame.elementDepthCount&&zt(H,v),qe.lFrame.elementDepthCount++,function(r){return 1==(1&r.flags)}(U)&&(function(r,o,s){!ff()||(function(r,o,s,u){const v=s.directiveStart,N=s.directiveEnd;r.firstCreatePass||vi(s,o),zt(u,o);const R=s.initialInputs;for(let P=v;P<N;P++){const H=r.data[P],U=Ln(H);U&&Cj(o,s,H);const Y=yi(o,r,P,s);zt(Y,o),null!==R&&jj(0,P-v,Y,H,0,R),U&&(pn(s.index,o)[8]=Y)}}(r,o,s,wn(s,o)),128==(128&s.flags)&&function(r,o,s){const u=s.directiveStart,v=s.directiveEnd,R=s.index,P=qe.lFrame.currentDirectiveIndex;try{Ir(R);for(let H=u;H<v;H++){const U=r.data[H],Y=o[H];Al(H),(null!==U.hostBindings||0!==U.hostVars||null!==U.hostAttrs)&&ah(U,Y)}}finally{Ir(-1),Al(P)}}(r,o,s))}(N,v,U),function(r,o,s){if(bl(o)){const v=o.directiveEnd;for(let N=o.directiveStart;N<v;N++){const R=r.data[N];R.contentQueries&&R.contentQueries(1,s[N],N)}}}(N,U,v)),null!==u&&function(r,o,s=wn){const u=o.localNames;if(null!==u){let v=o.index+1;for(let N=0;N<u.length;N+=2){const R=u[N+1],P=-1===R?s(o,r):r[R];r[v++]=P}}}(v,U)}function cg(){let r=Rt();xl()?qe.lFrame.isParent=!1:(r=r.parent,Xn(r,!1));const o=r;qe.lFrame.elementDepthCount--;const s=ut();s.firstCreatePass&&(Ss(s,r),bl(r)&&s.queries.elementEnd(r)),null!=o.classesWithoutHost&&function(r){return 0!=(16&r.flags)}(o)&&Gu(s,o,Ie(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function(r){return 0!=(32&r.flags)}(o)&&Gu(s,o,Ie(),o.stylesWithoutHost,!1)}function Yu(r,o,s,u){ug(r,o,s,u),cg()}function qu(r){return!!r&&"function"==typeof r.then}const hg=function(r){return!!r&&"function"==typeof r.subscribe},Jr=void 0;var Fw=["en",[["a","p"],["AM","PM"],Jr],[["AM","PM"],Jr,Jr],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Jr,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Jr,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Jr,"{1} 'at' {0}",Jr],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(r){const o=Math.floor(Math.abs(r)),s=r.toString().replace(/^[^.]*\.?/,"").length;return 1===o&&0===s?1:5}];let qo={};function cm(r){return r in qo||(qo[r]=dt.ng&&dt.ng.common&&dt.ng.common.locales&&dt.ng.common.locales[r]),qo[r]}var ke=(()=>((ke=ke||{})[ke.LocaleId=0]="LocaleId",ke[ke.DayPeriodsFormat=1]="DayPeriodsFormat",ke[ke.DayPeriodsStandalone=2]="DayPeriodsStandalone",ke[ke.DaysFormat=3]="DaysFormat",ke[ke.DaysStandalone=4]="DaysStandalone",ke[ke.MonthsFormat=5]="MonthsFormat",ke[ke.MonthsStandalone=6]="MonthsStandalone",ke[ke.Eras=7]="Eras",ke[ke.FirstDayOfWeek=8]="FirstDayOfWeek",ke[ke.WeekendRange=9]="WeekendRange",ke[ke.DateFormat=10]="DateFormat",ke[ke.TimeFormat=11]="TimeFormat",ke[ke.DateTimeFormat=12]="DateTimeFormat",ke[ke.NumberSymbols=13]="NumberSymbols",ke[ke.NumberFormats=14]="NumberFormats",ke[ke.CurrencyCode=15]="CurrencyCode",ke[ke.CurrencySymbol=16]="CurrencySymbol",ke[ke.CurrencyName=17]="CurrencyName",ke[ke.Currencies=18]="Currencies",ke[ke.Directionality=19]="Directionality",ke[ke.PluralCase=20]="PluralCase",ke[ke.ExtraData=21]="ExtraData",ke))();const ca="en-US";let dm=ca;function Ju(r){cn(r,"Expected localeId to be defined"),"string"==typeof r&&(dm=r.toLowerCase().replace(/_/g,"-"))}class Om{}const Pm="ngComponent";class LD{resolveComponentFactory(o){throw function(r){const o=Error(`No component factory found for ${ot(r)}. Did you add it to @NgModule.entryComponents?`);return o[Pm]=r,o}(o)}}class eo{}function ga(...r){}function Ko(r,o){return new An(wn(r,o))}eo.NULL=new LD;const kD=function(){return Ko(Rt(),Ie())};let An=(()=>{class r{constructor(s){this.nativeElement=s}}return r.__NG_ELEMENT_ID__=kD,r})();function Bm(r){return r instanceof An?r.nativeElement:r}class ma{}let ac=(()=>{class r{}return r.\u0275prov=gt({token:r,providedIn:"root",factory:()=>null}),r})();class lc{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Hm=new lc("12.2.5");class Um{constructor(){}supports(o){return Bi(o)}create(o){return new $D(o)}}const UD=(r,o)=>o;class $D{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||UD}forEachItem(o){let s;for(s=this._itHead;null!==s;s=s._next)o(s)}forEachOperation(o){let s=this._itHead,u=this._removalsHead,v=0,N=null;for(;s||u;){const R=!u||s&&s.currentIndex<zm(u,v,N)?s:u,P=zm(R,v,N),H=R.currentIndex;if(R===u)v--,u=u._nextRemoved;else if(s=s._next,null==R.previousIndex)v++;else{N||(N=[]);const U=P-v,Y=H-v;if(U!=Y){for(let ne=0;ne<U;ne++){const le=ne<N.length?N[ne]:N[ne]=0,fe=le+ne;Y<=fe&&fe<U&&(N[ne]=le+1)}N[R.previousIndex]=Y-U}}P!==H&&o(R,P,H)}}forEachPreviousItem(o){let s;for(s=this._previousItHead;null!==s;s=s._nextPrevious)o(s)}forEachAddedItem(o){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)o(s)}forEachMovedItem(o){let s;for(s=this._movesHead;null!==s;s=s._nextMoved)o(s)}forEachRemovedItem(o){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)o(s)}forEachIdentityChange(o){let s;for(s=this._identityChangesHead;null!==s;s=s._nextIdentityChange)o(s)}diff(o){if(null==o&&(o=[]),!Bi(o))throw new Error(`Error trying to diff '${ot(o)}'. Only arrays and iterables are allowed`);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let v,N,R,s=this._itHead,u=!1;if(Array.isArray(o)){this.length=o.length;for(let P=0;P<this.length;P++)N=o[P],R=this._trackByFn(P,N),null!==s&&Object.is(s.trackById,R)?(u&&(s=this._verifyReinsertion(s,N,R,P)),Object.is(s.item,N)||this._addIdentityChange(s,N)):(s=this._mismatch(s,N,R,P),u=!0),s=s._next}else v=0,function(r,o){if(Array.isArray(r))for(let s=0;s<r.length;s++)o(r[s]);else{const s=r[Oo()]();let u;for(;!(u=s.next()).done;)o(u.value)}}(o,P=>{R=this._trackByFn(v,P),null!==s&&Object.is(s.trackById,R)?(u&&(s=this._verifyReinsertion(s,P,R,v)),Object.is(s.item,P)||this._addIdentityChange(s,P)):(s=this._mismatch(s,P,R,v),u=!0),s=s._next,v++}),this.length=v;return this._truncate(s),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,s,u,v){let N;return null===o?N=this._itTail:(N=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(u,null))?(Object.is(o.item,s)||this._addIdentityChange(o,s),this._reinsertAfter(o,N,v)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(u,v))?(Object.is(o.item,s)||this._addIdentityChange(o,s),this._moveAfter(o,N,v)):o=this._addAfter(new zD(s,u),N,v),o}_verifyReinsertion(o,s,u,v){let N=null===this._unlinkedRecords?null:this._unlinkedRecords.get(u,null);return null!==N?o=this._reinsertAfter(N,o._prev,v):o.currentIndex!=v&&(o.currentIndex=v,this._addToMoves(o,v)),o}_truncate(o){for(;null!==o;){const s=o._next;this._addToRemovals(this._unlink(o)),o=s}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,s,u){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const v=o._prevRemoved,N=o._nextRemoved;return null===v?this._removalsHead=N:v._nextRemoved=N,null===N?this._removalsTail=v:N._prevRemoved=v,this._insertAfter(o,s,u),this._addToMoves(o,u),o}_moveAfter(o,s,u){return this._unlink(o),this._insertAfter(o,s,u),this._addToMoves(o,u),o}_addAfter(o,s,u){return this._insertAfter(o,s,u),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,s,u){const v=null===s?this._itHead:s._next;return o._next=v,o._prev=s,null===v?this._itTail=o:v._prev=o,null===s?this._itHead=o:s._next=o,null===this._linkedRecords&&(this._linkedRecords=new $m),this._linkedRecords.put(o),o.currentIndex=u,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const s=o._prev,u=o._next;return null===s?this._itHead=u:s._next=u,null===u?this._itTail=s:u._prev=s,o}_addToMoves(o,s){return o.previousIndex===s||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new $m),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,s){return o.item=s,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class zD{constructor(o,s){this.item=o,this.trackById=s,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class WD{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,s){let u;for(u=this._head;null!==u;u=u._nextDup)if((null===s||s<=u.currentIndex)&&Object.is(u.trackById,o))return u;return null}remove(o){const s=o._prevDup,u=o._nextDup;return null===s?this._head=u:s._nextDup=u,null===u?this._tail=s:u._prevDup=s,null===this._head}}class $m{constructor(){this.map=new Map}put(o){const s=o.trackById;let u=this.map.get(s);u||(u=new WD,this.map.set(s,u)),u.add(o)}get(o,s){const v=this.map.get(o);return v?v.get(o,s):null}remove(o){const s=o.trackById;return this.map.get(s).remove(o)&&this.map.delete(s),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function zm(r,o,s){const u=r.previousIndex;if(null===u)return u;let v=0;return s&&u<s.length&&(v=s[u]),u+o+v}class Wm{constructor(){}supports(o){return o instanceof Map||Vu(o)}create(){return new GD}}class GD{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let s;for(s=this._mapHead;null!==s;s=s._next)o(s)}forEachPreviousItem(o){let s;for(s=this._previousMapHead;null!==s;s=s._nextPrevious)o(s)}forEachChangedItem(o){let s;for(s=this._changesHead;null!==s;s=s._nextChanged)o(s)}forEachAddedItem(o){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)o(s)}forEachRemovedItem(o){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)o(s)}diff(o){if(o){if(!(o instanceof Map||Vu(o)))throw new Error(`Error trying to diff '${ot(o)}'. Only maps and objects are allowed`)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let s=this._mapHead;if(this._appendAfter=null,this._forEach(o,(u,v)=>{if(s&&s.key===v)this._maybeAddToChanges(s,u),this._appendAfter=s,s=s._next;else{const N=this._getOrCreateRecordForKey(v,u);s=this._insertBeforeOrAppend(s,N)}}),s){s._prev&&(s._prev._next=null),this._removalsHead=s;for(let u=s;null!==u;u=u._nextRemoved)u===this._mapHead&&(this._mapHead=null),this._records.delete(u.key),u._nextRemoved=u._next,u.previousValue=u.currentValue,u.currentValue=null,u._prev=null,u._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,s){if(o){const u=o._prev;return s._next=o,s._prev=u,o._prev=s,u&&(u._next=s),o===this._mapHead&&(this._mapHead=s),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=s,s._prev=this._appendAfter):this._mapHead=s,this._appendAfter=s,null}_getOrCreateRecordForKey(o,s){if(this._records.has(o)){const v=this._records.get(o);this._maybeAddToChanges(v,s);const N=v._prev,R=v._next;return N&&(N._next=R),R&&(R._prev=N),v._next=null,v._prev=null,v}const u=new YD(o);return this._records.set(o,u),u.currentValue=s,this._addToAdditions(u),u}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,s){Object.is(s,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=s,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,s){o instanceof Map?o.forEach(s):Object.keys(o).forEach(u=>s(o[u],u))}}class YD{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Gm(){return new Gi([new Um])}let Gi=(()=>{class r{constructor(s){this.factories=s}static create(s,u){if(null!=u){const v=u.factories.slice();s=s.concat(v)}return new r(s)}static extend(s){return{provide:r,useFactory:u=>r.create(s,u||Gm()),deps:[[r,new qr,new er]]}}find(s){const u=this.factories.find(v=>v.supports(s));if(null!=u)return u;throw new Error(`Cannot find a differ supporting object '${s}' of type '${function(r){return r.name||typeof r}(s)}'`)}}return r.\u0275prov=gt({token:r,providedIn:"root",factory:Gm}),r})();function Ym(){return new Xo([new Wm])}let Xo=(()=>{class r{constructor(s){this.factories=s}static create(s,u){if(u){const v=u.factories.slice();s=s.concat(v)}return new r(s)}static extend(s){return{provide:r,useFactory:u=>r.create(s,u||Ym()),deps:[[r,new qr,new er]]}}find(s){const u=this.factories.find(v=>v.supports(s));if(u)return u;throw new Error(`Cannot find a differ supporting object '${s}'`)}}return r.\u0275prov=gt({token:r,providedIn:"root",factory:Ym}),r})();function ba(r,o,s,u,v=!1){for(;null!==s;){const N=o[s.index];if(null!==N&&u.push(Nt(N)),Fn(N))for(let P=10;P<N.length;P++){const H=N[P],U=H[1].firstChild;null!==U&&ba(H[1],H,U,u)}const R=s.type;if(8&R)ba(r,o,s.child,u);else if(32&R){const P=nu(s,o);let H;for(;H=P();)u.push(H)}else if(16&R){const P=Np(o,s);if(Array.isArray(P))u.push(...P);else{const H=Si(o[16]);ba(H[1],H,P,u,!0)}}s=v?s.projectionNext:s.next}return u}class Yi{constructor(o,s){this._lView=o,this._cdRefInjectingView=s,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,s=o[1];return ba(s,o,s.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(Fn(o)){const s=o[8],u=s?s.indexOf(this):-1;u>-1&&(au(o,u),Gr(s,u))}this._attachedToViewContainer=!1}Ep(this._lView[1],this._lView)}onDestroy(o){rh(this._lView[1],this._lView,null,o)}markForCheck(){!function(r){for(;r;){r[2]|=64;const o=Si(r);if(my(r)&&!o)return r;r=o}}(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Tu(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(r,o,s){Ms(!0);try{Tu(r,o,s)}finally{Ms(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function(r,o){Fi(r,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=o}}class QD extends Yi{constructor(o){super(o),this._view=o}detectChanges(){fh(this._view)}checkNoChanges(){!function(r){Ms(!0);try{fh(r)}finally{Ms(!1)}}(this._view)}get context(){return null}}const tx=[new Wm],rx=new Gi([new Um]),ox=new Xo(tx),sx=function(){return va(Rt(),Ie())};let Cr=(()=>{class r{}return r.__NG_ELEMENT_ID__=sx,r})();const ax=Cr,lx=class extends ax{constructor(o,s,u){super(),this._declarationLView=o,this._declarationTContainer=s,this.elementRef=u}createEmbeddedView(o){const s=this._declarationTContainer.tViews,u=Li(this._declarationLView,s,o,16,null,s.declTNode,null,null,null,null);u[17]=this._declarationLView[this._declarationTContainer.index];const N=this._declarationLView[19];return null!==N&&(u[19]=N.createEmbeddedView(s)),Ri(s,u,o),new Yi(u)}};function va(r,o){return 4&r.type?new lx(o,r,Ko(r,o)):null}class to{}const fx=function(){return Km(Rt(),Ie())};let lr=(()=>{class r{}return r.__NG_ELEMENT_ID__=fx,r})();const hx=lr,qm=class extends hx{constructor(o,s,u){super(),this._lContainer=o,this._hostTNode=s,this._hostLView=u}get element(){return Ko(this._hostTNode,this._hostLView)}get injector(){return new yo(this._hostTNode,this._hostLView)}get parentInjector(){const o=Ps(this._hostTNode,this._hostLView);if(xf(o)){const s=vo(o,this._hostLView),u=bo(o);return new yo(s[1].data[u+8],s)}return new yo(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const s=Qm(this._lContainer);return null!==s&&s[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,s,u){const v=o.createEmbeddedView(s||{});return this.insert(v,u),v}createComponent(o,s,u,v,N){const R=u||this.parentInjector;if(!N&&null==o.ngModule&&R){const H=R.get(to,null);H&&(N=H)}const P=o.create(R,v,void 0,N);return this.insert(P.hostView,s),P}insert(o,s){const u=o._lView,v=u[1];if(function(r){return Fn(r[3])}(u)){const Y=this.indexOf(o);if(-1!==Y)this.detach(Y);else{const J=u[3],ne=new qm(J,J[6],J[3]);ne.detach(ne.indexOf(o))}}const N=this._adjustIndex(s),R=this._lContainer;!function(r,o,s,u){const v=10+u,N=s.length;u>0&&(s[v-1][4]=o),u<N-10?(o[4]=s[v],Us(s,10+u,o)):(s.push(o),o[4]=null),o[3]=s;const R=o[17];null!==R&&s!==R&&function(r,o){const s=r[9];o[16]!==o[3][3][16]&&(r[2]=!0),null===s?r[9]=[o]:s.push(o)}(R,o);const P=o[19];null!==P&&P.insertView(r),o[2]|=128}(v,u,R,N);const P=cu(N,R),H=u[11],U=Xs(H,R[7]);return null!==U&&function(r,o,s,u,v,N){u[0]=v,u[6]=o,Fi(r,u,s,1,v,N)}(v,R[6],H,u,U,P),o.attachToViewContainerRef(),Us(uc(R),N,o),o}move(o,s){return this.insert(o,s)}indexOf(o){const s=Qm(this._lContainer);return null!==s?s.indexOf(o):-1}remove(o){const s=this._adjustIndex(o,-1),u=au(this._lContainer,s);u&&(Gr(uc(this._lContainer),s),Ep(u[1],u))}detach(o){const s=this._adjustIndex(o,-1),u=au(this._lContainer,s);return u&&null!=Gr(uc(this._lContainer),s)?new Yi(u):null}_adjustIndex(o,s=0){return null==o?this.length+s:o}};function Qm(r){return r[8]}function uc(r){return r[8]||(r[8]=[])}function Km(r,o){let s;const u=o[r.index];if(Fn(u))s=u;else{let v;if(8&r.type)v=Nt(u);else{const N=o[11];v=N.createComment("");const R=wn(r,o);Xr(N,Xs(N,R),v,function(r,o){return xt(r)?r.nextSibling(o):o.nextSibling}(N,R),!1)}o[r.index]=s=function(r,o,s,u){return new Array(r,!0,!1,o,null,0,u,s,null,null)}(u,o,v,r),oa(o,s)}return new qm(s,r,o)}const ti={};class m0 extends eo{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const s=Qt(o);return new v0(s,this.ngModule)}}function b0(r){const o=[];for(let s in r)r.hasOwnProperty(s)&&o.push({propName:r[s],templateName:s});return o}const c_=new pt("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>hp});class v0 extends Om{constructor(o,s){super(),this.componentDef=o,this.ngModule=s,this.componentType=o.type,this.selector=function(r){return r.map(Y1).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!s}get inputs(){return b0(this.componentDef.inputs)}get outputs(){return b0(this.componentDef.outputs)}create(o,s,u,v){const N=(v=v||this.ngModule)?function(r,o){return{get:(s,u,v)=>{const N=r.get(s,ti,v);return N!==ti||u===ti?N:o.get(s,u,v)}}}(o,v.injector):o,R=N.get(ma,uf),P=N.get(ac,null),H=R.createRenderer(null,this.componentDef),U=this.componentDef.selectors[0][0]||"div",Y=u?function(r,o,s){if(xt(r))return r.selectRootElement(o,s===Lt.ShadowDom);let u="string"==typeof o?r.querySelector(o):o;return u.textContent="",u}(H,u,this.componentDef.encapsulation):su(R.createRenderer(null,this.componentDef),U,function(r){const o=r.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(U)),J=this.componentDef.onPush?576:528,ne=function(r,o){return{components:[],scheduler:r||hp,clean:Nj,playerHandler:o||null,flags:0}}(),le=ra(0,null,null,1,0,null,null,null,null,null),fe=Li(null,le,ne,J,null,null,R,H,P,N);let ye,ve;Ts(fe);try{const Ae=function(r,o,s,u,v,N){const R=s[1];s[20]=r;const H=To(R,20,2,"#host",null),U=H.mergedAttrs=o.hostAttrs;null!==U&&(ia(H,U,!0),null!==r&&(Rs(v,r,U),null!==H.classes&&fu(v,r,H.classes),null!==H.styles&&Lp(v,r,H.styles)));const Y=u.createRenderer(r,o),J=Li(s,eh(o),null,o.onPush?64:16,s[20],H,u,Y,N||null,null);return R.firstCreatePass&&(Bs(vi(H,s),R,o.type),lh(R,H),uh(H,s.length,1)),oa(s,J),s[20]=J}(Y,this.componentDef,fe,R,H);if(Y)if(u)Rs(H,Y,["ng-version",Hm.full]);else{const{attrs:we,classes:Be}=function(r){const o=[],s=[];let u=1,v=2;for(;u<r.length;){let N=r[u];if("string"==typeof N)2===v?""!==N&&o.push(N,r[++u]):8===v&&s.push(N);else{if(!Rn(v))break;v=N}u++}return{attrs:o,classes:s}}(this.componentDef.selectors[0]);we&&Rs(H,Y,we),Be&&Be.length>0&&fu(H,Y,Be.join(" "))}if(ve=El(le,20),void 0!==s){const we=ve.projection=[];for(let Be=0;Be<this.ngContentSelectors.length;Be++){const He=s[Be];we.push(null!=He?Array.from(He):null)}}ye=function(r,o,s,u,v){const N=s[1],R=function(r,o,s){const u=Rt();r.firstCreatePass&&(s.providersResolver&&s.providersResolver(s),ch(r,u,o,No(r,o,1,null),s));const v=yi(o,r,u.directiveStart,u);zt(v,o);const N=wn(u,o);return N&&zt(N,o),v}(N,s,o);if(u.components.push(R),r[8]=R,v&&v.forEach(H=>H(R,o)),o.contentQueries){const H=Rt();o.contentQueries(1,R,H.directiveStart)}const P=Rt();return!N.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(Ir(P.index),sh(s[1],P,0,P.directiveStart,P.directiveEnd,o),ah(o,R)),R}(Ae,this.componentDef,fe,ne,[rE]),Ri(le,fe,null)}finally{Ns()}return new p_(this.componentType,ye,Ko(ve,fe),fe,ve)}}class p_ extends class{}{constructor(o,s,u,v,N){super(),this.location=u,this._rootLView=v,this._tNode=N,this.instance=s,this.hostView=this.changeDetectorRef=new QD(v),this.componentType=o}get injector(){return new yo(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}const ni=new Map;class m_ extends to{constructor(o,s){super(),this._parent=s,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new m0(this);const u=Cn(o),v=function(r){return r[ly]||null}(o);v&&Ju(v),this._bootstrapComponents=rr(u.bootstrap),this._r3Injector=Ch(o,s,[{provide:to,useValue:this},{provide:eo,useValue:this.componentFactoryResolver}],ot(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,s=ht.THROW_IF_NOT_FOUND,u=Ge.Default){return o===ht||o===to||o===Fo?this:this._r3Injector.get(o,s,u)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(s=>s()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class Ec extends class{}{constructor(o){super(),this.moduleType=o,null!==Cn(o)&&function(r){const o=new Set;!function s(u){const v=Cn(u,!0),N=v.id;null!==N&&(function(r,o,s){if(o&&o!==s)throw new Error(`Duplicate module registered for ${r} - ${ot(o)} vs ${ot(o.name)}`)}(N,ni.get(N),u),ni.set(N,u));const R=rr(v.imports);for(const P of R)o.has(P)||(o.add(P),s(P))}(r)}(o)}create(o){return new m_(this.moduleType,o)}}function wc(r){return o=>{setTimeout(r,void 0,o)}}const $n=class extends ae{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,s,u){var v,N,R;let P=o,H=s||(()=>null),U=u;if(o&&"object"==typeof o){const J=o;P=null===(v=J.next)||void 0===v?void 0:v.bind(J),H=null===(N=J.error)||void 0===N?void 0:N.bind(J),U=null===(R=J.complete)||void 0===R?void 0:R.bind(J)}this.__isAsync&&(H=wc(H),P&&(P=wc(P)),U&&(U=wc(U)));const Y=super.subscribe({next:P,error:H,complete:U});return o instanceof Q&&o.add(Y),Y}};function R_(){return this._results[Oo()]()}class wa{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const s=Oo(),u=wa.prototype;u[s]||(u[s]=R_)}get changes(){return this._changes||(this._changes=new $n)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,s){return this._results.reduce(o,s)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,s){const u=this;u.dirty=!1;const v=Dn(o);(this._changesDetected=!function(r,o,s){if(r.length!==o.length)return!1;for(let u=0;u<r.length;u++){let v=r[u],N=o[u];if(s&&(v=s(v),N=s(N)),N!==v)return!1}return!0}(u._results,v,s))&&(u._results=v,u.length=v.length,u.last=v[this.length-1],u.first=v[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;class Dc{constructor(o){this.queryList=o,this.matches=null}clone(){return new Dc(this.queryList)}setDirty(){this.queryList.setDirty()}}class xc{constructor(o=[]){this.queries=o}createEmbeddedView(o){const s=o.queries;if(null!==s){const u=null!==o.contentQueries?o.contentQueries[0]:s.length,v=[];for(let N=0;N<u;N++){const R=s.getByIndex(N);v.push(this.queries[R.indexInDeclarationView].clone())}return new xc(v)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let s=0;s<this.queries.length;s++)null!==F0(o,s).matches&&this.queries[s].setDirty()}}class _0{constructor(o,s,u=null){this.predicate=o,this.flags=s,this.read=u}}class _c{constructor(o=[]){this.queries=o}elementStart(o,s){for(let u=0;u<this.queries.length;u++)this.queries[u].elementStart(o,s)}elementEnd(o){for(let s=0;s<this.queries.length;s++)this.queries[s].elementEnd(o)}embeddedTView(o){let s=null;for(let u=0;u<this.length;u++){const v=null!==s?s.length:0,N=this.getByIndex(u).embeddedTView(o,v);N&&(N.indexInDeclarationView=u,null!==s?s.push(N):s=[N])}return null!==s?new _c(s):null}template(o,s){for(let u=0;u<this.queries.length;u++)this.queries[u].template(o,s)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class Ac{constructor(o,s=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=s}elementStart(o,s){this.isApplyingToNode(s)&&this.matchTNode(o,s)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,s){this.elementStart(o,s)}embeddedTView(o,s){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,s),new Ac(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const s=this._declarationNodeIndex;let u=o.parent;for(;null!==u&&8&u.type&&u.index!==s;)u=u.parent;return s===(null!==u?u.index:-1)}return this._appliesToNextNode}matchTNode(o,s){const u=this.metadata.predicate;if(Array.isArray(u))for(let v=0;v<u.length;v++){const N=u[v];this.matchTNodeWithReadOption(o,s,P_(s,N)),this.matchTNodeWithReadOption(o,s,Vs(s,o,N,!1,!1))}else u===Cr?4&s.type&&this.matchTNodeWithReadOption(o,s,-1):this.matchTNodeWithReadOption(o,s,Vs(s,o,u,!1,!1))}matchTNodeWithReadOption(o,s,u){if(null!==u){const v=this.metadata.read;if(null!==v)if(v===An||v===lr||v===Cr&&4&s.type)this.addMatch(s.index,-2);else{const N=Vs(s,o,v,!1,!1);null!==N&&this.addMatch(s.index,N)}else this.addMatch(s.index,u)}}addMatch(o,s){null===this.matches?this.matches=[o,s]:this.matches.push(o,s)}}function P_(r,o){const s=r.localNames;if(null!==s)for(let u=0;u<s.length;u+=2)if(s[u]===o)return s[u+1];return null}function V_(r,o,s,u){return-1===s?function(r,o){return 11&r.type?Ko(r,o):4&r.type?va(r,o):null}(o,r):-2===s?function(r,o,s){return s===An?Ko(o,r):s===Cr?va(o,r):s===lr?Km(o,r):void 0}(r,o,u):yi(r,r[1],s,o)}function A0(r,o,s,u){const v=o[19].queries[u];if(null===v.matches){const N=r.data,R=s.matches,P=[];for(let H=0;H<R.length;H+=2){const U=R[H];P.push(U<0?null:V_(o,N[U],R[H+1],s.metadata.read))}v.matches=P}return v.matches}function Ic(r,o,s,u){const v=r.queries.getByIndex(s),N=v.matches;if(null!==N){const R=A0(r,o,v,s);for(let P=0;P<N.length;P+=2){const H=N[P];if(H>0)u.push(R[P/2]);else{const U=N[P+1],Y=o[-H];for(let J=10;J<Y.length;J++){const ne=Y[J];ne[17]===ne[3]&&Ic(ne[1],ne,U,u)}if(null!==Y[9]){const J=Y[9];for(let ne=0;ne<J.length;ne++){const le=J[ne];Ic(le[1],le,U,u)}}}}}return u}function I0(r){const o=Ie(),s=ut(),u=mf();Ml(u+1);const v=F0(s,u);if(r.dirty&&cf(o)===(2==(2&v.metadata.flags))){if(null===v.matches)r.reset([]);else{const N=v.crossesNgTemplate?Ic(s,o,u,[]):A0(s,o,v,u);r.reset(N,Bm),r.notifyOnChanges()}return!0}return!1}function M0(r,o,s){const u=ut();u.firstCreatePass&&(function(r,o,s){null===r.queries&&(r.queries=new _c),r.queries.track(new Ac(o,s))}(u,new _0(r,o,s),-1),2==(2&o)&&(u.staticViewQueries=!0)),function(r,o,s){const u=new wa(4==(4&s));rh(r,o,u,u.destroy),null===o[19]&&(o[19]=new xc),o[19].queries.push(new Dc(u))}(u,Ie(),o)}function F0(r,o){return r.queries.getByIndex(o)}const _a=new pt("Application Initializer");let oi=(()=>{class r{constructor(s){this.appInits=s,this.resolve=ga,this.reject=ga,this.initialized=!1,this.done=!1,this.donePromise=new Promise((u,v)=>{this.resolve=u,this.reject=v})}runInitializers(){if(this.initialized)return;const s=[],u=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let v=0;v<this.appInits.length;v++){const N=this.appInits[v]();if(qu(N))s.push(N);else if(hg(N)){const R=new Promise((P,H)=>{N.subscribe({complete:P,error:H})});s.push(R)}}Promise.all(s).then(()=>{u()}).catch(v=>{this.reject(v)}),0===s.length&&u(),this.initialized=!0}}return r.\u0275fac=function(s){return new(s||r)(lt(_a,8))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const is=new pt("AppId"),vA={provide:is,useFactory:function(){return`${Lc()}${Lc()}${Lc()}`},deps:[]};function Lc(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const X0=new pt("Platform Initializer"),Rc=new pt("Platform ID"),yA=new pt("appBootstrapListener");let Oc=(()=>{class r{log(s){console.log(s)}warn(s){console.warn(s)}}return r.\u0275fac=function(s){return new(s||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const Lr=new pt("LocaleId"),Z0=new pt("DefaultCurrencyCode");class jA{constructor(o,s){this.ngModuleFactory=o,this.componentFactories=s}}const kc=function(r){return new Ec(r)},EA=kc,wA=function(r){return Promise.resolve(kc(r))},J0=function(r){const o=kc(r),u=rr(Cn(r).declarations).reduce((v,N)=>{const R=Qt(N);return R&&v.push(new v0(R)),v},[]);return new jA(o,u)},DA=J0,xA=function(r){return Promise.resolve(J0(r))};let Ia=(()=>{class r{constructor(){this.compileModuleSync=EA,this.compileModuleAsync=wA,this.compileModuleAndAllComponentsSync=DA,this.compileModuleAndAllComponentsAsync=xA}clearCache(){}clearCacheFor(s){}getModuleId(s){}}return r.\u0275fac=function(s){return new(s||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const IA=(()=>Promise.resolve(0))();function Pc(r){"undefined"==typeof Zone?IA.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class Vt{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:s=!1,shouldCoalesceRunChangeDetection:u=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new $n(!1),this.onMicrotaskEmpty=new $n(!1),this.onStable=new $n(!1),this.onError=new $n(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const v=this;v._nesting=0,v._outer=v._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(v._inner=v._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(v._inner=v._inner.fork(Zone.longStackTraceZoneSpec)),v.shouldCoalesceEventChangeDetection=!u&&s,v.shouldCoalesceRunChangeDetection=u,v.lastRequestAnimationFrameId=-1,v.nativeRequestAnimationFrame=function(){let r=dt.requestAnimationFrame,o=dt.cancelAnimationFrame;if("undefined"!=typeof Zone&&r&&o){const s=r[Zone.__symbol__("OriginalDelegate")];s&&(r=s);const u=o[Zone.__symbol__("OriginalDelegate")];u&&(o=u)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function(r){const o=()=>{!function(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(dt,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,Vc(r),r.isCheckStableRunning=!0,Bc(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),Vc(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(s,u,v,N,R,P)=>{try{return eb(r),s.invokeTask(v,N,R,P)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===N.type||r.shouldCoalesceRunChangeDetection)&&o(),tb(r)}},onInvoke:(s,u,v,N,R,P,H)=>{try{return eb(r),s.invoke(v,N,R,P,H)}finally{r.shouldCoalesceRunChangeDetection&&o(),tb(r)}},onHasTask:(s,u,v,N)=>{s.hasTask(v,N),u===v&&("microTask"==N.change?(r._hasPendingMicrotasks=N.microTask,Vc(r),Bc(r)):"macroTask"==N.change&&(r.hasPendingMacrotasks=N.macroTask))},onHandleError:(s,u,v,N)=>(s.handleError(v,N),r.runOutsideAngular(()=>r.onError.emit(N)),!1)})}(v)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Vt.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Vt.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,s,u){return this._inner.run(o,s,u)}runTask(o,s,u,v){const N=this._inner,R=N.scheduleEventTask("NgZoneEvent: "+v,o,TA,ga,ga);try{return N.runTask(R,s,u)}finally{N.cancelTask(R)}}runGuarded(o,s,u){return this._inner.runGuarded(o,s,u)}runOutsideAngular(o){return this._outer.run(o)}}const TA={};function Bc(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function Vc(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function eb(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function tb(r){r._nesting--,Bc(r)}class FA{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new $n,this.onMicrotaskEmpty=new $n,this.onStable=new $n,this.onError=new $n}run(o,s,u){return o.apply(s,u)}runGuarded(o,s,u){return o.apply(s,u)}runOutsideAngular(o){return o()}runTask(o,s,u,v){return o.apply(s,u)}}let Hc=(()=>{class r{constructor(s){this._ngZone=s,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),s.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Vt.assertNotInAngularZone(),Pc(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Pc(()=>{for(;0!==this._callbacks.length;){let s=this._callbacks.pop();clearTimeout(s.timeoutId),s.doneCb(this._didWork)}this._didWork=!1});else{let s=this.getPendingTasks();this._callbacks=this._callbacks.filter(u=>!u.updateCb||!u.updateCb(s)||(clearTimeout(u.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(s=>({source:s.source,creationLocation:s.creationLocation,data:s.data})):[]}addCallback(s,u,v){let N=-1;u&&u>0&&(N=setTimeout(()=>{this._callbacks=this._callbacks.filter(R=>R.timeoutId!==N),s(this._didWork,this.getPendingTasks())},u)),this._callbacks.push({doneCb:s,timeoutId:N,updateCb:v})}whenStable(s,u,v){if(v&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(s,u,v),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(s,u,v){return[]}}return r.\u0275fac=function(s){return new(s||r)(lt(Vt))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),nb=(()=>{class r{constructor(){this._applications=new Map,Uc.addToWindow(this)}registerApplication(s,u){this._applications.set(s,u)}unregisterApplication(s){this._applications.delete(s)}unregisterAllApplications(){this._applications.clear()}getTestability(s){return this._applications.get(s)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(s,u=!0){return Uc.findTestabilityInTree(this,s,u)}}return r.\u0275fac=function(s){return new(s||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();class LA{addToWindow(o){}findTestabilityInTree(o,s,u){return null}}let Uc=new LA,rb=!0,ob=!1;let zn;const sb=new pt("AllowMultipleToken");function ab(r,o,s=[]){const u=`Platform: ${o}`,v=new pt(u);return(N=[])=>{let R=lb();if(!R||R.injector.get(sb,!1))if(r)r(s.concat(N).concat({provide:v,useValue:!0}));else{const P=s.concat(N).concat({provide:v,useValue:!0},{provide:Oi,useValue:"platform"});!function(r){if(zn&&!zn.destroyed&&!zn.injector.get(sb,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");zn=r.get(ub);const o=r.get(X0,null);o&&o.forEach(s=>s())}(ht.create({providers:P,name:u}))}return function(r){const o=lb();if(!o)throw new Error("No platform exists!");if(!o.injector.get(r,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return o}(v)}}function lb(){return zn&&!zn.destroyed?zn:null}let ub=(()=>{class r{constructor(s){this._injector=s,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(s,u){const P=function(r,o){let s;return s="noop"===r?new FA:("zone.js"===r?void 0:r)||new Vt({enableLongStackTrace:(ob=!0,rb),shouldCoalesceEventChangeDetection:!!(null==o?void 0:o.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==o?void 0:o.ngZoneRunCoalescing)}),s}(u?u.ngZone:void 0,{ngZoneEventCoalescing:u&&u.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:u&&u.ngZoneRunCoalescing||!1}),H=[{provide:Vt,useValue:P}];return P.run(()=>{const U=ht.create({providers:H,parent:this.injector,name:s.moduleType.name}),Y=s.create(U),J=Y.injector.get(Kr,null);if(!J)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return P.runOutsideAngular(()=>{const ne=P.onError.subscribe({next:le=>{J.handleError(le)}});Y.onDestroy(()=>{$c(this._modules,Y),ne.unsubscribe()})}),function(r,o,s){try{const u=s();return qu(u)?u.catch(v=>{throw o.runOutsideAngular(()=>r.handleError(v)),v}):u}catch(u){throw o.runOutsideAngular(()=>r.handleError(u)),u}}(J,P,()=>{const ne=Y.injector.get(oi);return ne.runInitializers(),ne.donePromise.then(()=>(Ju(Y.injector.get(Lr,ca)||ca),this._moduleDoBootstrap(Y),Y))})})}bootstrapModule(s,u=[]){const v=cb({},u);return function(r,o,s){const u=new Ec(s);return Promise.resolve(u)}(0,0,s).then(N=>this.bootstrapModuleFactory(N,v))}_moduleDoBootstrap(s){const u=s.injector.get(ss);if(s._bootstrapComponents.length>0)s._bootstrapComponents.forEach(v=>u.bootstrap(v));else{if(!s.instance.ngDoBootstrap)throw new Error(`The module ${ot(s.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);s.instance.ngDoBootstrap(u)}this._modules.push(s)}onDestroy(s){this._destroyListeners.push(s)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(s=>s.destroy()),this._destroyListeners.forEach(s=>s()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(s){return new(s||r)(lt(ht))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();function cb(r,o){return Array.isArray(o)?o.reduce(cb,r):Object.assign(Object.assign({},r),o)}let ss=(()=>{class r{constructor(s,u,v,N,R){this._zone=s,this._injector=u,this._exceptionHandler=v,this._componentFactoryResolver=N,this._initStatus=R,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const P=new Re(U=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{U.next(this._stable),U.complete()})}),H=new Re(U=>{let Y;this._zone.runOutsideAngular(()=>{Y=this._zone.onStable.subscribe(()=>{Vt.assertNotInAngularZone(),Pc(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,U.next(!0))})})});const J=this._zone.onUnstable.subscribe(()=>{Vt.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{U.next(!1)}))});return()=>{Y.unsubscribe(),J.unsubscribe()}});this.isStable=function(...r){let o=Number.POSITIVE_INFINITY,s=null,u=r[r.length-1];return Ce(u)?(s=r.pop(),r.length>1&&"number"==typeof r[r.length-1]&&(o=r.pop())):"number"==typeof u&&(o=r.pop()),null===s&&1===r.length&&r[0]instanceof Re?r[0]:kv(o)($d(r,s))}(P,H.pipe(r=>zd()(function(r,o){return function(u){let v;v="function"==typeof r?r:function(){return r};const N=Object.create(u,Uv);return N.source=u,N.subjectFactory=v,N}}(Yv)(r))))}bootstrap(s,u){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let v;v=s instanceof Om?s:this._componentFactoryResolver.resolveComponentFactory(s),this.componentTypes.push(v.componentType);const N=function(r){return r.isBoundToModule}(v)?void 0:this._injector.get(to),P=v.create(ht.NULL,[],u||v.selector,N),H=P.location.nativeElement,U=P.injector.get(Hc,null),Y=U&&P.injector.get(nb);return U&&Y&&Y.registerApplication(H,U),P.onDestroy(()=>{this.detachView(P.hostView),$c(this.components,P),Y&&Y.unregisterApplication(H)}),this._loadComponent(P),P}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let s of this._views)s.detectChanges()}catch(s){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(s))}finally{this._runningTick=!1}}attachView(s){const u=s;this._views.push(u),u.attachToAppRef(this)}detachView(s){const u=s;$c(this._views,u),u.detachFromAppRef()}_loadComponent(s){this.attachView(s.hostView),this.tick(),this.components.push(s),this._injector.get(yA,[]).concat(this._bootstrapListeners).forEach(v=>v(s))}ngOnDestroy(){this._views.slice().forEach(s=>s.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return r.\u0275fac=function(s){return new(s||r)(lt(Vt),lt(ht),lt(Kr),lt(eo),lt(oi))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();function $c(r,o){const s=r.indexOf(o);s>-1&&r.splice(s,1)}const aI=ab(null,"core",[{provide:Rc,useValue:"unknown"},{provide:ub,deps:[ht]},{provide:nb,deps:[]},{provide:Oc,deps:[]}]),fI=[{provide:ss,useClass:ss,deps:[Vt,ht,Kr,eo,oi]},{provide:c_,deps:[Vt],useFactory:function(r){let o=[];return r.onStable.subscribe(()=>{for(;o.length;)o.pop()()}),function(s){o.push(s)}}},{provide:oi,useClass:oi,deps:[[new er,_a]]},{provide:Ia,useClass:Ia,deps:[]},vA,{provide:Gi,useFactory:function(){return rx},deps:[]},{provide:Xo,useFactory:function(){return ox},deps:[]},{provide:Lr,useFactory:function(r){return Ju(r=r||"undefined"!=typeof $localize&&$localize.locale||ca),r},deps:[[new _i(Lr),new er,new qr]]},{provide:Z0,useValue:"USD"}];let hI=(()=>{class r{constructor(s){}}return r.\u0275fac=function(s){return new(s||r)(lt(ss))},r.\u0275mod=uo({type:r}),r.\u0275inj=wr({providers:fI}),r})(),Pa=null;function ds(){return Pa}const nn=new pt("DocumentToken");var St=(()=>((St=St||{})[St.Zero=0]="Zero",St[St.One=1]="One",St[St.Two=2]="Two",St[St.Few=3]="Few",St[St.Many=4]="Many",St[St.Other=5]="Other",St))();const EM=function(r){return function(r){const o=function(r){return r.toLowerCase().replace(/_/g,"-")}(r);let s=cm(o);if(s)return s;const u=o.split("-")[0];if(s=cm(u),s)return s;if("en"===u)return Fw;throw new Error(`Missing locale data for the locale "${r}".`)}(r)[ke.PluralCase]};class qa{}let XM=(()=>{class r extends qa{constructor(s){super(),this.locale=s}getPluralCategory(s,u){switch(EM(u||this.locale)(s)){case St.Zero:return"zero";case St.One:return"one";case St.Two:return"two";case St.Few:return"few";case St.Many:return"many";default:return"other"}}}return r.\u0275fac=function(s){return new(s||r)(lt(Lr))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),NT=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=uo({type:r}),r.\u0275inj=wr({providers:[{provide:qa,useClass:XM}]}),r})();class md extends class extends class{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function(r){Pa||(Pa=r)}(new md)}onAndCancel(o,s,u){return o.addEventListener(s,u,!1),()=>{o.removeEventListener(s,u,!1)}}dispatchEvent(o,s){o.dispatchEvent(s)}remove(o){o.parentNode&&o.parentNode.removeChild(o)}createElement(o,s){return(s=s||this.getDefaultDocument()).createElement(o)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(o){return o.nodeType===Node.ELEMENT_NODE}isShadowRoot(o){return o instanceof DocumentFragment}getGlobalEventTarget(o,s){return"window"===s?window:"document"===s?o:"body"===s?o.body:null}getBaseHref(o){const s=(hs=hs||document.querySelector("base"),hs?hs.getAttribute("href"):null);return null==s?null:function(r){Qa=Qa||document.createElement("a"),Qa.setAttribute("href",r);const o=Qa.pathname;return"/"===o.charAt(0)?o:`/${o}`}(s)}resetBaseElement(){hs=null}getUserAgent(){return window.navigator.userAgent}getCookie(o){return function(r,o){o=encodeURIComponent(o);for(const s of r.split(";")){const u=s.indexOf("="),[v,N]=-1==u?[s,""]:[s.slice(0,u),s.slice(u+1)];if(v.trim()===o)return decodeURIComponent(N)}return null}(document.cookie,o)}}let Qa,hs=null;const ev=new pt("TRANSITION_ID"),HT=[{provide:_a,useFactory:function(r,o,s){return()=>{s.get(oi).donePromise.then(()=>{const u=ds(),v=o.querySelectorAll(`style[ng-transition="${r}"]`);for(let N=0;N<v.length;N++)u.remove(v[N])})}},deps:[ev,nn,ht],multi:!0}];class bd{static init(){!function(r){Uc=r}(new bd)}addToWindow(o){dt.getAngularTestability=(u,v=!0)=>{const N=o.findTestabilityInTree(u,v);if(null==N)throw new Error("Could not find testability for element.");return N},dt.getAllAngularTestabilities=()=>o.getAllTestabilities(),dt.getAllAngularRootElements=()=>o.getAllRootElements(),dt.frameworkStabilizers||(dt.frameworkStabilizers=[]),dt.frameworkStabilizers.push(u=>{const v=dt.getAllAngularTestabilities();let N=v.length,R=!1;const P=function(H){R=R||H,N--,0==N&&u(R)};v.forEach(function(H){H.whenStable(P)})})}findTestabilityInTree(o,s,u){if(null==s)return null;const v=o.getTestability(s);return null!=v?v:u?ds().isShadowRoot(s)?this.findTestabilityInTree(o,s.host,!0):this.findTestabilityInTree(o,s.parentElement,!0):null}}let UT=(()=>{class r{build(){return new XMLHttpRequest}}return r.\u0275fac=function(s){return new(s||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const gs=new pt("EventManagerPlugins");let Xa=(()=>{class r{constructor(s,u){this._zone=u,this._eventNameToPlugin=new Map,s.forEach(v=>v.manager=this),this._plugins=s.slice().reverse()}addEventListener(s,u,v){return this._findPluginFor(u).addEventListener(s,u,v)}addGlobalEventListener(s,u,v){return this._findPluginFor(u).addGlobalEventListener(s,u,v)}getZone(){return this._zone}_findPluginFor(s){const u=this._eventNameToPlugin.get(s);if(u)return u;const v=this._plugins;for(let N=0;N<v.length;N++){const R=v[N];if(R.supports(s))return this._eventNameToPlugin.set(s,R),R}throw new Error(`No event manager plugin found for event ${s}`)}}return r.\u0275fac=function(s){return new(s||r)(lt(gs),lt(Vt))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();class vd{constructor(o){this._doc=o}addGlobalEventListener(o,s,u){const v=ds().getGlobalEventTarget(this._doc,o);if(!v)throw new Error(`Unsupported event target ${v} for event ${s}`);return this.addEventListener(v,s,u)}}let nv=(()=>{class r{constructor(){this._stylesSet=new Set}addStyles(s){const u=new Set;s.forEach(v=>{this._stylesSet.has(v)||(this._stylesSet.add(v),u.add(v))}),this.onStylesAdded(u)}onStylesAdded(s){}getAllStyles(){return Array.from(this._stylesSet)}}return r.\u0275fac=function(s){return new(s||r)},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})(),ms=(()=>{class r extends nv{constructor(s){super(),this._doc=s,this._hostNodes=new Map,this._hostNodes.set(s.head,[])}_addStylesToHost(s,u,v){s.forEach(N=>{const R=this._doc.createElement("style");R.textContent=N,v.push(u.appendChild(R))})}addHost(s){const u=[];this._addStylesToHost(this._stylesSet,s,u),this._hostNodes.set(s,u)}removeHost(s){const u=this._hostNodes.get(s);u&&u.forEach(rv),this._hostNodes.delete(s)}onStylesAdded(s){this._hostNodes.forEach((u,v)=>{this._addStylesToHost(s,v,u)})}ngOnDestroy(){this._hostNodes.forEach(s=>s.forEach(rv))}}return r.\u0275fac=function(s){return new(s||r)(lt(nn))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();function rv(r){ds().remove(r)}const yd={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Cd=/%COMP%/g;function Za(r,o,s){for(let u=0;u<o.length;u++){let v=o[u];Array.isArray(v)?Za(r,v,s):(v=v.replace(Cd,r),s.push(v))}return s}function sv(r){return o=>{if("__ngUnwrap__"===o)return r;!1===r(o)&&(o.preventDefault(),o.returnValue=!1)}}let jd=(()=>{class r{constructor(s,u,v){this.eventManager=s,this.sharedStylesHost=u,this.appId=v,this.rendererByCompId=new Map,this.defaultRenderer=new Ed(s)}createRenderer(s,u){if(!s||!u)return this.defaultRenderer;switch(u.encapsulation){case Lt.Emulated:{let v=this.rendererByCompId.get(u.id);return v||(v=new rN(this.eventManager,this.sharedStylesHost,u,this.appId),this.rendererByCompId.set(u.id,v)),v.applyToHost(s),v}case 1:case Lt.ShadowDom:return new oN(this.eventManager,this.sharedStylesHost,s,u);default:if(!this.rendererByCompId.has(u.id)){const v=Za(u.id,u.styles,[]);this.sharedStylesHost.addStyles(v),this.rendererByCompId.set(u.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return r.\u0275fac=function(s){return new(s||r)(lt(Xa),lt(ms),lt(is))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();class Ed{constructor(o){this.eventManager=o,this.data=Object.create(null)}destroy(){}createElement(o,s){return s?document.createElementNS(yd[s]||s,o):document.createElement(o)}createComment(o){return document.createComment(o)}createText(o){return document.createTextNode(o)}appendChild(o,s){o.appendChild(s)}insertBefore(o,s,u){o&&o.insertBefore(s,u)}removeChild(o,s){o&&o.removeChild(s)}selectRootElement(o,s){let u="string"==typeof o?document.querySelector(o):o;if(!u)throw new Error(`The selector "${o}" did not match any elements`);return s||(u.textContent=""),u}parentNode(o){return o.parentNode}nextSibling(o){return o.nextSibling}setAttribute(o,s,u,v){if(v){s=v+":"+s;const N=yd[v];N?o.setAttributeNS(N,s,u):o.setAttribute(s,u)}else o.setAttribute(s,u)}removeAttribute(o,s,u){if(u){const v=yd[u];v?o.removeAttributeNS(v,s):o.removeAttribute(`${u}:${s}`)}else o.removeAttribute(s)}addClass(o,s){o.classList.add(s)}removeClass(o,s){o.classList.remove(s)}setStyle(o,s,u,v){v&(mn.DashCase|mn.Important)?o.style.setProperty(s,u,v&mn.Important?"important":""):o.style[s]=u}removeStyle(o,s,u){u&mn.DashCase?o.style.removeProperty(s):o.style[s]=""}setProperty(o,s,u){o[s]=u}setValue(o,s){o.nodeValue=s}listen(o,s,u){return"string"==typeof o?this.eventManager.addGlobalEventListener(o,s,sv(u)):this.eventManager.addEventListener(o,s,sv(u))}}class rN extends Ed{constructor(o,s,u,v){super(o),this.component=u;const N=Za(v+"-"+u.id,u.styles,[]);s.addStyles(N),this.contentAttr=function(r){return"_ngcontent-%COMP%".replace(Cd,r)}(v+"-"+u.id),this.hostAttr=function(r){return"_nghost-%COMP%".replace(Cd,r)}(v+"-"+u.id)}applyToHost(o){super.setAttribute(o,this.hostAttr,"")}createElement(o,s){const u=super.createElement(o,s);return super.setAttribute(u,this.contentAttr,""),u}}class oN extends Ed{constructor(o,s,u,v){super(o),this.sharedStylesHost=s,this.hostEl=u,this.shadowRoot=u.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const N=Za(v.id,v.styles,[]);for(let R=0;R<N.length;R++){const P=document.createElement("style");P.textContent=N[R],this.shadowRoot.appendChild(P)}}nodeOrShadowRoot(o){return o===this.hostEl?this.shadowRoot:o}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(o,s){return super.appendChild(this.nodeOrShadowRoot(o),s)}insertBefore(o,s,u){return super.insertBefore(this.nodeOrShadowRoot(o),s,u)}removeChild(o,s){return super.removeChild(this.nodeOrShadowRoot(o),s)}parentNode(o){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(o)))}}let iN=(()=>{class r extends vd{constructor(s){super(s)}supports(s){return!0}addEventListener(s,u,v){return s.addEventListener(u,v,!1),()=>this.removeEventListener(s,u,v)}removeEventListener(s,u,v){return s.removeEventListener(u,v)}}return r.\u0275fac=function(s){return new(s||r)(lt(nn))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const uv=["alt","control","meta","shift"],fN={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},cv={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},pN={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey};let hN=(()=>{class r extends vd{constructor(s){super(s)}supports(s){return null!=r.parseEventName(s)}addEventListener(s,u,v){const N=r.parseEventName(u),R=r.eventCallback(N.fullKey,v,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>ds().onAndCancel(s,N.domEventName,R))}static parseEventName(s){const u=s.toLowerCase().split("."),v=u.shift();if(0===u.length||"keydown"!==v&&"keyup"!==v)return null;const N=r._normalizeKey(u.pop());let R="";if(uv.forEach(H=>{const U=u.indexOf(H);U>-1&&(u.splice(U,1),R+=H+".")}),R+=N,0!=u.length||0===N.length)return null;const P={};return P.domEventName=v,P.fullKey=R,P}static getEventFullKey(s){let u="",v=function(r){let o=r.key;if(null==o){if(o=r.keyIdentifier,null==o)return"Unidentified";o.startsWith("U+")&&(o=String.fromCharCode(parseInt(o.substring(2),16)),3===r.location&&cv.hasOwnProperty(o)&&(o=cv[o]))}return fN[o]||o}(s);return v=v.toLowerCase()," "===v?v="space":"."===v&&(v="dot"),uv.forEach(N=>{N!=v&&pN[N](s)&&(u+=N+".")}),u+=v,u}static eventCallback(s,u,v){return N=>{r.getEventFullKey(N)===s&&v.runGuarded(()=>u(N))}}static _normalizeKey(s){switch(s){case"esc":return"escape";default:return s}}}return r.\u0275fac=function(s){return new(s||r)(lt(nn))},r.\u0275prov=gt({token:r,factory:r.\u0275fac}),r})();const EN=ab(aI,"browser",[{provide:Rc,useValue:"browser"},{provide:X0,useValue:function(){md.makeCurrent(),bd.init()},multi:!0},{provide:nn,useFactory:function(){return function(r){Cl=r}(document),document},deps:[]}]),wN=[[],{provide:Oi,useValue:"root"},{provide:Kr,useFactory:function(){return new Kr},deps:[]},{provide:gs,useClass:iN,multi:!0,deps:[nn,Vt,Rc]},{provide:gs,useClass:hN,multi:!0,deps:[nn]},[],{provide:jd,useClass:jd,deps:[Xa,ms,is]},{provide:ma,useExisting:jd},{provide:nv,useExisting:ms},{provide:ms,useClass:ms,deps:[nn]},{provide:Hc,useClass:Hc,deps:[Vt]},{provide:Xa,useClass:Xa,deps:[gs,Vt]},{provide:class{},useClass:UT,deps:[]},[]];let DN=(()=>{class r{constructor(s){if(s)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(s){return{ngModule:r,providers:[{provide:is,useValue:s.appId},{provide:ev,useExisting:is},HT]}}}return r.\u0275fac=function(s){return new(s||r)(lt(r,12))},r.\u0275mod=uo({type:r}),r.\u0275inj=wr({providers:wN,imports:[NT,hI]}),r})();function Id(r,o,s,u){return new(s||(s=Promise))(function(N,R){function P(Y){try{U(u.next(Y))}catch(J){R(J)}}function H(Y){try{U(u.throw(Y))}catch(J){R(J)}}function U(Y){Y.done?N(Y.value):function(N){return N instanceof s?N:new s(function(R){R(N)})}(Y.value).then(P,H)}U((u=u.apply(r,o||[])).next())})}"undefined"!=typeof window&&window;var Td,so=[],gv="ResizeObserver loop completed with undelivered notifications.",ai=(()=>(function(r){r.BORDER_BOX="border-box",r.CONTENT_BOX="content-box",r.DEVICE_PIXEL_CONTENT_BOX="device-pixel-content-box"}(ai||(ai={})),ai))(),ao=function(r){return Object.freeze(r)},kN=function(o,s){this.inlineSize=o,this.blockSize=s,ao(this)},mv=function(){function r(o,s,u,v){return this.x=o,this.y=s,this.width=u,this.height=v,this.top=this.y,this.left=this.x,this.bottom=this.top+this.height,this.right=this.left+this.width,ao(this)}return r.prototype.toJSON=function(){var o=this;return{x:o.x,y:o.y,top:o.top,right:o.right,bottom:o.bottom,left:o.left,width:o.width,height:o.height}},r.fromRect=function(o){return new r(o.x,o.y,o.width,o.height)},r}(),Md=function(r){return r instanceof SVGElement&&"getBBox"in r},bv=function(r){if(Md(r)){var o=r.getBBox();return!o.width&&!o.height}return!(r.offsetWidth||r.offsetHeight||r.getClientRects().length)},vv=function(r){var o,s;if(r instanceof Element)return!0;var u=null===(s=null===(o=r)||void 0===o?void 0:o.ownerDocument)||void 0===s?void 0:s.defaultView;return!!(u&&r instanceof u.Element)},bs="undefined"!=typeof window?window:{},tl=new WeakMap,yv=/auto|scroll/,BN=/^tb|vertical/,VN=/msie|trident/i.test(bs.navigator&&bs.navigator.userAgent),ur=function(r){return parseFloat(r||"0")},li=function(r,o,s){return void 0===r&&(r=0),void 0===o&&(o=0),void 0===s&&(s=!1),new kN((s?o:r)||0,(s?r:o)||0)},Cv=ao({devicePixelContentBoxSize:li(),borderBoxSize:li(),contentBoxSize:li(),contentRect:new mv(0,0,0,0)}),jv=function(r,o){if(void 0===o&&(o=!1),tl.has(r)&&!o)return tl.get(r);if(bv(r))return tl.set(r,Cv),Cv;var s=getComputedStyle(r),u=Md(r)&&r.ownerSVGElement&&r.getBBox(),v=!VN&&"border-box"===s.boxSizing,N=BN.test(s.writingMode||""),R=!u&&yv.test(s.overflowY||""),P=!u&&yv.test(s.overflowX||""),H=u?0:ur(s.paddingTop),U=u?0:ur(s.paddingRight),Y=u?0:ur(s.paddingBottom),J=u?0:ur(s.paddingLeft),ne=u?0:ur(s.borderTopWidth),le=u?0:ur(s.borderRightWidth),fe=u?0:ur(s.borderBottomWidth),ve=J+U,Ae=H+Y,we=(u?0:ur(s.borderLeftWidth))+le,Be=ne+fe,He=P?r.offsetHeight-Be-r.clientHeight:0,tt=R?r.offsetWidth-we-r.clientWidth:0,Tt=v?ve+we:0,an=v?Ae+Be:0,cr=u?u.width:ur(s.width)-Tt-tt,Qn=u?u.height:ur(s.height)-an-He,kr=cr+ve+tt+we,Pr=Qn+Ae+He+Be,ui=ao({devicePixelContentBoxSize:li(Math.round(cr*devicePixelRatio),Math.round(Qn*devicePixelRatio),N),borderBoxSize:li(kr,Pr,N),contentBoxSize:li(cr,Qn,N),contentRect:new mv(J,H,cr,Qn)});return tl.set(r,ui),ui},Ev=function(r,o,s){var u=jv(r,s),v=u.borderBoxSize,N=u.contentBoxSize,R=u.devicePixelContentBoxSize;switch(o){case ai.DEVICE_PIXEL_CONTENT_BOX:return R;case ai.BORDER_BOX:return v;default:return N}},HN=function(o){var s=jv(o);this.target=o,this.contentRect=s.contentRect,this.borderBoxSize=ao([s.borderBoxSize]),this.contentBoxSize=ao([s.contentBoxSize]),this.devicePixelContentBoxSize=ao([s.devicePixelContentBoxSize])},wv=function(r){if(bv(r))return 1/0;for(var o=0,s=r.parentNode;s;)o+=1,s=s.parentNode;return o},UN=function(){var r=1/0,o=[];so.forEach(function(R){if(0!==R.activeTargets.length){var P=[];R.activeTargets.forEach(function(U){var Y=new HN(U.target),J=wv(U.target);P.push(Y),U.lastReportedSize=Ev(U.target,U.observedBox),J<r&&(r=J)}),o.push(function(){R.callback.call(R.observer,P,R.observer)}),R.activeTargets.splice(0,R.activeTargets.length)}});for(var s=0,u=o;s<u.length;s++)(0,u[s])();return r},Dv=function(r){so.forEach(function(s){s.activeTargets.splice(0,s.activeTargets.length),s.skippedTargets.splice(0,s.skippedTargets.length),s.observationTargets.forEach(function(v){v.isActive()&&(wv(v.target)>r?s.activeTargets.push(v):s.skippedTargets.push(v))})})},xv=[],nl=0,QN={attributes:!0,characterData:!0,childList:!0,subtree:!0},_v=["resize","load","transitionend","animationend","animationstart","animationiteration","keyup","keydown","mouseup","mousedown","mouseover","mouseout","blur","focus"],Av=function(r){return void 0===r&&(r=0),Date.now()+r},Nd=!1,Sd=new(function(){function r(){var o=this;this.stopped=!0,this.listener=function(){return o.schedule()}}return r.prototype.run=function(o){var s=this;if(void 0===o&&(o=250),!Nd){Nd=!0;var u=Av(o);!function(r){!function(r){if(!Td){var o=0,s=document.createTextNode("");new MutationObserver(function(){return xv.splice(0).forEach(function(r){return r()})}).observe(s,{characterData:!0}),Td=function(){s.textContent=""+(o?o--:o++)}}xv.push(r),Td()}(function(){requestAnimationFrame(r)})}(function(){var v=!1;try{v=function(){var r=0;for(Dv(r);so.some(function(r){return r.activeTargets.length>0});)r=UN(),Dv(r);return so.some(function(r){return r.skippedTargets.length>0})&&function(){var r;"function"==typeof ErrorEvent?r=new ErrorEvent("error",{message:gv}):((r=document.createEvent("Event")).initEvent("error",!1,!1),r.message=gv),window.dispatchEvent(r)}(),r>0}()}finally{if(Nd=!1,o=u-Av(),!nl)return;v?s.run(1e3):o>0?s.run(o):s.start()}})}},r.prototype.schedule=function(){this.stop(),this.run()},r.prototype.observe=function(){var o=this,s=function(){return o.observer&&o.observer.observe(document.body,QN)};document.body?s():bs.addEventListener("DOMContentLoaded",s)},r.prototype.start=function(){var o=this;this.stopped&&(this.stopped=!1,this.observer=new MutationObserver(this.listener),this.observe(),_v.forEach(function(s){return bs.addEventListener(s,o.listener,!0)}))},r.prototype.stop=function(){var o=this;this.stopped||(this.observer&&this.observer.disconnect(),_v.forEach(function(s){return bs.removeEventListener(s,o.listener,!0)}),this.stopped=!0)},r}()),Iv=function(r){!nl&&r>0&&Sd.start(),!(nl+=r)&&Sd.stop()},ZN=function(){function r(o,s){this.target=o,this.observedBox=s||ai.CONTENT_BOX,this.lastReportedSize={inlineSize:0,blockSize:0}}return r.prototype.isActive=function(){var o=Ev(this.target,this.observedBox,!0);return function(r){return!Md(r)&&!function(r){switch(r.tagName){case"INPUT":if("image"!==r.type)break;case"VIDEO":case"AUDIO":case"EMBED":case"OBJECT":case"CANVAS":case"IFRAME":case"IMG":return!0}return!1}(r)&&"inline"===getComputedStyle(r).display}(this.target)&&(this.lastReportedSize=o),this.lastReportedSize.inlineSize!==o.inlineSize||this.lastReportedSize.blockSize!==o.blockSize},r}(),JN=function(o,s){this.activeTargets=[],this.skippedTargets=[],this.observationTargets=[],this.observer=o,this.callback=s},rl=new WeakMap,Mv=function(r,o){for(var s=0;s<r.length;s+=1)if(r[s].target===o)return s;return-1},ol=function(){function r(){}return r.connect=function(o,s){var u=new JN(o,s);rl.set(o,u)},r.observe=function(o,s,u){var v=rl.get(o),N=0===v.observationTargets.length;Mv(v.observationTargets,s)<0&&(N&&so.push(v),v.observationTargets.push(new ZN(s,u&&u.box)),Iv(1),Sd.schedule())},r.unobserve=function(o,s){var u=rl.get(o),v=Mv(u.observationTargets,s);v>=0&&(1===u.observationTargets.length&&so.splice(so.indexOf(u),1),u.observationTargets.splice(v,1),Iv(-1))},r.disconnect=function(o){var s=this,u=rl.get(o);u.observationTargets.slice().forEach(function(v){return s.unobserve(o,v.target)}),u.activeTargets.splice(0,u.activeTargets.length)},r}(),eS=function(){function r(o){if(0===arguments.length)throw new TypeError("Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.");if("function"!=typeof o)throw new TypeError("Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.");ol.connect(this,o)}return r.prototype.observe=function(o,s){if(0===arguments.length)throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!vv(o))throw new TypeError("Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element");ol.observe(this,o,s)},r.prototype.unobserve=function(o){if(0===arguments.length)throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.");if(!vv(o))throw new TypeError("Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element");ol.unobserve(this,o)},r.prototype.disconnect=function(){ol.disconnect(this)},r.toString=function(){return"function ResizeObserver () { [polyfill code] }"},r}();function il(...r){let o=r[r.length-1];return Ce(o)?(r.pop(),Dt(r,o)):$d(r)}const vs=new Re(r=>r.complete());function Tv(r,o){return"function"==typeof o?s=>s.pipe(Tv((u,v)=>Pd(r(u,v)).pipe(je((N,R)=>o(u,N,v,R))))):s=>s.lift(new nS(r))}class nS{constructor(o){this.project=o}call(o,s){return s.subscribe(new rS(o,this.project))}}class rS extends Vd{constructor(o,s){super(o),this.project=s,this.index=0}_next(o){let s;const u=this.index++;try{s=this.project(o,u)}catch(v){return void this.destination.error(v)}this._innerSub(s)}_innerSub(o){const s=this.innerSubscription;s&&s.unsubscribe();const u=new Bd(this),v=this.destination;v.add(u),this.innerSubscription=Hd(o,u),this.innerSubscription!==u&&v.add(this.innerSubscription)}_complete(){const{innerSubscription:o}=this;(!o||o.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(o){this.destination.next(o)}}class Fd{constructor(o){this.changes=o}static of(o){return new Fd(o)}notEmpty(o){if(this.changes[o]){const s=this.changes[o].currentValue;if(null!=s)return il(s)}return vs}has(o){return this.changes[o]?il(this.changes[o].currentValue):vs}notFirst(o){return this.changes[o]&&!this.changes[o].isFirstChange()?il(this.changes[o].currentValue):vs}notFirstAndEmpty(o){if(this.changes[o]&&!this.changes[o].isFirstChange()){const s=this.changes[o].currentValue;if(null!=s)return il(s)}return vs}}const Nv=new pt("NGX_ECHARTS_CONFIG");let oS=(()=>{class r{constructor(s,u,v){this.el=u,this.ngZone=v,this.autoResize=!0,this.loadingType="default",this.chartInit=new $n,this.optionsError=new $n,this.chartClick=this.createLazyEvent("click"),this.chartDblClick=this.createLazyEvent("dblclick"),this.chartMouseDown=this.createLazyEvent("mousedown"),this.chartMouseMove=this.createLazyEvent("mousemove"),this.chartMouseUp=this.createLazyEvent("mouseup"),this.chartMouseOver=this.createLazyEvent("mouseover"),this.chartMouseOut=this.createLazyEvent("mouseout"),this.chartGlobalOut=this.createLazyEvent("globalout"),this.chartContextMenu=this.createLazyEvent("contextmenu"),this.chartLegendSelectChanged=this.createLazyEvent("legendselectchanged"),this.chartLegendSelected=this.createLazyEvent("legendselected"),this.chartLegendUnselected=this.createLazyEvent("legendunselected"),this.chartLegendScroll=this.createLazyEvent("legendscroll"),this.chartDataZoom=this.createLazyEvent("datazoom"),this.chartDataRangeSelected=this.createLazyEvent("datarangeselected"),this.chartTimelineChanged=this.createLazyEvent("timelinechanged"),this.chartTimelinePlayChanged=this.createLazyEvent("timelineplaychanged"),this.chartRestore=this.createLazyEvent("restore"),this.chartDataViewChanged=this.createLazyEvent("dataviewchanged"),this.chartMagicTypeChanged=this.createLazyEvent("magictypechanged"),this.chartPieSelectChanged=this.createLazyEvent("pieselectchanged"),this.chartPieSelected=this.createLazyEvent("pieselected"),this.chartPieUnselected=this.createLazyEvent("pieunselected"),this.chartMapSelectChanged=this.createLazyEvent("mapselectchanged"),this.chartMapSelected=this.createLazyEvent("mapselected"),this.chartMapUnselected=this.createLazyEvent("mapunselected"),this.chartAxisAreaSelected=this.createLazyEvent("axisareaselected"),this.chartFocusNodeAdjacency=this.createLazyEvent("focusnodeadjacency"),this.chartUnfocusNodeAdjacency=this.createLazyEvent("unfocusnodeadjacency"),this.chartBrush=this.createLazyEvent("brush"),this.chartBrushEnd=this.createLazyEvent("brushend"),this.chartBrushSelected=this.createLazyEvent("brushselected"),this.chartRendered=this.createLazyEvent("rendered"),this.chartFinished=this.createLazyEvent("finished"),this.animationFrameID=null,this.echarts=s.echarts}ngOnChanges(s){const u=Fd.of(s);u.notFirstAndEmpty("options").subscribe(v=>this.onOptionsChange(v)),u.notFirstAndEmpty("merge").subscribe(v=>this.setOption(v)),u.has("loading").subscribe(v=>this.toggleLoading(!!v)),u.notFirst("theme").subscribe(()=>this.refreshChart())}ngOnInit(){this.autoResize&&(this.resizeSub=new eS(()=>{this.animationFrameID=window.requestAnimationFrame(()=>this.resize())}),this.resizeSub.observe(this.el.nativeElement))}ngOnDestroy(){window.clearTimeout(this.initChartTimer),this.resizeSub&&(this.resizeSub.unobserve(this.el.nativeElement),window.cancelAnimationFrame(this.animationFrameID)),this.dispose()}ngAfterViewInit(){this.initChartTimer=window.setTimeout(()=>this.initChart())}dispose(){this.chart&&(this.chart.isDisposed()||this.chart.dispose(),this.chart=null)}resize(){this.chart&&this.ngZone.runOutsideAngular(()=>{this.chart.resize()})}toggleLoading(s){this.chart&&(s?this.chart.showLoading(this.loadingType,this.loadingOpts):this.chart.hideLoading())}setOption(s,u){if(this.chart)try{this.chart.setOption(s,u)}catch(v){console.error(v),this.optionsError.emit(v)}}refreshChart(){return Id(this,void 0,void 0,function*(){this.dispose(),yield this.initChart()})}createChart(){const s=this.el.nativeElement;if(window&&window.getComputedStyle){const u=window.getComputedStyle(s,null).getPropertyValue("height");(!u||"0px"===u)&&(!s.style.height||"0px"===s.style.height)&&(s.style.height="400px")}return this.ngZone.runOutsideAngular(()=>("function"==typeof this.echarts?this.echarts:()=>Promise.resolve(this.echarts))().then(({init:v})=>v(s,this.theme,this.initOpts)))}initChart(){return Id(this,void 0,void 0,function*(){yield this.onOptionsChange(this.options),this.merge&&this.chart&&this.setOption(this.merge)})}onOptionsChange(s){return Id(this,void 0,void 0,function*(){!s||(this.chart||(this.chart=yield this.createChart(),this.chartInit.emit(this.chart)),this.setOption(this.options,!0))})}createLazyEvent(s){return this.chartInit.pipe(Tv(u=>new Re(v=>(u.on(s,N=>this.ngZone.run(()=>v.next(N))),()=>{this.chart&&(this.chart.isDisposed()||u.off(s))}))))}}return r.\u0275fac=function(s){return new(s||r)(it(Nv),it(An),it(Vt))},r.\u0275dir=dn({type:r,selectors:[["echarts"],["","echarts",""]],inputs:{autoResize:"autoResize",loadingType:"loadingType",options:"options",theme:"theme",loading:"loading",initOpts:"initOpts",merge:"merge",loadingOpts:"loadingOpts"},outputs:{chartInit:"chartInit",optionsError:"optionsError",chartClick:"chartClick",chartDblClick:"chartDblClick",chartMouseDown:"chartMouseDown",chartMouseMove:"chartMouseMove",chartMouseUp:"chartMouseUp",chartMouseOver:"chartMouseOver",chartMouseOut:"chartMouseOut",chartGlobalOut:"chartGlobalOut",chartContextMenu:"chartContextMenu",chartLegendSelectChanged:"chartLegendSelectChanged",chartLegendSelected:"chartLegendSelected",chartLegendUnselected:"chartLegendUnselected",chartLegendScroll:"chartLegendScroll",chartDataZoom:"chartDataZoom",chartDataRangeSelected:"chartDataRangeSelected",chartTimelineChanged:"chartTimelineChanged",chartTimelinePlayChanged:"chartTimelinePlayChanged",chartRestore:"chartRestore",chartDataViewChanged:"chartDataViewChanged",chartMagicTypeChanged:"chartMagicTypeChanged",chartPieSelectChanged:"chartPieSelectChanged",chartPieSelected:"chartPieSelected",chartPieUnselected:"chartPieUnselected",chartMapSelectChanged:"chartMapSelectChanged",chartMapSelected:"chartMapSelected",chartMapUnselected:"chartMapUnselected",chartAxisAreaSelected:"chartAxisAreaSelected",chartFocusNodeAdjacency:"chartFocusNodeAdjacency",chartUnfocusNodeAdjacency:"chartUnfocusNodeAdjacency",chartBrush:"chartBrush",chartBrushEnd:"chartBrushEnd",chartBrushSelected:"chartBrushSelected",chartRendered:"chartRendered",chartFinished:"chartFinished"},exportAs:["echarts"],features:[hi]}),r})(),Sv=(()=>{class r{static forRoot(s){return{ngModule:r,providers:[{provide:Nv,useValue:s}]}}static forChild(){return{ngModule:r}}}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=uo({type:r}),r.\u0275inj=wr({imports:[[]]}),r})();var iS=L(672);const Fv=[{info:[{field:"day",value:"Mo"},{field:"count",value:"20"}]},{info:[{field:"day",value:"Tu"},{field:"count",value:"8"}]},{info:[{field:"day",value:"We"},{field:"count",value:"14"}]},{info:[{field:"day",value:"Th"},{field:"count",value:"3"}]},{info:[{field:"day",value:"Fr"},{field:"count",value:"6"}]},{info:[{field:"day",value:"Sa"},{field:"count",value:"0"}]},{info:[{field:"day",value:"Su"},{field:"count",value:"18"}]}],sS=["spreadsheet"];let aS=(()=>{class r{constructor(){this._chattsOptions={},this.data=Fv,this.dataNames=[],this.dataValues=[],this.update=function(s,u,v,N,R){Fv[N].info[v].value=R}}chart(){function s(u,v){for(const N of u.info)if(N.field==v)return N.value;return null}this.aliasName="day",this.aliasVal="count";for(const u of this.data){const v=s(u,this.aliasName),N=s(u,this.aliasVal);this.dataNames.push(v),this.dataValues.push({name:v,value:N})}this._chattsOptions={tooltip:{},xAxis:{data:this.dataNames,type:"category"},yAxis:{type:"value",scale:!0},series:[{type:"line",data:this.dataValues,smooth:!0}]}}ngOnInit(){this.chart()}ngAfterViewInit(){iS(this.spreadsheet.nativeElement,{data:this.dataValues,columns:[{title:this.aliasName,width:130},{title:this.aliasVal,width:130}],onchange:this.update})}}return r.\u0275fac=function(s){return new(s||r)},r.\u0275cmp=hl({type:r,selectors:[["app-root"]],viewQuery:function(s,u){if(1&s&&M0(sS,5),2&s){let v;I0(v=function(r,o){return r[19].queries[o].queryList}(Ie(),mf()))&&(u.spreadsheet=v.first)}},decls:3,vars:1,consts:[["spreadsheet",""],["echarts","",3,"options"]],template:function(s,u){1&s&&(Yu(0,"div",null,0),Yu(2,"div",1)),2&s&&(function(r){Hp(ut(),Ie(),Xt()+r,Is())}(2),Wu("options",u._chattsOptions))},directives:[oS],styles:[""]}),r})(),lS=(()=>{class r{}return r.\u0275fac=function(s){return new(s||r)},r.\u0275mod=uo({type:r,bootstrap:[aS]}),r.\u0275inj=wr({providers:[],imports:[[DN,Sv,Sv.forRoot({echarts:()=>L.e(181).then(L.bind(L,181))})]]}),r})();(function(){if(ob)throw new Error("Cannot enable prod mode after platform setup.");rb=!1})(),EN().bootstrapModule(lS).catch(r=>console.error(r))}},j=>{j(j.s=851)}]);